<!DOCTYPE html><head><meta charset="UTF-8"><title>KKSDerivations.md|RACCOON</title><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="1fd975f0-4ef0-4292-adf8-45216d8ca24b"><i class="material-icons">menu</i></a><ul class="sidenav" id="1fd975f0-4ef0-4292-adf8-45216d8ca24b"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="../.." class="breadcrumb">modules</a><a href=".." class="breadcrumb">phase_field</a><span class="breadcrumb">MultiPhase</span><a href="#" class="breadcrumb">KKSDerivations</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="a971a0a3-d099-42fd-b221-136c37df65e4" data-section-level="1" data-section-text="KKS Model Definitions"><h1 id="kks-model-definitions">KKS Model Definitions</h1><p><span class="moose-katex-block-equation"><span tex="F = [1-h(\eta)]F_a + h(\eta)F_b+wg(\eta)" bookmark="moose-equation-d72fc081-d554-41dc-be67-38e1937fb2fb" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-d72fc081-d554-41dc-be67-38e1937fb2fb"></span><script>var element = document.getElementById("moose-equation-d72fc081-d554-41dc-be67-38e1937fb2fb");katex.render("F = [1-h(\\eta)]F_a + h(\\eta)F_b+wg(\\eta)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="c =  [1-h(\eta)]c_a + h(\eta)c_b" bookmark="moose-equation-f5803db3-4239-451f-9472-acc44c092b60" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-f5803db3-4239-451f-9472-acc44c092b60"></span><script>var element = document.getElementById("moose-equation-f5803db3-4239-451f-9472-acc44c092b60");katex.render("c =  [1-h(\\eta)]c_a + h(\\eta)c_b", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="\frac{dF_a}{dc_a} = \frac{dF_b}{dc_b}" bookmark="moose-equation-82a6a914-f95a-4b91-8e9b-6060b7143e8a" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-82a6a914-f95a-4b91-8e9b-6060b7143e8a"></span><script>var element = document.getElementById("moose-equation-82a6a914-f95a-4b91-8e9b-6060b7143e8a");katex.render("\\frac{dF_a}{dc_a} = \\frac{dF_b}{dc_b}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="e447dc63-eadb-4493-9cb3-cacf5b116261" data-section-level="1" data-section-text="Materials"><h1 id="materials">Materials</h1><p>The KKS system (<a href="#kim_phase-field_1999">Kim et al. (1999)</a>) uses multiple MOOSE materials to provide values for free energy  functions, the switching function <span tex="h(\eta)" bookmark="moose-equation-6606ed87-8c13-4ae5-befe-10441e31f5ce" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6606ed87-8c13-4ae5-befe-10441e31f5ce"><script>var element = document.getElementById("moose-equation-6606ed87-8c13-4ae5-befe-10441e31f5ce");katex.render("h(\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, and the double well function <span tex="g(\eta)" bookmark="moose-equation-20b8c545-fed2-408d-b6f2-b448bb3d0f39" recursive="True" class="moose-katex-inline-equation" id="moose-equation-20b8c545-fed2-408d-b6f2-b448bb3d0f39"><script>var element = document.getElementById("moose-equation-20b8c545-fed2-408d-b6f2-b448bb3d0f39");katex.render("g(\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Providing these as materials allows the functions to be bundled in a single place, while being used by multiple kernels. Furthermore the automatic differentiation feature used in the parsed function materials prreplovides the necessary derivatives at no cost to the developer. The derivatives are stored in material properties and follow a naming scheme that is defined in <code>KKSBaseMaterial.C</code>.</p></section><section id="dd4a776e-8359-4d60-9a9e-f0714493ce29" data-section-level="1" data-section-text="Cahn - Hilliard Kernels"><h1 id="cahn-hilliard-kernels">Cahn-Hilliard Kernels</h1><section class="scrollspy" id="860ae17a-1c84-42ed-8a8a-1c2595e02288" data-section-level="2" data-section-text="KKSSplitCHCRes"><h2 id="kkssplitchcres">KKSSplitCHCRes</h2><p><a href="../../../source/kernels/KKSSplitCHCRes.html"><code>KKSSplitCHCRes</code></a> is the split version. In this kernel, we calculate the chemical potential <span tex="\mu" bookmark="moose-equation-b1bdeff8-5465-4a39-a04d-2b29887867ac" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b1bdeff8-5465-4a39-a04d-2b29887867ac"><script>var element = document.getElementById("moose-equation-b1bdeff8-5465-4a39-a04d-2b29887867ac");katex.render("\\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> from <span tex="\frac{\partial F}{\partial c}" bookmark="moose-equation-291fa272-c1a8-4ffb-b4b7-d377aeb6c8ed" recursive="True" class="moose-katex-inline-equation" id="moose-equation-291fa272-c1a8-4ffb-b4b7-d377aeb6c8ed"><script>var element = document.getElementById("moose-equation-291fa272-c1a8-4ffb-b4b7-d377aeb6c8ed");katex.render("\\frac{\\partial F}{\\partial c}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. The non-linear variable for this Kernel is the concentration <span tex="c" bookmark="moose-equation-689a5b96-32dd-42fd-81a4-2ec0b75598ee" recursive="True" class="moose-katex-inline-equation" id="moose-equation-689a5b96-32dd-42fd-81a4-2ec0b75598ee"><script>var element = document.getElementById("moose-equation-689a5b96-32dd-42fd-81a4-2ec0b75598ee");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. To calculate <span tex="\frac{\partial c}{\partial t}" bookmark="moose-equation-b87df58f-7072-4cb2-b3db-49caa20f1ae9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b87df58f-7072-4cb2-b3db-49caa20f1ae9"><script>var element = document.getElementById("moose-equation-b87df58f-7072-4cb2-b3db-49caa20f1ae9");katex.render("\\frac{\\partial c}{\\partial t}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="\nabla \cdot M(c) \nabla \mu" bookmark="moose-equation-d708ace8-ca0c-4923-bbac-2c488ff28627" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d708ace8-ca0c-4923-bbac-2c488ff28627"><script>var element = document.getElementById("moose-equation-d708ace8-ca0c-4923-bbac-2c488ff28627");katex.render("\\nabla \\cdot M(c) \\nabla \\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, we use the <a href="../../../source/kernels/CoupledTimeDerivative.html"><code>CoupledTimeDerivative</code></a> and <a href="../../../source/kernels/SplitCHWRes.html"><code>SplitCHWRes</code></a> kernels, respectively, as described <a href="../Phase_Field_Equations.html">here</a>.</p></section><section class="scrollspy" id="f6295987-ea15-4da2-9490-87d71ece8dcf" data-section-level="2" data-section-text="Residual"><h2 id="residual">Residual</h2><p>In the residual routine we need to calculate the term <span tex="R= \frac{\partial F}{\partial c} - \mu" bookmark="moose-equation-188a1892-75b2-4f59-9d98-cfc4dfebc84d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-188a1892-75b2-4f59-9d98-cfc4dfebc84d"><script>var element = document.getElementById("moose-equation-188a1892-75b2-4f59-9d98-cfc4dfebc84d");katex.render("R= \\frac{\\partial F}{\\partial c} - \\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We exploit the KKS identity <span tex="\frac{\partial F}{\partial c}=\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}" bookmark="moose-equation-cb724540-1960-4239-894b-b4161cc23841" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cb724540-1960-4239-894b-b4161cc23841"><script>var element = document.getElementById("moose-equation-cb724540-1960-4239-894b-b4161cc23841");katex.render("\\frac{\\partial F}{\\partial c}=\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and arbitrarily use the a-phase instead.</p><p><span class="moose-katex-block-equation"><span tex="R = \frac{\partial F_a}{\partial c_a} - \mu" bookmark="moose-equation-0d984847-3001-4598-aa38-ec2e3b2d951a" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-0d984847-3001-4598-aa38-ec2e3b2d951a"></span><script>var element = document.getElementById("moose-equation-0d984847-3001-4598-aa38-ec2e3b2d951a");katex.render("R = \\frac{\\partial F_a}{\\partial c_a} - \\mu", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><section id="d2fbb4f3-5dcb-4510-88c1-37099cada560" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="94c2a823-5824-4621-827f-d1673a00c80d" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p>Since there is no explicit dependence on the non-linear variable <span tex="c" bookmark="moose-equation-f585cb49-c4f4-48fe-bdc9-7b30aadfc6af" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f585cb49-c4f4-48fe-bdc9-7b30aadfc6af"><script>var element = document.getElementById("moose-equation-f585cb49-c4f4-48fe-bdc9-7b30aadfc6af");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> in the residual equation, the diagonal components are zero.</p></section><section id="357b7580-644e-42b7-9a73-d9b0d4dd1909" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-7dc14c77-e54c-430c-a786-14917431a317" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7dc14c77-e54c-430c-a786-14917431a317"><script>var element = document.getElementById("moose-equation-7dc14c77-e54c-430c-a786-14917431a317");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-f4e23dd0-6a35-4ffb-81e9-4827edeaa8db" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f4e23dd0-6a35-4ffb-81e9-4827edeaa8db"><script>var element = document.getElementById("moose-equation-f4e23dd0-6a35-4ffb-81e9-4827edeaa8db");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv c_a" bookmark="moose-equation-846be4da-4e8e-428a-ab64-b00dc3299e00" recursive="True" class="moose-katex-inline-equation" id="moose-equation-846be4da-4e8e-428a-ab64-b00dc3299e00"><script>var element = document.getElementById("moose-equation-846be4da-4e8e-428a-ab64-b00dc3299e00");katex.render("u\\equiv c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial c_a}{\partial u_j}\frac{\partial}{\partial c_a}=\phi_j \frac{\partial}{\partial c_a}" bookmark="moose-equation-1a17899b-74a7-47a6-ab92-4b6b3df3eae4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1a17899b-74a7-47a6-ab92-4b6b3df3eae4"><script>var element = document.getElementById("moose-equation-1a17899b-74a7-47a6-ab92-4b6b3df3eae4");katex.render("\\frac{\\partial c_a}{\\partial u_j}\\frac{\\partial}{\\partial c_a}=\\phi_j \\frac{\\partial}{\\partial c_a}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \frac{\partial R}{\partial u_j} = \phi_j \frac{\partial}{\partial c_a} \left( \frac{\partial F}{\partial c_a} - \mu \right)\\ &=& \phi_j  \frac{\partial^2F}{\partial c_a^2} \\ \end{aligned}" bookmark="moose-equation-6e53b4f6-775a-4ae5-8db8-1e128e50f7bf" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-6e53b4f6-775a-4ae5-8db8-1e128e50f7bf"></span><script>var element = document.getElementById("moose-equation-6e53b4f6-775a-4ae5-8db8-1e128e50f7bf");katex.render("\\begin{aligned} J &=& \\frac{\\partial R}{\\partial u_j} = \\phi_j \\frac{\\partial}{\\partial c_a} \\left( \\frac{\\partial F}{\\partial c_a} - \\mu \\right)\\\\ &=& \\phi_j  \\frac{\\partial^2F}{\\partial c_a^2} \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For <span tex="\mu" bookmark="moose-equation-43e0a56b-075d-4ba2-b8b7-202df03c7060" recursive="True" class="moose-katex-inline-equation" id="moose-equation-43e0a56b-075d-4ba2-b8b7-202df03c7060"><script>var element = document.getElementById("moose-equation-43e0a56b-075d-4ba2-b8b7-202df03c7060");katex.render("\\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial \mu} \left( \frac{\partial F}{\partial c_a} - \mu \right)\\ &=& -\phi_j \\ \end{aligned}" bookmark="moose-equation-d0d95b23-4ecb-4513-acd5-8203becee1ac" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-d0d95b23-4ecb-4513-acd5-8203becee1ac"></span><script>var element = document.getElementById("moose-equation-d0d95b23-4ecb-4513-acd5-8203becee1ac");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial \\mu} \\left( \\frac{\\partial F}{\\partial c_a} - \\mu \\right)\\\\ &=& -\\phi_j \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section></section><section class="scrollspy" id="662da649-3bde-488d-b5bb-84f3b25e110b" data-section-level="2" data-section-text="KKSCHBulk"><h2 id="kkschbulk">KKSCHBulk</h2><p><a href="../../../source/kernels/KKSCHBulk.html"><code>KKSCHBulk</code></a> is the non-split version, which is <em></em>not fully implemented**. The non-linear variable for this Kernel is the concentration <span tex="c" bookmark="moose-equation-d43de4a8-fff5-4d02-bb9f-d5916a2ee5ab" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d43de4a8-fff5-4d02-bb9f-d5916a2ee5ab"><script>var element = document.getElementById("moose-equation-d43de4a8-fff5-4d02-bb9f-d5916a2ee5ab");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><section id="8ea264e6-12d2-4748-8e5d-fb1705315b1f" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p>In the residual routine we need to calculate the term <span tex="R=\nabla \frac{dF}{dc}" bookmark="moose-equation-5e50e600-3dd7-4fff-b72a-4d246a690cbd" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5e50e600-3dd7-4fff-b72a-4d246a690cbd"><script>var element = document.getElementById("moose-equation-5e50e600-3dd7-4fff-b72a-4d246a690cbd");katex.render("R=\\nabla \\frac{dF}{dc}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We exploit the KKS identity <span tex="\frac{dF}{dc}=\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}" bookmark="moose-equation-286164d8-d376-4898-a8f1-944098c60c36" recursive="True" class="moose-katex-inline-equation" id="moose-equation-286164d8-d376-4898-a8f1-944098c60c36"><script>var element = document.getElementById("moose-equation-286164d8-d376-4898-a8f1-944098c60c36");katex.render("\\frac{dF}{dc}=\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and arbitrarily use the a-phase instead. The gradient can be calculated through the chain rule (note that <span tex="F_a(c_a, p_1,p_2,\dots,p_n)" bookmark="moose-equation-6a13aed6-a124-4eb0-a6e1-727dd133f1f8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6a13aed6-a124-4eb0-a6e1-727dd133f1f8"><script>var element = document.getElementById("moose-equation-6a13aed6-a124-4eb0-a6e1-727dd133f1f8");katex.render("F_a(c_a, p_1,p_2,\\dots,p_n)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is potentially a function of many variables).</p><p><span class="moose-katex-block-equation"><span tex="R = \nabla \frac{dF_a}{dc_a} = \frac{d^2F_a}{dc_a^2}\nabla c_a + \sum_i \frac{d^2F_a}{dc_adp_i}\nabla p_i" bookmark="moose-equation-f47b5e66-b37a-4773-a123-0e12fa256c10" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-f47b5e66-b37a-4773-a123-0e12fa256c10"></span><script>var element = document.getElementById("moose-equation-f47b5e66-b37a-4773-a123-0e12fa256c10");katex.render("R = \\nabla \\frac{dF_a}{dc_a} = \\frac{d^2F_a}{dc_a^2}\\nabla c_a + \\sum_i \\frac{d^2F_a}{dc_adp_i}\\nabla p_i", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>With <span tex="a = \{c_a, p_1,p_2,\dots,p_n\}" bookmark="moose-equation-f8ed3521-9cbd-4201-87bf-819f559afde7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f8ed3521-9cbd-4201-87bf-819f559afde7"><script>var element = document.getElementById("moose-equation-f8ed3521-9cbd-4201-87bf-819f559afde7");katex.render("a = \\{c_a, p_1,p_2,\\dots,p_n\\}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> being the vector of all arguments to <span tex="F_a" bookmark="moose-equation-bfd6d5cf-98f8-4cfd-9bc2-6587858c2ba6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-bfd6d5cf-98f8-4cfd-9bc2-6587858c2ba6"><script>var element = document.getElementById("moose-equation-bfd6d5cf-98f8-4cfd-9bc2-6587858c2ba6");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> this simplifies to</p><p><span class="moose-katex-block-equation"><span tex="R=\sum_i \frac{d^2F_a}{dc_ada_i}\nabla a_i  = \sum_i R_i \nabla a_i" bookmark="moose-equation-82709c0d-004b-48bf-b58a-322eea3982c9" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-82709c0d-004b-48bf-b58a-322eea3982c9"></span><script>var element = document.getElementById("moose-equation-82709c0d-004b-48bf-b58a-322eea3982c9");katex.render("R=\\sum_i \\frac{d^2F_a}{dc_ada_i}\\nabla a_i  = \\sum_i R_i \\nabla a_i", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>using <span tex="R_i" bookmark="moose-equation-802edb80-06da-412e-b50b-ca4a01004f34" recursive="True" class="moose-katex-inline-equation" id="moose-equation-802edb80-06da-412e-b50b-ca4a01004f34"><script>var element = document.getElementById("moose-equation-802edb80-06da-412e-b50b-ca4a01004f34");katex.render("R_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> as a shorthand for the term <span tex="\frac{d^2F_a}{dc_ada_i}" bookmark="moose-equation-d6e30e7a-a0a8-48e4-91b2-abf246c98f2e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d6e30e7a-a0a8-48e4-91b2-abf246c98f2e"><script>var element = document.getElementById("moose-equation-d6e30e7a-a0a8-48e4-91b2-abf246c98f2e");katex.render("\\frac{d^2F_a}{dc_ada_i}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (and represented in the code as the array <code>_second_derivatives[i]</code>). We do have access to the gradients of <span tex="a_i" bookmark="moose-equation-92d6fec6-af51-4bcd-b886-5cf24385a5d7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-92d6fec6-af51-4bcd-b886-5cf24385a5d7"><script>var element = document.getElementById("moose-equation-92d6fec6-af51-4bcd-b886-5cf24385a5d7");katex.render("a_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> through MOOSE (stored in <code>_grad\_args[i]</code>).</p></section><section id="d0c5a780-a232-4e87-89b5-63bfae9e1cbf" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><p>The calculation of the Jacobian involves the derivative of the Residual term <span tex="R" bookmark="moose-equation-7f00c02f-6725-4a27-a0ac-73e89d8ef8fc" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7f00c02f-6725-4a27-a0ac-73e89d8ef8fc"><script>var element = document.getElementById("moose-equation-7f00c02f-6725-4a27-a0ac-73e89d8ef8fc");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> w.r.t. the individual coefficients <span tex="u_j" bookmark="moose-equation-da2122af-3c9a-4076-a89b-141b86437a33" recursive="True" class="moose-katex-inline-equation" id="moose-equation-da2122af-3c9a-4076-a89b-141b86437a33"><script>var element = document.getElementById("moose-equation-da2122af-3c9a-4076-a89b-141b86437a33");katex.render("u_j", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> of all parameters of <span tex="F_a" bookmark="moose-equation-c8e3e7a8-01c8-4ad2-afe9-051ed45d7df6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c8e3e7a8-01c8-4ad2-afe9-051ed45d7df6"><script>var element = document.getElementById("moose-equation-c8e3e7a8-01c8-4ad2-afe9-051ed45d7df6");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Here <span tex="u" bookmark="moose-equation-4e9f55fd-113d-4441-b4a0-7aa48729d40e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4e9f55fd-113d-4441-b4a0-7aa48729d40e"><script>var element = document.getElementById("moose-equation-4e9f55fd-113d-4441-b4a0-7aa48729d40e");katex.render("u", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> can stand for any variable <span tex="a_i" bookmark="moose-equation-53fbf834-57a6-4800-b3fe-b37a688b4b02" recursive="True" class="moose-katex-inline-equation" id="moose-equation-53fbf834-57a6-4800-b3fe-b37a688b4b02"><script>var element = document.getElementById("moose-equation-53fbf834-57a6-4800-b3fe-b37a688b4b02");katex.render("a_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = \sum_i \left[ \frac d{du_j} R_i\nabla a_i \right] = \sum_i \left[  R_i\frac{d\nabla a_i}{du_j} + \nabla a_i \sum_k \frac {dR_i}{da_k}\frac{da_k}{du_j} \right]" bookmark="moose-equation-ab6d1a2f-2f2c-4961-9b75-068298bdf471" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-ab6d1a2f-2f2c-4961-9b75-068298bdf471"></span><script>var element = document.getElementById("moose-equation-ab6d1a2f-2f2c-4961-9b75-068298bdf471");katex.render("\\frac{dR}{du_j} = \\sum_i \\left[ \\frac d{du_j} R_i\\nabla a_i \\right] = \\sum_i \\left[  R_i\\frac{d\\nabla a_i}{du_j} + \\nabla a_i \\sum_k \\frac {dR_i}{da_k}\\frac{da_k}{du_j} \\right]", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>In the code <span tex="u" bookmark="moose-equation-a672cefb-ef48-433d-8cd6-35b5c4b36047" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a672cefb-ef48-433d-8cd6-35b5c4b36047"><script>var element = document.getElementById("moose-equation-a672cefb-ef48-433d-8cd6-35b5c4b36047");katex.render("u", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is given by <code>jvar</code> for the off diagonal case, and <span tex="c" bookmark="moose-equation-d9e0e807-2d40-4b8c-bd20-02ccbf8720d6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d9e0e807-2d40-4b8c-bd20-02ccbf8720d6"><script>var element = document.getElementById("moose-equation-d9e0e807-2d40-4b8c-bd20-02ccbf8720d6");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (not <span tex="c_a" bookmark="moose-equation-f512861f-a95c-46e1-8e6f-97bab42c6873" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f512861f-a95c-46e1-8e6f-97bab42c6873"><script>var element = document.getElementById("moose-equation-f512861f-a95c-46e1-8e6f-97bab42c6873");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> or <span tex="c_b" bookmark="moose-equation-d3799d6a-87a5-4e05-86d2-264a5305273d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d3799d6a-87a5-4e05-86d2-264a5305273d"><script>var element = document.getElementById("moose-equation-d3799d6a-87a5-4e05-86d2-264a5305273d");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>!) in the on diagonal case.</p><section id="2621b151-0a13-453d-935d-dd7b3db5d0a2" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>Let&#x27;s focus on off diagonal first. Here <span tex="\frac{da_k}{du_j}" bookmark="moose-equation-6c4477b5-d306-43b2-abc6-f9b23d9c8c41" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6c4477b5-d306-43b2-abc6-f9b23d9c8c41"><script>var element = document.getElementById("moose-equation-6c4477b5-d306-43b2-abc6-f9b23d9c8c41");katex.render("\\frac{da_k}{du_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is zero, if <code>jvar</code> is not equal <span tex="k" bookmark="moose-equation-c7e597ec-6755-47a5-8ea6-7604717c0e1c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c7e597ec-6755-47a5-8ea6-7604717c0e1c"><script>var element = document.getElementById("moose-equation-c7e597ec-6755-47a5-8ea6-7604717c0e1c");katex.render("k", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Allowing us to remove the sum over <span tex="k" bookmark="moose-equation-64229eb1-0aaa-4d16-9785-7664933c2c4c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-64229eb1-0aaa-4d16-9785-7664933c2c4c"><script>var element = document.getElementById("moose-equation-64229eb1-0aaa-4d16-9785-7664933c2c4c");katex.render("k", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and replace it with the single non-zero summand</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = \sum_i \left[  R_i\frac{d\nabla a_i}{du_j} + \nabla a_i \frac {dR_i}{da_\text{jvar}}\frac{da_\text{jvar}}{du_j} \right]" bookmark="moose-equation-9d97f4f4-51bc-428d-a86f-85c3cbf2a5ea" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-9d97f4f4-51bc-428d-a86f-85c3cbf2a5ea"></span><script>var element = document.getElementById("moose-equation-9d97f4f4-51bc-428d-a86f-85c3cbf2a5ea");katex.render("\\frac{dR}{du_j} = \\sum_i \\left[  R_i\\frac{d\\nabla a_i}{du_j} + \\nabla a_i \\frac {dR_i}{da_\\text{jvar}}\\frac{da_\\text{jvar}}{du_j} \\right]", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>In the first term in the square brackets the derivative <span tex="\frac{d\nabla a_i}{du_j}" bookmark="moose-equation-110b9530-033d-4bd5-a938-d974c56bbce7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-110b9530-033d-4bd5-a938-d974c56bbce7"><script>var element = document.getElementById("moose-equation-110b9530-033d-4bd5-a938-d974c56bbce7");katex.render("\\frac{d\\nabla a_i}{du_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is only non-zero if <span tex="i" bookmark="moose-equation-727f826c-55c7-48fc-b5b0-27e5a21d9d02" recursive="True" class="moose-katex-inline-equation" id="moose-equation-727f826c-55c7-48fc-b5b0-27e5a21d9d02"><script>var element = document.getElementById("moose-equation-727f826c-55c7-48fc-b5b0-27e5a21d9d02");katex.render("i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is <code>jvar</code>. We can therefore pull this term out of the sum.</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = R_\text{jvar}\frac{d\nabla a_\text{jvar}}{du_j} + \sum_i  \nabla a_i \frac {dR_i}{da_\text{jvar}}\frac{da_\text{jvar}}{du_j}" bookmark="moose-equation-78f6b003-451d-40d2-af42-19455bbdc081" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-78f6b003-451d-40d2-af42-19455bbdc081"></span><script>var element = document.getElementById("moose-equation-78f6b003-451d-40d2-af42-19455bbdc081");katex.render("\\frac{dR}{du_j} = R_\\text{jvar}\\frac{d\\nabla a_\\text{jvar}}{du_j} + \\sum_i  \\nabla a_i \\frac {dR_i}{da_\\text{jvar}}\\frac{da_\\text{jvar}}{du_j}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>With the rules for <span tex="\frac d{du_j}" bookmark="moose-equation-63f5491b-166d-4f2e-b84a-3b9b702b8032" recursive="True" class="moose-katex-inline-equation" id="moose-equation-63f5491b-166d-4f2e-b84a-3b9b702b8032"><script>var element = document.getElementById("moose-equation-63f5491b-166d-4f2e-b84a-3b9b702b8032");katex.render("\\frac d{du_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivatives we get</p><p><span class="moose-katex-block-equation"><span tex="R_\text{jvar} \nabla \phi_j + \sum_i \nabla a_i \frac {dR_i}{da_\text{jvar}} \phi_j" bookmark="moose-equation-e213cc96-9d70-45cf-a96a-92b157e09857" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-e213cc96-9d70-45cf-a96a-92b157e09857"></span><script>var element = document.getElementById("moose-equation-e213cc96-9d70-45cf-a96a-92b157e09857");katex.render("R_\\text{jvar} \\nabla \\phi_j + \\sum_i \\nabla a_i \\frac {dR_i}{da_\\text{jvar}} \\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>where <span tex="j" bookmark="moose-equation-c8236301-7da4-4312-b20f-cd3e0517d20f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c8236301-7da4-4312-b20f-cd3e0517d20f"><script>var element = document.getElementById("moose-equation-c8236301-7da4-4312-b20f-cd3e0517d20f");katex.render("j", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is <code>_j</code> in the code.</p></section><section id="680e7bfe-0668-4415-8c5e-88ea14eccc44" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>For the on diagonal terms we look at the derivative w.r.t. the components of the non-linear variable <span tex="c" bookmark="moose-equation-4a47992e-b120-4dd1-b13b-dcf205416bb0" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4a47992e-b120-4dd1-b13b-dcf205416bb0"><script>var element = document.getElementById("moose-equation-4a47992e-b120-4dd1-b13b-dcf205416bb0");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> of this kernel. Note, that <span tex="F_a" bookmark="moose-equation-8e29f72c-e8fa-450c-950e-646f40d4178d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8e29f72c-e8fa-450c-950e-646f40d4178d"><script>var element = document.getElementById("moose-equation-8e29f72c-e8fa-450c-950e-646f40d4178d");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is only indirectly a function of <span tex="c" bookmark="moose-equation-a04ece6a-5914-4d88-ad33-404e980e349b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a04ece6a-5914-4d88-ad33-404e980e349b"><script>var element = document.getElementById("moose-equation-a04ece6a-5914-4d88-ad33-404e980e349b");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We assume the dependence is given through <span tex="c(c_a)" bookmark="moose-equation-2b827e0f-17d6-4958-abb5-f9b96418d2e2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2b827e0f-17d6-4958-abb5-f9b96418d2e2"><script>var element = document.getElementById("moose-equation-2b827e0f-17d6-4958-abb5-f9b96418d2e2");katex.render("c(c_a)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. The chain rule will thus yield terms of this form</p><p><span class="moose-katex-block-equation"><span tex="\frac{dc_a}{dc} = \frac{\frac{d^2F_b}{dc_b^2}}{[1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2}}," bookmark="moose-equation-30bbddfd-2ac6-40ff-97b1-6a9c51d72b7c" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-30bbddfd-2ac6-40ff-97b1-6a9c51d72b7c"></span><script>var element = document.getElementById("moose-equation-30bbddfd-2ac6-40ff-97b1-6a9c51d72b7c");katex.render("\\frac{dc_a}{dc} = \\frac{\\frac{d^2F_b}{dc_b^2}}{[1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2}},", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>which is given as equation (23) in KKS. Following the off-diagonal  derivation we get</p><p>v \frac{d<sup>2F_a}{dc_a</sup>2}\frac{dc_a}{dc} \nabla \phi_j + \sum_i \nabla a_i \frac {dR_i}{dc_a} \frac{dc_a}{dc} \phi_j \end{equation}</p></section><section id="1bec881c-0bce-455b-89a9-b463b20f34f5" data-section-level="4" data-section-text="On - diagonal second approach"><h4 id="on-diagonal-second-approach">On-diagonal second approach</h4><p>Let&#x27;s get back to the original residual with <span tex="\frac{dF}{dc}" bookmark="moose-equation-b4451b3d-691b-4218-b2d5-494c40b82abe" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b4451b3d-691b-4218-b2d5-494c40b82abe"><script>var element = document.getElementById("moose-equation-b4451b3d-691b-4218-b2d5-494c40b82abe");katex.render("\\frac{dF}{dc}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Then</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{d}{dc} \nabla \frac{dF}{dc}\\ &=& \phi_j  \nabla \frac{d^2F}{dc^2} \quad,\quad \text{with (29) from KKS}\\ &=& \phi_j  \nabla \frac{\frac{d^2F_b}{dc_b^2}\frac{d^2F_a}{dc_a^2}}{  [1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2} }\\ \end{aligned}" bookmark="moose-equation-3804ecf3-8c04-4d5c-bc51-64bf8b892348" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-3804ecf3-8c04-4d5c-bc51-64bf8b892348"></span><script>var element = document.getElementById("moose-equation-3804ecf3-8c04-4d5c-bc51-64bf8b892348");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{d}{dc} \\nabla \\frac{dF}{dc}\\\\ &=& \\phi_j  \\nabla \\frac{d^2F}{dc^2} \\quad,\\quad \\text{with (29) from KKS}\\\\ &=& \\phi_j  \\nabla \\frac{\\frac{d^2F_b}{dc_b^2}\\frac{d^2F_a}{dc_a^2}}{  [1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2} }\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section></section><section id="0e745e1b-6303-437b-9b98-b85f1473a75b" data-section-level="1" data-section-text="Allen - Cahn Kernels"><h1 id="allen-cahn-kernels">Allen-Cahn  Kernels</h1><p>For the bulk Allen-Cahn residual we need to calculate the term</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R=\frac{dF}{d\eta}&=&\frac{d}{d\eta}\left([1-h(\eta)]F_a + h(\eta)F_b+wg(\eta) \right)\\ &=& \frac{dF_a}{d\eta}+\frac{d}{d\eta}\left(h(\eta)F_b-h(\eta)F_a + wg(\eta)\right)\\ &=& \frac{dF_a}{d\eta}+F_b\frac{dh}{d\eta}-F_a\frac{dh}{d\eta}+h(\eta)\frac{dF_b}{d\eta}-h(\eta)\frac{dF_a}{d\eta} +w\frac{dg}{d\eta}\\ &=& \frac{dF_a}{d\eta}+\frac{dh}{d\eta}(F_b-F_a)+h(\eta)\left(\frac{dF_b}{d\eta}-\frac{dF_a}{d\eta}\right) +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + \underbrace{[1-h(\eta)]\frac{dF_a}{d\eta} + h(\eta)\frac{dF_b}{d\eta}}_{\text{chain rule term}} +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + [1-h(\eta)]\frac{dF_a}{dc_a}\frac{dc_a}{d\eta} + h(\eta)\frac{dF_b}{dc_b}\frac{dc_b}{d\eta} +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + \frac{dF_a}{dc_a}\left([1-h(\eta)]\frac{dc_a}{d\eta} + h(\eta)\frac{dc_b}{d\eta}\right) +w\frac{dg}{d\eta} \end{aligned}" bookmark="moose-equation-b5f8bb84-bb9e-4c7c-a7c6-16d0c61b48e9" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-b5f8bb84-bb9e-4c7c-a7c6-16d0c61b48e9"></span><script>var element = document.getElementById("moose-equation-b5f8bb84-bb9e-4c7c-a7c6-16d0c61b48e9");katex.render("\\begin{aligned} R=\\frac{dF}{d\\eta}&=&\\frac{d}{d\\eta}\\left([1-h(\\eta)]F_a + h(\\eta)F_b+wg(\\eta) \\right)\\\\ &=& \\frac{dF_a}{d\\eta}+\\frac{d}{d\\eta}\\left(h(\\eta)F_b-h(\\eta)F_a + wg(\\eta)\\right)\\\\ &=& \\frac{dF_a}{d\\eta}+F_b\\frac{dh}{d\\eta}-F_a\\frac{dh}{d\\eta}+h(\\eta)\\frac{dF_b}{d\\eta}-h(\\eta)\\frac{dF_a}{d\\eta} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dF_a}{d\\eta}+\\frac{dh}{d\\eta}(F_b-F_a)+h(\\eta)\\left(\\frac{dF_b}{d\\eta}-\\frac{dF_a}{d\\eta}\\right) +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\underbrace{[1-h(\\eta)]\\frac{dF_a}{d\\eta} + h(\\eta)\\frac{dF_b}{d\\eta}}_{\\text{chain rule term}} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + [1-h(\\eta)]\\frac{dF_a}{dc_a}\\frac{dc_a}{d\\eta} + h(\\eta)\\frac{dF_b}{dc_b}\\frac{dc_b}{d\\eta} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\frac{dF_a}{dc_a}\\left([1-h(\\eta)]\\frac{dc_a}{d\\eta} + h(\\eta)\\frac{dc_b}{d\\eta}\\right) +w\\frac{dg}{d\\eta} \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>The _chain rule term_ results from the fact that <span tex="c_a" bookmark="moose-equation-e46d30d6-2140-4028-9b30-39524ec6505c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e46d30d6-2140-4028-9b30-39524ec6505c"><script>var element = document.getElementById("moose-equation-e46d30d6-2140-4028-9b30-39524ec6505c");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="c_b" bookmark="moose-equation-45ec8ed8-b325-401d-a66a-6260114e7726" recursive="True" class="moose-katex-inline-equation" id="moose-equation-45ec8ed8-b325-401d-a66a-6260114e7726"><script>var element = document.getElementById("moose-equation-45ec8ed8-b325-401d-a66a-6260114e7726");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> are dependent on <span tex="\eta" bookmark="moose-equation-a9e5842a-d87b-4709-afa0-89214b65a2e9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a9e5842a-d87b-4709-afa0-89214b65a2e9"><script>var element = document.getElementById("moose-equation-a9e5842a-d87b-4709-afa0-89214b65a2e9");katex.render("\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (see eqs. (25) and (26) in KKS). Setting <span tex="\lambda = [1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2}" bookmark="moose-equation-4a4636e4-2743-43cf-9f24-354e72d293b4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4a4636e4-2743-43cf-9f24-354e72d293b4"><script>var element = document.getElementById("moose-equation-4a4636e4-2743-43cf-9f24-354e72d293b4");katex.render("\\lambda = [1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> we get</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} \frac{dc_a}{d\eta} &=& \frac1\lambda \frac{dh}{d\eta}(c_a-c_b)\frac{d^2F_b}{dc_b^2}\\ \frac{dc_b}{d\eta} &=& \frac1\lambda \frac{dh}{d\eta}(c_a-c_b)\frac{d^2F_a}{dc_a^2}. \end{aligned}" bookmark="moose-equation-9ac63f25-dafc-4a0d-aa7b-d3a94fe9c53e" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-9ac63f25-dafc-4a0d-aa7b-d3a94fe9c53e"></span><script>var element = document.getElementById("moose-equation-9ac63f25-dafc-4a0d-aa7b-d3a94fe9c53e");katex.render("\\begin{aligned} \\frac{dc_a}{d\\eta} &=& \\frac1\\lambda \\frac{dh}{d\\eta}(c_a-c_b)\\frac{d^2F_b}{dc_b^2}\\\\ \\frac{dc_b}{d\\eta} &=& \\frac1\\lambda \\frac{dh}{d\\eta}(c_a-c_b)\\frac{d^2F_a}{dc_a^2}. \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Substituting this in we get</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R &=& \frac{dh}{d\eta}(F_b-F_a) + \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b)\frac1\lambda\underbrace{\left([1-h(\eta)] \frac{d^2F_b}{dc_b^2} + h(\eta)\frac{d^2F_a}{dc_a^2}\right)}_{=\lambda} +w\frac{dg}{d\eta}. \end{aligned}" bookmark="moose-equation-0a6eb969-25be-4a89-a736-8a9f77fa12e3" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-0a6eb969-25be-4a89-a736-8a9f77fa12e3"></span><script>var element = document.getElementById("moose-equation-0a6eb969-25be-4a89-a736-8a9f77fa12e3");katex.render("\\begin{aligned} R &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b)\\frac1\\lambda\\underbrace{\\left([1-h(\\eta)] \\frac{d^2F_b}{dc_b^2} + h(\\eta)\\frac{d^2F_a}{dc_a^2}\\right)}_{=\\lambda} +w\\frac{dg}{d\\eta}. \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>This simplifies to</p><p><span class="moose-katex-block-equation"><span tex="R=-\frac{dh}{d\eta} \left(F_a-F_b-\frac{dF_a}{dc_a}(c_a-c_b)\right) + w\frac{dg}{d\eta}." bookmark="moose-equation-191a9c8f-3b76-4d16-978a-23e457c1b1a1" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-191a9c8f-3b76-4d16-978a-23e457c1b1a1"></span><script>var element = document.getElementById("moose-equation-191a9c8f-3b76-4d16-978a-23e457c1b1a1");katex.render("R=-\\frac{dh}{d\\eta} \\left(F_a-F_b-\\frac{dF_a}{dc_a}(c_a-c_b)\\right) + w\\frac{dg}{d\\eta}.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>We split this residual into two kernels to allow for multiple phase concentrations in a multi component system:</p><section class="scrollspy" id="e6347720-5b98-4bc2-89f4-6e6c3fb06600" data-section-level="2" data-section-text="KKSACBulkF"><h2><code>KKSACBulkF</code></h2><p><a href="../../../source/kernels/KKSACBulkF.html"><code>KKSACBulkF</code></a> is the part without a direct composition dependence.</p><section id="7acf216c-4d28-400f-9994-d4e2fb593daa" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=-\frac{dh}{d\eta}(F_a-F_b)+w\frac{dg}{d\eta}." bookmark="moose-equation-81a12f9e-e462-42b2-a6d3-e72f8c559acb" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-81a12f9e-e462-42b2-a6d3-e72f8c559acb"></span><script>var element = document.getElementById("moose-equation-81a12f9e-e462-42b2-a6d3-e72f8c559acb");katex.render("R=-\\frac{dh}{d\\eta}(F_a-F_b)+w\\frac{dg}{d\\eta}.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="fb86a4e8-b792-487f-9d10-45a3f3f04655" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="3b2c9eb0-6e2c-4189-a122-a76f60a73f45" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-0c518d08-07f8-4b35-841e-305f28ca67a2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0c518d08-07f8-4b35-841e-305f28ca67a2"><script>var element = document.getElementById("moose-equation-0c518d08-07f8-4b35-841e-305f28ca67a2");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-024ff44f-063c-446b-b744-36f68f6c3320" recursive="True" class="moose-katex-inline-equation" id="moose-equation-024ff44f-063c-446b-b744-36f68f6c3320"><script>var element = document.getElementById("moose-equation-024ff44f-063c-446b-b744-36f68f6c3320");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv\eta" bookmark="moose-equation-90838164-84ea-40f1-b1ad-f9e7e93db2d1" recursive="True" class="moose-katex-inline-equation" id="moose-equation-90838164-84ea-40f1-b1ad-f9e7e93db2d1"><script>var element = document.getElementById("moose-equation-90838164-84ea-40f1-b1ad-f9e7e93db2d1");katex.render("u\\equiv\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial \eta}{\partial u_j}\frac{\partial}{\partial \eta}=\phi_j \frac{\partial}{\partial\eta}" bookmark="moose-equation-df7ccc8e-c887-49a4-8d3c-b86df1c237a2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-df7ccc8e-c887-49a4-8d3c-b86df1c237a2"><script>var element = document.getElementById("moose-equation-df7ccc8e-c887-49a4-8d3c-b86df1c237a2");katex.render("\\frac{\\partial \\eta}{\\partial u_j}\\frac{\\partial}{\\partial \\eta}=\\phi_j \\frac{\\partial}{\\partial\\eta}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& -\phi_j \frac{\partial}{\partial \eta}\left( \frac{dh}{d\eta}(F_a-F_b) \right) + w \phi_j \frac{\partial}{\partial \eta}\frac{dg}{d\eta} \\ &=&-\frac{d^2h}{d\eta^2}\phi_j(F_a-F_b) + w\frac{d^2g}{d\eta^2}\phi_j \\ \end{aligned}" bookmark="moose-equation-35f8905e-6c44-4158-89c1-d045fa5a6ded" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-35f8905e-6c44-4158-89c1-d045fa5a6ded"></span><script>var element = document.getElementById("moose-equation-35f8905e-6c44-4158-89c1-d045fa5a6ded");katex.render("\\begin{aligned} J &=& -\\phi_j \\frac{\\partial}{\\partial \\eta}\\left( \\frac{dh}{d\\eta}(F_a-F_b) \\right) + w \\phi_j \\frac{\\partial}{\\partial \\eta}\\frac{dg}{d\\eta} \\\\ &=&-\\frac{d^2h}{d\\eta^2}\\phi_j(F_a-F_b) + w\\frac{d^2g}{d\\eta^2}\\phi_j \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>(The implicit dependence of <span tex="F_a(c_a)" bookmark="moose-equation-c27227be-2e7e-4401-a64e-191160bd4ecd" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c27227be-2e7e-4401-a64e-191160bd4ecd"><script>var element = document.getElementById("moose-equation-c27227be-2e7e-4401-a64e-191160bd4ecd");katex.render("F_a(c_a)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b(c_a)" bookmark="moose-equation-dd4feff5-f032-4d5c-bb48-95f0d9e32270" recursive="True" class="moose-katex-inline-equation" id="moose-equation-dd4feff5-f032-4d5c-bb48-95f0d9e32270"><script>var element = document.getElementById("moose-equation-dd4feff5-f032-4d5c-bb48-95f0d9e32270");katex.render("F_b(c_a)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> on <span tex="\eta" bookmark="moose-equation-dd770591-fbc4-43bd-83fb-7552a09db2b7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-dd770591-fbc4-43bd-83fb-7552a09db2b7"><script>var element = document.getElementById("moose-equation-dd770591-fbc4-43bd-83fb-7552a09db2b7");katex.render("\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> through <span tex="c_a(c,\eta)" bookmark="moose-equation-2f2438ee-fb9e-4c05-b414-cd5e3fdc56e3" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2f2438ee-fb9e-4c05-b414-cd5e3fdc56e3"><script>var element = document.getElementById("moose-equation-2f2438ee-fb9e-4c05-b414-cd5e3fdc56e3");katex.render("c_a(c,\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="c_b(c,\eta)" bookmark="moose-equation-1da1d887-b493-44c4-99d4-4625a1e61884" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1da1d887-b493-44c4-99d4-4625a1e61884"><script>var element = document.getElementById("moose-equation-1da1d887-b493-44c4-99d4-4625a1e61884");katex.render("c_b(c,\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> does not contribute to the Jacobian, so <span tex="\frac{\partial F_a}{\partial \eta} = \frac{\partial F_a}{\partial \eta} = 0)" bookmark="moose-equation-eff0d87d-4739-4a14-9a03-39ec817ac94b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-eff0d87d-4739-4a14-9a03-39ec817ac94b"><script>var element = document.getElementById("moose-equation-eff0d87d-4739-4a14-9a03-39ec817ac94b");katex.render("\\frac{\\partial F_a}{\\partial \\eta} = \\frac{\\partial F_a}{\\partial \\eta} = 0)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p></section><section id="7f40c740-8536-4dad-9154-11ab4e4e9492" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>The off-diagonal components are calculated for any other variables that <span tex="F_a" bookmark="moose-equation-2ab77302-ae37-46f1-b03c-30b1ea4ad846" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2ab77302-ae37-46f1-b03c-30b1ea4ad846"><script>var element = document.getElementById("moose-equation-2ab77302-ae37-46f1-b03c-30b1ea4ad846");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-b496edc3-2117-45ed-b70d-e16a9fae50f1" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b496edc3-2117-45ed-b70d-e16a9fae50f1"><script>var element = document.getElementById("moose-equation-b496edc3-2117-45ed-b70d-e16a9fae50f1");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> depend on. For example, for <span tex="c_a" bookmark="moose-equation-a1b18e24-6024-44ce-ab05-8d7dffd67602" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a1b18e24-6024-44ce-ab05-8d7dffd67602"><script>var element = document.getElementById("moose-equation-a1b18e24-6024-44ce-ab05-8d7dffd67602");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>:</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{dh}{d\eta}\left( \frac{\partial F_a}{\partial c_a} - \frac{\partial F_b}{\partial c_a}\right)\phi_j" bookmark="moose-equation-431fc503-0a91-4e8a-8729-88e434a1893f" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-431fc503-0a91-4e8a-8729-88e434a1893f"></span><script>var element = document.getElementById("moose-equation-431fc503-0a91-4e8a-8729-88e434a1893f");katex.render("J = \\frac{dh}{d\\eta}\\left( \\frac{\\partial F_a}{\\partial c_a} - \\frac{\\partial F_b}{\\partial c_a}\\right)\\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span tex="\frac{\partial F_b}{\partial c_a} = 0" bookmark="moose-equation-7f4e6a30-a0b8-407f-9f1a-0ba91553386b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7f4e6a30-a0b8-407f-9f1a-0ba91553386b"><script>var element = document.getElementById("moose-equation-7f4e6a30-a0b8-407f-9f1a-0ba91553386b");katex.render("\\frac{\\partial F_b}{\\partial c_a} = 0", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> in the KKS formulation, so this term would not need to be included if <span tex="c_a" bookmark="moose-equation-596bf681-09e4-49b5-b7c6-46a8d17f5712" recursive="True" class="moose-katex-inline-equation" id="moose-equation-596bf681-09e4-49b5-b7c6-46a8d17f5712"><script>var element = document.getElementById("moose-equation-596bf681-09e4-49b5-b7c6-46a8d17f5712");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> was the only variable <span tex="F_a" bookmark="moose-equation-620d87e9-a77b-45cc-925f-74f887030ccf" recursive="True" class="moose-katex-inline-equation" id="moose-equation-620d87e9-a77b-45cc-925f-74f887030ccf"><script>var element = document.getElementById("moose-equation-620d87e9-a77b-45cc-925f-74f887030ccf");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> depended on. However, the code calculates derivatives with respect to all variables that <span tex="F_a" bookmark="moose-equation-bcf6169f-d22e-4ccb-acd8-2343678df552" recursive="True" class="moose-katex-inline-equation" id="moose-equation-bcf6169f-d22e-4ccb-acd8-2343678df552"><script>var element = document.getElementById("moose-equation-bcf6169f-d22e-4ccb-acd8-2343678df552");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-89271ec2-9394-4795-9068-12bcdd392c63" recursive="True" class="moose-katex-inline-equation" id="moose-equation-89271ec2-9394-4795-9068-12bcdd392c63"><script>var element = document.getElementById("moose-equation-89271ec2-9394-4795-9068-12bcdd392c63");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> depend on in a general way so that the Jacobian entries for other dependencies are correctly computed using the same piece of code. For example, both <span tex="F_a" bookmark="moose-equation-c4c296bf-f936-4062-9f25-88b0023e250f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c4c296bf-f936-4062-9f25-88b0023e250f"><script>var element = document.getElementById("moose-equation-c4c296bf-f936-4062-9f25-88b0023e250f");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-46c5aa5e-a8ac-4dc7-85c0-9d785f1d2ea8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-46c5aa5e-a8ac-4dc7-85c0-9d785f1d2ea8"><script>var element = document.getElementById("moose-equation-46c5aa5e-a8ac-4dc7-85c0-9d785f1d2ea8");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> could depend on temperature <span tex="T" bookmark="moose-equation-6332f7d4-bdb6-4e90-b5b4-1b8ce66ba2b7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6332f7d4-bdb6-4e90-b5b4-1b8ce66ba2b7"><script>var element = document.getElementById("moose-equation-6332f7d4-bdb6-4e90-b5b4-1b8ce66ba2b7");katex.render("T", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, in which case</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{dh}{d\eta}\left( \frac{\partial F_a}{\partial T} - \frac{\partial F_b}{\partial T}\right)\phi_j" bookmark="moose-equation-97df264c-383e-4986-ae00-cc768ec0bc17" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-97df264c-383e-4986-ae00-cc768ec0bc17"></span><script>var element = document.getElementById("moose-equation-97df264c-383e-4986-ae00-cc768ec0bc17");katex.render("J = \\frac{dh}{d\\eta}\\left( \\frac{\\partial F_a}{\\partial T} - \\frac{\\partial F_b}{\\partial T}\\right)\\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>which is computed using the same code. The off-diagonal Jacobian contribution is also multiplied by the Allen-Cahn mobility <span tex="L" bookmark="moose-equation-ffae3fbe-5b08-4042-9cef-d4b369b366a6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ffae3fbe-5b08-4042-9cef-d4b369b366a6"><script>var element = document.getElementById("moose-equation-ffae3fbe-5b08-4042-9cef-d4b369b366a6");katex.render("L", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> at each point for consistency with the other terms in the Allen-Cahn equation.</p></section></section><section class="scrollspy" id="7a237ade-81f5-4180-92f1-8c0ee1a037f3" data-section-level="2" data-section-text="KKSACBulkC"><h2><code>KKSACBulkC</code></h2><p><a href="../../../source/kernels/KKSACBulkC.html"><code>KKSACBulkC</code></a> is the part with a direct composition dependence. An instance of this kernel is needed for each compnent of the problem.</p><section id="9834fe4f-9224-4c70-8f0b-8ff9a8028752" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R&=&-\frac{dh}{d\eta}\left(-\frac{dF_a}{dc_a}(c_a-c_b)\right)\\ &=&\frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \end{aligned}" bookmark="moose-equation-0adb929e-99c5-4f04-a502-3116ec710e5e" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-0adb929e-99c5-4f04-a502-3116ec710e5e"></span><script>var element = document.getElementById("moose-equation-0adb929e-99c5-4f04-a502-3116ec710e5e");katex.render("\\begin{aligned} R&=&-\\frac{dh}{d\\eta}\\left(-\\frac{dF_a}{dc_a}(c_a-c_b)\\right)\\\\ &=&\\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="d7d4c0ac-87a0-4ff5-ab29-cda4ecfa0781" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="365e612a-0e95-4438-b6e7-5cc04ed7270d" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-e4f06d6f-5159-4087-a10b-88a5c258eec8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e4f06d6f-5159-4087-a10b-88a5c258eec8"><script>var element = document.getElementById("moose-equation-e4f06d6f-5159-4087-a10b-88a5c258eec8");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-db3e07b9-caa0-4b9e-b4c1-4fc75538ef38" recursive="True" class="moose-katex-inline-equation" id="moose-equation-db3e07b9-caa0-4b9e-b4c1-4fc75538ef38"><script>var element = document.getElementById("moose-equation-db3e07b9-caa0-4b9e-b4c1-4fc75538ef38");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv\eta" bookmark="moose-equation-4f42d27c-aa23-4ded-be08-8cd7e47b8c93" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4f42d27c-aa23-4ded-be08-8cd7e47b8c93"><script>var element = document.getElementById("moose-equation-4f42d27c-aa23-4ded-be08-8cd7e47b8c93");katex.render("u\\equiv\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial \eta}{\partial u_j}\frac{\partial}{\partial \eta} = \phi_j \frac{\partial}{\partial \eta}" bookmark="moose-equation-1977cb82-441c-46e1-bd7b-e56b6b821080" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1977cb82-441c-46e1-bd7b-e56b6b821080"><script>var element = document.getElementById("moose-equation-1977cb82-441c-46e1-bd7b-e56b6b821080");katex.render("\\frac{\\partial \\eta}{\\partial u_j}\\frac{\\partial}{\\partial \\eta} = \\phi_j \\frac{\\partial}{\\partial \\eta}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial \eta} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{d^2h}{d\eta^2}\phi_j\frac{dF_a}{dc_a}(c_a-c_b)\\ \end{aligned}" bookmark="moose-equation-29e7e14a-112c-4d38-af66-008e6adfb8ec" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-29e7e14a-112c-4d38-af66-008e6adfb8ec"></span><script>var element = document.getElementById("moose-equation-29e7e14a-112c-4d38-af66-008e6adfb8ec");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial \\eta} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{d^2h}{d\\eta^2}\\phi_j\\frac{dF_a}{dc_a}(c_a-c_b)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="864a3833-dea3-4e77-addd-178a34f7cd34" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>Since <span tex="c_a" bookmark="moose-equation-d84506c9-b538-4aeb-b83e-aaafcd396d84" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d84506c9-b538-4aeb-b83e-aaafcd396d84"><script>var element = document.getElementById("moose-equation-d84506c9-b538-4aeb-b83e-aaafcd396d84");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="c_b" bookmark="moose-equation-c87103b4-4279-421b-a90e-1d722ba101ae" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c87103b4-4279-421b-a90e-1d722ba101ae"><script>var element = document.getElementById("moose-equation-c87103b4-4279-421b-a90e-1d722ba101ae");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> appear in the residual, their effect must be calculated separately from any other variable dependence. For <span tex="c_a" bookmark="moose-equation-7b83beb2-c2a7-4c50-8276-2befbb169dff" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7b83beb2-c2a7-4c50-8276-2befbb169dff"><script>var element = document.getElementById("moose-equation-7b83beb2-c2a7-4c50-8276-2befbb169dff");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, we are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-b4b7a6d4-e6ab-4f14-a0f3-a8254d3ad3f3" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b4b7a6d4-e6ab-4f14-a0f3-a8254d3ad3f3"><script>var element = document.getElementById("moose-equation-b4b7a6d4-e6ab-4f14-a0f3-a8254d3ad3f3");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-9eb7d092-ecd8-4424-9cb8-a6078434b363" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9eb7d092-ecd8-4424-9cb8-a6078434b363"><script>var element = document.getElementById("moose-equation-9eb7d092-ecd8-4424-9cb8-a6078434b363");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv c_a" bookmark="moose-equation-f4706a16-e37e-4f01-80e7-64ba43831725" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f4706a16-e37e-4f01-80e7-64ba43831725"><script>var element = document.getElementById("moose-equation-f4706a16-e37e-4f01-80e7-64ba43831725");katex.render("u\\equiv c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial c_a}{\partial u_j}\frac{\partial}{\partial c_a} = \phi_j \frac{\partial}{\partial c_a}" bookmark="moose-equation-4efcf6b2-b3be-468b-8c46-6f1c6c55ac0e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4efcf6b2-b3be-468b-8c46-6f1c6c55ac0e"><script>var element = document.getElementById("moose-equation-4efcf6b2-b3be-468b-8c46-6f1c6c55ac0e");katex.render("\\frac{\\partial c_a}{\\partial u_j}\\frac{\\partial}{\\partial c_a} = \\phi_j \\frac{\\partial}{\\partial c_a}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial c_a} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{dh}{d\eta} \phi_j \left( \frac{d^2 F_a}{dc_a^2}(c_a-c_b) + \frac{d F_a}{d c_a}\right)\\ \end{aligned}" bookmark="moose-equation-1d722161-cc3e-4de1-be68-efadeeab67f4" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-1d722161-cc3e-4de1-be68-efadeeab67f4"></span><script>var element = document.getElementById("moose-equation-1d722161-cc3e-4de1-be68-efadeeab67f4");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial c_a} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{dh}{d\\eta} \\phi_j \\left( \\frac{d^2 F_a}{dc_a^2}(c_a-c_b) + \\frac{d F_a}{d c_a}\\right)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Similarly for <span tex="c_b" bookmark="moose-equation-2c73a943-a3ff-4c7a-8cb2-a6d1fd0cc07e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2c73a943-a3ff-4c7a-8cb2-a6d1fd0cc07e"><script>var element = document.getElementById("moose-equation-2c73a943-a3ff-4c7a-8cb2-a6d1fd0cc07e");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, <span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial c_b} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& -\frac{dh}{d\eta} \phi_j  \frac{d F_a}{d c_a}\\ \end{aligned}" bookmark="moose-equation-8fb544eb-63f6-4880-8745-3c26bac5e80f" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-8fb544eb-63f6-4880-8745-3c26bac5e80f"></span><script>var element = document.getElementById("moose-equation-8fb544eb-63f6-4880-8745-3c26bac5e80f");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial c_b} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& -\\frac{dh}{d\\eta} \\phi_j  \\frac{d F_a}{d c_a}\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For any variable other than <span tex="c_a" bookmark="moose-equation-5fa26851-62bd-4eea-b93c-107f22c31c02" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5fa26851-62bd-4eea-b93c-107f22c31c02"><script>var element = document.getElementById("moose-equation-5fa26851-62bd-4eea-b93c-107f22c31c02");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> or <span tex="c_b" bookmark="moose-equation-a1984530-b3db-44ee-b7de-a71f46a7b526" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a1984530-b3db-44ee-b7de-a71f46a7b526"><script>var element = document.getElementById("moose-equation-a1984530-b3db-44ee-b7de-a71f46a7b526");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, for example temperature <span tex="T" bookmark="moose-equation-8a7fef7a-2698-421d-8f5a-f923db8bde10" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8a7fef7a-2698-421d-8f5a-f923db8bde10"><script>var element = document.getElementById("moose-equation-8a7fef7a-2698-421d-8f5a-f923db8bde10");katex.render("T", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>:</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial T} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{dh}{d\eta} \phi_j  \frac{\partial}{\partial T}\left(\frac{d F_a}{d c_a}\right) ( c_a - c_b)\\ \end{aligned}" bookmark="moose-equation-b7cd8e4b-1486-40fc-9161-21f4a0370453" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-b7cd8e4b-1486-40fc-9161-21f4a0370453"></span><script>var element = document.getElementById("moose-equation-b7cd8e4b-1486-40fc-9161-21f4a0370453");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial T} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{dh}{d\\eta} \\phi_j  \\frac{\\partial}{\\partial T}\\left(\\frac{d F_a}{d c_a}\\right) ( c_a - c_b)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>The off-diagonal Jacobian contributions are again multiplied by the Allen-Cahn mobility <span tex="L" bookmark="moose-equation-7ea73a34-7f0d-4463-b838-d581b19bc4d8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7ea73a34-7f0d-4463-b838-d581b19bc4d8"><script>var element = document.getElementById("moose-equation-7ea73a34-7f0d-4463-b838-d581b19bc4d8");katex.render("L", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> at each point for consistency with the other terms in the Allen-Cahn equation.</p></section></section><section id="e3d46780-9a19-406c-9d96-85c6efc4687d" data-section-level="1" data-section-text="Constraint Kernels"><h1 id="constraint-kernels">Constraint Kernels</h1><section class="scrollspy" id="16a48e7d-2daf-4525-a9f2-b9fa5e51fe21" data-section-level="2" data-section-text="KKSPhaseChemicalPotential"><h2><code>KKSPhaseChemicalPotential</code></h2><p><a href="../../../source/kernels/KKSPhaseChemicalPotential.html"><code>KKSPhaseChemicalPotential</code></a> enforces the point wise equality of the phase chemical potentials</p><p><span class="moose-katex-block-equation"><span tex="\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}." bookmark="moose-equation-70dd4d9f-2098-4881-8dea-ba7db59fe260" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-70dd4d9f-2098-4881-8dea-ba7db59fe260"></span><script>var element = document.getElementById("moose-equation-70dd4d9f-2098-4881-8dea-ba7db59fe260");katex.render("\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>The non-linear variable of this Kernel is <span tex="c_a" bookmark="moose-equation-34eeb516-bc36-4d8b-93ef-3fd35a002af5" recursive="True" class="moose-katex-inline-equation" id="moose-equation-34eeb516-bc36-4d8b-93ef-3fd35a002af5"><script>var element = document.getElementById("moose-equation-34eeb516-bc36-4d8b-93ef-3fd35a002af5");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><section id="fe5a8cef-33dd-49fb-b65e-7ed3464b77ce" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=\frac{dF_a}{dc_a} - \frac{dF_b}{dc_b}" bookmark="moose-equation-ed410943-5bb7-42f5-a974-f4312215ff39" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-ed410943-5bb7-42f5-a974-f4312215ff39"></span><script>var element = document.getElementById("moose-equation-ed410943-5bb7-42f5-a974-f4312215ff39");katex.render("R=\\frac{dF_a}{dc_a} - \\frac{dF_b}{dc_b}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="2a350a67-2508-4c4e-9d7a-5204a663cd4a" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><p>For the Jacobian we need to calculate</p><p><span class="moose-katex-block-equation"><span tex="J=\frac \partial{\partial u_j}\left( \frac{dF_a}{dc_a} - \frac{dF_b}{dc_b} \right)." bookmark="moose-equation-e51e55e8-a53a-46a6-aac8-fb7641e0239e" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-e51e55e8-a53a-46a6-aac8-fb7641e0239e"></span><script>var element = document.getElementById("moose-equation-e51e55e8-a53a-46a6-aac8-fb7641e0239e");katex.render("J=\\frac \\partial{\\partial u_j}\\left( \\frac{dF_a}{dc_a} - \\frac{dF_b}{dc_b} \\right).", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><section id="64600afb-09a4-4493-b980-652bbe1eea24" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p><span class="moose-katex-block-equation"><span tex="J = \phi_j \left( \frac{\partial^2 F_a}{\partial c_a^2} - \frac{\partial^2 F_b}{\partial c_a \partial c_b} \right)" bookmark="moose-equation-6b64b6ea-2a32-4b5c-9054-54b2e28787c6" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-6b64b6ea-2a32-4b5c-9054-54b2e28787c6"></span><script>var element = document.getElementById("moose-equation-6b64b6ea-2a32-4b5c-9054-54b2e28787c6");katex.render("J = \\phi_j \\left( \\frac{\\partial^2 F_a}{\\partial c_a^2} - \\frac{\\partial^2 F_b}{\\partial c_a \\partial c_b} \\right)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="fd53d770-b561-406e-b675-fda320386a4b" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>With <span tex="q" bookmark="moose-equation-87d5020b-8090-4f21-84ee-c8e29e0c4b2f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-87d5020b-8090-4f21-84ee-c8e29e0c4b2f"><script>var element = document.getElementById("moose-equation-87d5020b-8090-4f21-84ee-c8e29e0c4b2f");katex.render("q", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> the union of the argument vectors of <span tex="F_a" bookmark="moose-equation-cc7f1ae4-c625-4e77-89f8-2c010bade231" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cc7f1ae4-c625-4e77-89f8-2c010bade231"><script>var element = document.getElementById("moose-equation-cc7f1ae4-c625-4e77-89f8-2c010bade231");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-527684c0-c182-4b91-a3b3-64305ea2db07" recursive="True" class="moose-katex-inline-equation" id="moose-equation-527684c0-c182-4b91-a3b3-64305ea2db07"><script>var element = document.getElementById("moose-equation-527684c0-c182-4b91-a3b3-64305ea2db07");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (represented in the code by <code>_coupled_moose_vars[]</code>) we get</p><p><span class="moose-katex-block-equation"><span tex="\sum_i \left( \frac{\partial^2 F_a}{\partial c_a \partial q_i}\frac{\partial q_i}{\partial u_j} - \frac{\partial^2 F_b}{\partial c_b \partial q_i}\frac{\partial q_i}{\partial u_j} \right)." bookmark="moose-equation-a9fc9a86-5549-4b7e-9e7c-abb45a4aa2cf" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-a9fc9a86-5549-4b7e-9e7c-abb45a4aa2cf"></span><script>var element = document.getElementById("moose-equation-a9fc9a86-5549-4b7e-9e7c-abb45a4aa2cf");katex.render("\\sum_i \\left( \\frac{\\partial^2 F_a}{\\partial c_a \\partial q_i}\\frac{\\partial q_i}{\\partial u_j} - \\frac{\\partial^2 F_b}{\\partial c_b \\partial q_i}\\frac{\\partial q_i}{\\partial u_j} \\right).", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Again the <span tex="\frac{\partial q_i}{\partial u_j}" bookmark="moose-equation-d19a8010-f054-462b-9ca1-db96446ad550" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d19a8010-f054-462b-9ca1-db96446ad550"><script>var element = document.getElementById("moose-equation-d19a8010-f054-462b-9ca1-db96446ad550");katex.render("\\frac{\\partial q_i}{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is non-zero only if <span tex="u\equiv q_i" bookmark="moose-equation-b4c8fd7d-f64b-441d-ab0e-2a59a8c99131" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b4c8fd7d-f64b-441d-ab0e-2a59a8c99131"><script>var element = document.getElementById("moose-equation-b4c8fd7d-f64b-441d-ab0e-2a59a8c99131");katex.render("u\\equiv q_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, which is the case if <span tex="q_i" bookmark="moose-equation-ebcadc4e-8f74-4fed-83ce-830374e2f505" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ebcadc4e-8f74-4fed-83ce-830374e2f505"><script>var element = document.getElementById("moose-equation-ebcadc4e-8f74-4fed-83ce-830374e2f505");katex.render("q_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is the argument selected through <code>jvar</code>.</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{\partial^2 F_a}{\partial c_a \partial q_\text{jvar}}\phi_j - \frac{\partial^2 F_b}{\partial c_b \partial q_\text{jvar}}\phi_j." bookmark="moose-equation-3d03eec9-7a72-4e1a-bbf5-2c5e3acde7f0" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-3d03eec9-7a72-4e1a-bbf5-2c5e3acde7f0"></span><script>var element = document.getElementById("moose-equation-3d03eec9-7a72-4e1a-bbf5-2c5e3acde7f0");katex.render("J = \\frac{\\partial^2 F_a}{\\partial c_a \\partial q_\\text{jvar}}\\phi_j - \\frac{\\partial^2 F_b}{\\partial c_b \\partial q_\\text{jvar}}\\phi_j.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Note that in the code <code>jvar</code> is not an index into <code>_coupled_moose_vars[]</code> but has to be resolved through the <code>_jvar_map</code>.</p></section></section><section class="scrollspy" id="9457439f-25a4-4889-ba82-0843f1c1e189" data-section-level="2" data-section-text="KKSPhaseConcentration"><h2><code>KKSPhaseConcentration</code></h2><p><a href="../../../source/kernels/KKSPhaseConcentration.html"><code>KKSPhaseConcentration</code></a> enforces the split of the concentration into the phase concentrations, weighted by the switching function. The non-linear variable of this Kernel is <span tex="c_b" bookmark="moose-equation-f7cda92c-cc80-4b69-8397-ad4262fab7eb" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f7cda92c-cc80-4b69-8397-ad4262fab7eb"><script>var element = document.getElementById("moose-equation-f7cda92c-cc80-4b69-8397-ad4262fab7eb");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><p><span class="moose-katex-block-equation"><span tex="c = [1-h(\eta)]c_a+h(\eta)c_b" bookmark="moose-equation-9f669967-a657-4c2d-8b03-baf9e8707f04" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-9f669967-a657-4c2d-8b03-baf9e8707f04"></span><script>var element = document.getElementById("moose-equation-9f669967-a657-4c2d-8b03-baf9e8707f04");katex.render("c = [1-h(\\eta)]c_a+h(\\eta)c_b", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><section id="ccd1449f-94c5-497f-a13b-69c059376181" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=[1-h(\eta)]c_a + h(\eta)c_b - c" bookmark="moose-equation-69a428dd-8322-43bc-89d0-4495841e3961" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-69a428dd-8322-43bc-89d0-4495841e3961"></span><script>var element = document.getElementById("moose-equation-69a428dd-8322-43bc-89d0-4495841e3961");katex.render("R=[1-h(\\eta)]c_a + h(\\eta)c_b - c", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="2379ab1b-2f7f-4558-9410-176d2dbf5adb" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="255c148b-d514-4489-91ce-9367559738f5" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p>Since the non-linear variable is <span tex="c_b" bookmark="moose-equation-4ac363eb-a5fb-408a-a2e8-1d2195e8b8ee" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4ac363eb-a5fb-408a-a2e8-1d2195e8b8ee"><script>var element = document.getElementById("moose-equation-4ac363eb-a5fb-408a-a2e8-1d2195e8b8ee");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>,</p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c_b} = \phi_j h(\eta)" bookmark="moose-equation-ce407fd9-1f8b-4c85-868a-f8759963d7b7" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-ce407fd9-1f8b-4c85-868a-f8759963d7b7"></span><script>var element = document.getElementById("moose-equation-ce407fd9-1f8b-4c85-868a-f8759963d7b7");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c_b} = \\phi_j h(\\eta)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="d4a656a9-155f-4a2e-afbb-1371f81d0d90" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>For <span tex="c_a" bookmark="moose-equation-0d4ea9b4-ac96-4baa-82c4-9c77c7af0faf" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0d4ea9b4-ac96-4baa-82c4-9c77c7af0faf"><script>var element = document.getElementById("moose-equation-0d4ea9b4-ac96-4baa-82c4-9c77c7af0faf");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c_a} = \phi_j [1-h(\eta)]" bookmark="moose-equation-b4da2a83-bb58-4851-a08e-0ffa52bc2a4f" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-b4da2a83-bb58-4851-a08e-0ffa52bc2a4f"></span><script>var element = document.getElementById("moose-equation-b4da2a83-bb58-4851-a08e-0ffa52bc2a4f");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c_a} = \\phi_j [1-h(\\eta)]", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For <span tex="c" bookmark="moose-equation-642b8c3b-5445-4d2f-aa79-02bdcc32a969" recursive="True" class="moose-katex-inline-equation" id="moose-equation-642b8c3b-5445-4d2f-aa79-02bdcc32a969"><script>var element = document.getElementById("moose-equation-642b8c3b-5445-4d2f-aa79-02bdcc32a969");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c} = -\phi_j" bookmark="moose-equation-9fa7cd51-ccb6-4855-b521-97c0cac513e3" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-9fa7cd51-ccb6-4855-b521-97c0cac513e3"></span><script>var element = document.getElementById("moose-equation-9fa7cd51-ccb6-4855-b521-97c0cac513e3");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c} = -\\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For <span tex="\eta" bookmark="moose-equation-fb3d406a-2e1c-4fd7-9a92-4905be5b3bb8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-fb3d406a-2e1c-4fd7-9a92-4905be5b3bb8"><script>var element = document.getElementById("moose-equation-fb3d406a-2e1c-4fd7-9a92-4905be5b3bb8");katex.render("\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial \eta} = \phi_j \frac{dh}{d\eta}(c_b-c_a)" bookmark="moose-equation-c3cc61c0-b8c6-48f0-8799-ea8c93f3622a" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-c3cc61c0-b8c6-48f0-8799-ea8c93f3622a"></span><script>var element = document.getElementById("moose-equation-c3cc61c0-b8c6-48f0-8799-ea8c93f3622a");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial \\eta} = \\phi_j \\frac{dh}{d\\eta}(c_b-c_a)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> </p></section></section><section class="scrollspy" id="a3f920a8-cb5e-40ec-993c-0acef4fa2834" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="kim_phase-field_1999">Seong&nbsp;Gyoon Kim, Won&nbsp;Tae Kim, and Toshio Suzuki.
Phase-field model for binary alloys.
<em>Physical Review E</em>, 60(6):7186&ndash;7197, December 1999.
URL: <a href="http://link.aps.org/doi/10.1103/PhysRevE.60.7186">http://link.aps.org/doi/10.1103/PhysRevE.60.7186</a>, <a href="https://doi.org/10.1103/PhysRevE.60.7186">doi:10.1103/PhysRevE.60.7186</a>.<a href="#7178312b-1287-4330-8cca-8275a00ba0ce" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="7178312b-1287-4330-8cca-8275a00ba0ce"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{kim_phase-field_1999,
    author = "Kim, Seong Gyoon and Kim, Won Tae and Suzuki, Toshio",
    title = "Phase-field model for binary alloys",
    volume = "60",
    url = "http://link.aps.org/doi/10.1103/PhysRevE.60.7186",
    doi = "10.1103/PhysRevE.60.7186",
    number = "6",
    urldate = "2014-03-31",
    journal = "Physical Review E",
    month = "December",
    year = "1999",
    pages = "7186-7197"
}
</code></pre></div></div></li></ol></div></section></section></section></section></section></section></section></section></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#860ae17a-1c84-42ed-8a8a-1c2595e02288" class="tooltipped" data-position="left" data-tooltip="KKSSplitCHCRes">KKSSplitCHCRes</a></li><li><a href="#f6295987-ea15-4da2-9490-87d71ece8dcf" class="tooltipped" data-position="left" data-tooltip="Residual">Residual</a></li><li><a href="#662da649-3bde-488d-b5bb-84f3b25e110b" class="tooltipped" data-position="left" data-tooltip="KKSCHBulk">KKSCHBulk</a></li><li><a href="#e6347720-5b98-4bc2-89f4-6e6c3fb06600" class="tooltipped" data-position="left" data-tooltip="KKSACBulkF">KKSACBulkF</a></li><li><a href="#7a237ade-81f5-4180-92f1-8c0ee1a037f3" class="tooltipped" data-position="left" data-tooltip="KKSACBulkC">KKSACBulkC</a></li><li><a href="#16a48e7d-2daf-4525-a9f2-b9fa5e51fe21" class="tooltipped" data-position="left" data-tooltip="KKSPhaseChemicalPotential">KKSPhaseChemicalPotential</a></li><li><a href="#9457439f-25a4-4889-ba82-0843f1c1e189" class="tooltipped" data-position="left" data-tooltip="KKSPhaseConcentration">KKSPhaseConcentration</a></li><li><a href="#a3f920a8-cb5e-40ec-993c-0acef4fa2834" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script>