<!DOCTYPE html><head><meta charset="UTF-8"><title>KKSDerivations.md|RACCOON</title><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="2849a593-2f2a-41a6-9419-98e31f6a4838"><i class="material-icons">menu</i></a><ul class="sidenav" id="2849a593-2f2a-41a6-9419-98e31f6a4838"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="../.." class="breadcrumb">modules</a><a href=".." class="breadcrumb">phase_field</a><span class="breadcrumb">MultiPhase</span><a href="#" class="breadcrumb">KKSDerivations</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="b9a90404-1686-4bc2-9648-2691fb57c5f8" data-section-level="1" data-section-text="KKS Model Definitions"><h1 id="kks-model-definitions">KKS Model Definitions</h1><p><span class="moose-katex-block-equation"><span tex="F = [1-h(\eta)]F_a + h(\eta)F_b+wg(\eta)" bookmark="moose-equation-bbbf9809-6520-48a5-8cd3-2228c328b8c3" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-bbbf9809-6520-48a5-8cd3-2228c328b8c3"></span><script>var element = document.getElementById("moose-equation-bbbf9809-6520-48a5-8cd3-2228c328b8c3");katex.render("F = [1-h(\\eta)]F_a + h(\\eta)F_b+wg(\\eta)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="c =  [1-h(\eta)]c_a + h(\eta)c_b" bookmark="moose-equation-36d3fb9c-676e-4dba-9315-8a2642d54b76" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-36d3fb9c-676e-4dba-9315-8a2642d54b76"></span><script>var element = document.getElementById("moose-equation-36d3fb9c-676e-4dba-9315-8a2642d54b76");katex.render("c =  [1-h(\\eta)]c_a + h(\\eta)c_b", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="\frac{dF_a}{dc_a} = \frac{dF_b}{dc_b}" bookmark="moose-equation-6b8313fd-c242-4c2d-bbb3-e91646e3e944" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-6b8313fd-c242-4c2d-bbb3-e91646e3e944"></span><script>var element = document.getElementById("moose-equation-6b8313fd-c242-4c2d-bbb3-e91646e3e944");katex.render("\\frac{dF_a}{dc_a} = \\frac{dF_b}{dc_b}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="3b64855f-2afb-43bc-ad03-a109161bbf3d" data-section-level="1" data-section-text="Materials"><h1 id="materials">Materials</h1><p>The KKS system (<a href="#kim_phase-field_1999">Kim et al. (1999)</a>) uses multiple MOOSE materials to provide values for free energy  functions, the switching function <span tex="h(\eta)" bookmark="moose-equation-5856ddd7-6397-4913-93b3-9b6383eaad98" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5856ddd7-6397-4913-93b3-9b6383eaad98"><script>var element = document.getElementById("moose-equation-5856ddd7-6397-4913-93b3-9b6383eaad98");katex.render("h(\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, and the double well function <span tex="g(\eta)" bookmark="moose-equation-1d6ea6e0-064b-4ae4-8696-83438759addc" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1d6ea6e0-064b-4ae4-8696-83438759addc"><script>var element = document.getElementById("moose-equation-1d6ea6e0-064b-4ae4-8696-83438759addc");katex.render("g(\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Providing these as materials allows the functions to be bundled in a single place, while being used by multiple kernels. Furthermore the automatic differentiation feature used in the parsed function materials prreplovides the necessary derivatives at no cost to the developer. The derivatives are stored in material properties and follow a naming scheme that is defined in <code>KKSBaseMaterial.C</code>.</p></section><section id="b3c1b977-e6b4-4f61-b412-9c460fd426ad" data-section-level="1" data-section-text="Cahn - Hilliard Kernels"><h1 id="cahn-hilliard-kernels">Cahn-Hilliard Kernels</h1><section class="scrollspy" id="20c27e45-455e-4884-81fc-8dbd62a7e27b" data-section-level="2" data-section-text="KKSSplitCHCRes"><h2 id="kkssplitchcres">KKSSplitCHCRes</h2><p><a href="../../../source/kernels/KKSSplitCHCRes.html"><code>KKSSplitCHCRes</code></a> is the split version. In this kernel, we calculate the chemical potential <span tex="\mu" bookmark="moose-equation-86d68f01-8b9c-4cf2-a690-6cb1c007249a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-86d68f01-8b9c-4cf2-a690-6cb1c007249a"><script>var element = document.getElementById("moose-equation-86d68f01-8b9c-4cf2-a690-6cb1c007249a");katex.render("\\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> from <span tex="\frac{\partial F}{\partial c}" bookmark="moose-equation-f01768a6-99b1-4a5d-b97b-3a7b93f76743" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f01768a6-99b1-4a5d-b97b-3a7b93f76743"><script>var element = document.getElementById("moose-equation-f01768a6-99b1-4a5d-b97b-3a7b93f76743");katex.render("\\frac{\\partial F}{\\partial c}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. The non-linear variable for this Kernel is the concentration <span tex="c" bookmark="moose-equation-6c0a2e0d-4305-44cd-9ed8-69d6d5a37d14" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6c0a2e0d-4305-44cd-9ed8-69d6d5a37d14"><script>var element = document.getElementById("moose-equation-6c0a2e0d-4305-44cd-9ed8-69d6d5a37d14");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. To calculate <span tex="\frac{\partial c}{\partial t}" bookmark="moose-equation-7a0c3d93-6243-4934-b1c7-25c2aa695817" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7a0c3d93-6243-4934-b1c7-25c2aa695817"><script>var element = document.getElementById("moose-equation-7a0c3d93-6243-4934-b1c7-25c2aa695817");katex.render("\\frac{\\partial c}{\\partial t}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="\nabla \cdot M(c) \nabla \mu" bookmark="moose-equation-932b8e44-2b1c-42c7-9d84-cbc190ae24b2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-932b8e44-2b1c-42c7-9d84-cbc190ae24b2"><script>var element = document.getElementById("moose-equation-932b8e44-2b1c-42c7-9d84-cbc190ae24b2");katex.render("\\nabla \\cdot M(c) \\nabla \\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, we use the <a href="../../../source/kernels/CoupledTimeDerivative.html"><code>CoupledTimeDerivative</code></a> and <a href="../../../source/kernels/SplitCHWRes.html"><code>SplitCHWRes</code></a> kernels, respectively, as described <a href="../Phase_Field_Equations.html">here</a>.</p></section><section class="scrollspy" id="344f272e-07b8-4c82-b08f-ceea7f70fca5" data-section-level="2" data-section-text="Residual"><h2 id="residual">Residual</h2><p>In the residual routine we need to calculate the term <span tex="R= \frac{\partial F}{\partial c} - \mu" bookmark="moose-equation-c76b6fa2-c7d5-46ad-906e-d1c05b5c1e59" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c76b6fa2-c7d5-46ad-906e-d1c05b5c1e59"><script>var element = document.getElementById("moose-equation-c76b6fa2-c7d5-46ad-906e-d1c05b5c1e59");katex.render("R= \\frac{\\partial F}{\\partial c} - \\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We exploit the KKS identity <span tex="\frac{\partial F}{\partial c}=\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}" bookmark="moose-equation-6be3d953-c6ee-4192-a434-bb610ab1d0ff" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6be3d953-c6ee-4192-a434-bb610ab1d0ff"><script>var element = document.getElementById("moose-equation-6be3d953-c6ee-4192-a434-bb610ab1d0ff");katex.render("\\frac{\\partial F}{\\partial c}=\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and arbitrarily use the a-phase instead.</p><p><span class="moose-katex-block-equation"><span tex="R = \frac{\partial F_a}{\partial c_a} - \mu" bookmark="moose-equation-1e3e9546-c206-4821-821a-cf0ef5e5b957" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-1e3e9546-c206-4821-821a-cf0ef5e5b957"></span><script>var element = document.getElementById("moose-equation-1e3e9546-c206-4821-821a-cf0ef5e5b957");katex.render("R = \\frac{\\partial F_a}{\\partial c_a} - \\mu", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><section id="2ed86438-c2dc-489a-b4b5-d3807c96223e" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="0563ef32-de53-4e29-ac01-11770cb677f4" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p>Since there is no explicit dependence on the non-linear variable <span tex="c" bookmark="moose-equation-ccd833f2-7c5e-4a7c-bd8a-8112c5613c92" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ccd833f2-7c5e-4a7c-bd8a-8112c5613c92"><script>var element = document.getElementById("moose-equation-ccd833f2-7c5e-4a7c-bd8a-8112c5613c92");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> in the residual equation, the diagonal components are zero.</p></section><section id="048472b6-5b6d-4fb1-85c1-290f8b81f3d2" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-9691c308-6f65-4a95-95b5-b8f47f94dc18" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9691c308-6f65-4a95-95b5-b8f47f94dc18"><script>var element = document.getElementById("moose-equation-9691c308-6f65-4a95-95b5-b8f47f94dc18");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-4410b7b4-e19f-45d7-9a51-aa94bb661998" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4410b7b4-e19f-45d7-9a51-aa94bb661998"><script>var element = document.getElementById("moose-equation-4410b7b4-e19f-45d7-9a51-aa94bb661998");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv c_a" bookmark="moose-equation-4ed93514-734c-4168-8315-871ece1dc61f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4ed93514-734c-4168-8315-871ece1dc61f"><script>var element = document.getElementById("moose-equation-4ed93514-734c-4168-8315-871ece1dc61f");katex.render("u\\equiv c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial c_a}{\partial u_j}\frac{\partial}{\partial c_a}=\phi_j \frac{\partial}{\partial c_a}" bookmark="moose-equation-3402f852-2afb-4a09-b29f-77b54e3bb13b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3402f852-2afb-4a09-b29f-77b54e3bb13b"><script>var element = document.getElementById("moose-equation-3402f852-2afb-4a09-b29f-77b54e3bb13b");katex.render("\\frac{\\partial c_a}{\\partial u_j}\\frac{\\partial}{\\partial c_a}=\\phi_j \\frac{\\partial}{\\partial c_a}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \frac{\partial R}{\partial u_j} = \phi_j \frac{\partial}{\partial c_a} \left( \frac{\partial F}{\partial c_a} - \mu \right)\\ &=& \phi_j  \frac{\partial^2F}{\partial c_a^2} \\ \end{aligned}" bookmark="moose-equation-241e5a27-f420-4488-bd92-0943aec5461d" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-241e5a27-f420-4488-bd92-0943aec5461d"></span><script>var element = document.getElementById("moose-equation-241e5a27-f420-4488-bd92-0943aec5461d");katex.render("\\begin{aligned} J &=& \\frac{\\partial R}{\\partial u_j} = \\phi_j \\frac{\\partial}{\\partial c_a} \\left( \\frac{\\partial F}{\\partial c_a} - \\mu \\right)\\\\ &=& \\phi_j  \\frac{\\partial^2F}{\\partial c_a^2} \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For <span tex="\mu" bookmark="moose-equation-ddd827bd-95a4-48ee-8abd-ab47cf1acf1b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ddd827bd-95a4-48ee-8abd-ab47cf1acf1b"><script>var element = document.getElementById("moose-equation-ddd827bd-95a4-48ee-8abd-ab47cf1acf1b");katex.render("\\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial \mu} \left( \frac{\partial F}{\partial c_a} - \mu \right)\\ &=& -\phi_j \\ \end{aligned}" bookmark="moose-equation-db1bf1f9-ed55-401a-a44a-17bd2d35bcf5" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-db1bf1f9-ed55-401a-a44a-17bd2d35bcf5"></span><script>var element = document.getElementById("moose-equation-db1bf1f9-ed55-401a-a44a-17bd2d35bcf5");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial \\mu} \\left( \\frac{\\partial F}{\\partial c_a} - \\mu \\right)\\\\ &=& -\\phi_j \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section></section><section class="scrollspy" id="fe0762a3-6269-4d28-ad74-b07aacc162d8" data-section-level="2" data-section-text="KKSCHBulk"><h2 id="kkschbulk">KKSCHBulk</h2><p><a href="../../../source/kernels/KKSCHBulk.html"><code>KKSCHBulk</code></a> is the non-split version, which is <em></em>not fully implemented**. The non-linear variable for this Kernel is the concentration <span tex="c" bookmark="moose-equation-c540e5ec-2f83-42f0-84a3-ba0b16a4e52c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c540e5ec-2f83-42f0-84a3-ba0b16a4e52c"><script>var element = document.getElementById("moose-equation-c540e5ec-2f83-42f0-84a3-ba0b16a4e52c");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><section id="7862c618-00e3-4834-b155-8baff87423fe" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p>In the residual routine we need to calculate the term <span tex="R=\nabla \frac{dF}{dc}" bookmark="moose-equation-688fff7d-df78-4994-abb8-af00f50653a6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-688fff7d-df78-4994-abb8-af00f50653a6"><script>var element = document.getElementById("moose-equation-688fff7d-df78-4994-abb8-af00f50653a6");katex.render("R=\\nabla \\frac{dF}{dc}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We exploit the KKS identity <span tex="\frac{dF}{dc}=\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}" bookmark="moose-equation-8eba4ede-531b-4045-bc8c-c454d916750b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8eba4ede-531b-4045-bc8c-c454d916750b"><script>var element = document.getElementById("moose-equation-8eba4ede-531b-4045-bc8c-c454d916750b");katex.render("\\frac{dF}{dc}=\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and arbitrarily use the a-phase instead. The gradient can be calculated through the chain rule (note that <span tex="F_a(c_a, p_1,p_2,\dots,p_n)" bookmark="moose-equation-5b52efc7-97a4-4818-bc8c-9dd42ad3f127" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5b52efc7-97a4-4818-bc8c-9dd42ad3f127"><script>var element = document.getElementById("moose-equation-5b52efc7-97a4-4818-bc8c-9dd42ad3f127");katex.render("F_a(c_a, p_1,p_2,\\dots,p_n)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is potentially a function of many variables).</p><p><span class="moose-katex-block-equation"><span tex="R = \nabla \frac{dF_a}{dc_a} = \frac{d^2F_a}{dc_a^2}\nabla c_a + \sum_i \frac{d^2F_a}{dc_adp_i}\nabla p_i" bookmark="moose-equation-d0010770-821e-41bc-b7ee-e6941a9f1947" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-d0010770-821e-41bc-b7ee-e6941a9f1947"></span><script>var element = document.getElementById("moose-equation-d0010770-821e-41bc-b7ee-e6941a9f1947");katex.render("R = \\nabla \\frac{dF_a}{dc_a} = \\frac{d^2F_a}{dc_a^2}\\nabla c_a + \\sum_i \\frac{d^2F_a}{dc_adp_i}\\nabla p_i", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>With <span tex="a = \{c_a, p_1,p_2,\dots,p_n\}" bookmark="moose-equation-691550c9-ac8f-4f26-afbc-c8e5505ca9ad" recursive="True" class="moose-katex-inline-equation" id="moose-equation-691550c9-ac8f-4f26-afbc-c8e5505ca9ad"><script>var element = document.getElementById("moose-equation-691550c9-ac8f-4f26-afbc-c8e5505ca9ad");katex.render("a = \\{c_a, p_1,p_2,\\dots,p_n\\}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> being the vector of all arguments to <span tex="F_a" bookmark="moose-equation-688af0bd-b271-4072-8f19-61d90925c11c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-688af0bd-b271-4072-8f19-61d90925c11c"><script>var element = document.getElementById("moose-equation-688af0bd-b271-4072-8f19-61d90925c11c");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> this simplifies to</p><p><span class="moose-katex-block-equation"><span tex="R=\sum_i \frac{d^2F_a}{dc_ada_i}\nabla a_i  = \sum_i R_i \nabla a_i" bookmark="moose-equation-84310243-d483-449f-ac87-d29bde1011bf" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-84310243-d483-449f-ac87-d29bde1011bf"></span><script>var element = document.getElementById("moose-equation-84310243-d483-449f-ac87-d29bde1011bf");katex.render("R=\\sum_i \\frac{d^2F_a}{dc_ada_i}\\nabla a_i  = \\sum_i R_i \\nabla a_i", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>using <span tex="R_i" bookmark="moose-equation-37919393-8491-4ef2-81dd-0d45249a3dae" recursive="True" class="moose-katex-inline-equation" id="moose-equation-37919393-8491-4ef2-81dd-0d45249a3dae"><script>var element = document.getElementById("moose-equation-37919393-8491-4ef2-81dd-0d45249a3dae");katex.render("R_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> as a shorthand for the term <span tex="\frac{d^2F_a}{dc_ada_i}" bookmark="moose-equation-c0156afa-1363-4c59-9d23-faa57ccb4897" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c0156afa-1363-4c59-9d23-faa57ccb4897"><script>var element = document.getElementById("moose-equation-c0156afa-1363-4c59-9d23-faa57ccb4897");katex.render("\\frac{d^2F_a}{dc_ada_i}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (and represented in the code as the array <code>_second_derivatives[i]</code>). We do have access to the gradients of <span tex="a_i" bookmark="moose-equation-b0dcc4d4-da2f-429e-8ad5-124d752ec3e6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b0dcc4d4-da2f-429e-8ad5-124d752ec3e6"><script>var element = document.getElementById("moose-equation-b0dcc4d4-da2f-429e-8ad5-124d752ec3e6");katex.render("a_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> through MOOSE (stored in <code>_grad\_args[i]</code>).</p></section><section id="28035b42-b30f-468b-b824-b91a34a58460" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><p>The calculation of the Jacobian involves the derivative of the Residual term <span tex="R" bookmark="moose-equation-dd902d8b-76b7-42e2-a68e-0c5f21586ad6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-dd902d8b-76b7-42e2-a68e-0c5f21586ad6"><script>var element = document.getElementById("moose-equation-dd902d8b-76b7-42e2-a68e-0c5f21586ad6");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> w.r.t. the individual coefficients <span tex="u_j" bookmark="moose-equation-42056553-f397-4f79-9877-b490cefb69fa" recursive="True" class="moose-katex-inline-equation" id="moose-equation-42056553-f397-4f79-9877-b490cefb69fa"><script>var element = document.getElementById("moose-equation-42056553-f397-4f79-9877-b490cefb69fa");katex.render("u_j", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> of all parameters of <span tex="F_a" bookmark="moose-equation-e6416f3d-d208-4472-955d-7bcd3f3d04c2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e6416f3d-d208-4472-955d-7bcd3f3d04c2"><script>var element = document.getElementById("moose-equation-e6416f3d-d208-4472-955d-7bcd3f3d04c2");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Here <span tex="u" bookmark="moose-equation-6e218d81-f91f-461d-8588-ed3b39179d6e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6e218d81-f91f-461d-8588-ed3b39179d6e"><script>var element = document.getElementById("moose-equation-6e218d81-f91f-461d-8588-ed3b39179d6e");katex.render("u", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> can stand for any variable <span tex="a_i" bookmark="moose-equation-bd097b19-13c3-48db-9856-26f07043455b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-bd097b19-13c3-48db-9856-26f07043455b"><script>var element = document.getElementById("moose-equation-bd097b19-13c3-48db-9856-26f07043455b");katex.render("a_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = \sum_i \left[ \frac d{du_j} R_i\nabla a_i \right] = \sum_i \left[  R_i\frac{d\nabla a_i}{du_j} + \nabla a_i \sum_k \frac {dR_i}{da_k}\frac{da_k}{du_j} \right]" bookmark="moose-equation-a0bcb282-1fb2-4e61-9700-568250d8e5d0" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-a0bcb282-1fb2-4e61-9700-568250d8e5d0"></span><script>var element = document.getElementById("moose-equation-a0bcb282-1fb2-4e61-9700-568250d8e5d0");katex.render("\\frac{dR}{du_j} = \\sum_i \\left[ \\frac d{du_j} R_i\\nabla a_i \\right] = \\sum_i \\left[  R_i\\frac{d\\nabla a_i}{du_j} + \\nabla a_i \\sum_k \\frac {dR_i}{da_k}\\frac{da_k}{du_j} \\right]", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>In the code <span tex="u" bookmark="moose-equation-e8cdc1dc-b90a-43b2-8206-f788e8d4063b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e8cdc1dc-b90a-43b2-8206-f788e8d4063b"><script>var element = document.getElementById("moose-equation-e8cdc1dc-b90a-43b2-8206-f788e8d4063b");katex.render("u", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is given by <code>jvar</code> for the off diagonal case, and <span tex="c" bookmark="moose-equation-52d4d810-5a5d-4b94-a50c-5a11b68ba0ed" recursive="True" class="moose-katex-inline-equation" id="moose-equation-52d4d810-5a5d-4b94-a50c-5a11b68ba0ed"><script>var element = document.getElementById("moose-equation-52d4d810-5a5d-4b94-a50c-5a11b68ba0ed");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (not <span tex="c_a" bookmark="moose-equation-5f6ab607-03e2-488e-982e-0787b86ce7d8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5f6ab607-03e2-488e-982e-0787b86ce7d8"><script>var element = document.getElementById("moose-equation-5f6ab607-03e2-488e-982e-0787b86ce7d8");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> or <span tex="c_b" bookmark="moose-equation-0d55374f-56b9-4adf-bba7-28b8d93980de" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0d55374f-56b9-4adf-bba7-28b8d93980de"><script>var element = document.getElementById("moose-equation-0d55374f-56b9-4adf-bba7-28b8d93980de");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>!) in the on diagonal case.</p><section id="54af0a9f-07ed-4725-aa4a-0afaa0dcf211" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>Let&#x27;s focus on off diagonal first. Here <span tex="\frac{da_k}{du_j}" bookmark="moose-equation-aae9e086-1b57-46c7-b17f-21f9e46b4e13" recursive="True" class="moose-katex-inline-equation" id="moose-equation-aae9e086-1b57-46c7-b17f-21f9e46b4e13"><script>var element = document.getElementById("moose-equation-aae9e086-1b57-46c7-b17f-21f9e46b4e13");katex.render("\\frac{da_k}{du_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is zero, if <code>jvar</code> is not equal <span tex="k" bookmark="moose-equation-dc00b830-a7b6-4918-b521-01236bb7b1de" recursive="True" class="moose-katex-inline-equation" id="moose-equation-dc00b830-a7b6-4918-b521-01236bb7b1de"><script>var element = document.getElementById("moose-equation-dc00b830-a7b6-4918-b521-01236bb7b1de");katex.render("k", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Allowing us to remove the sum over <span tex="k" bookmark="moose-equation-4b07d2cd-f4bc-4478-856f-994307f4eca8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4b07d2cd-f4bc-4478-856f-994307f4eca8"><script>var element = document.getElementById("moose-equation-4b07d2cd-f4bc-4478-856f-994307f4eca8");katex.render("k", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and replace it with the single non-zero summand</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = \sum_i \left[  R_i\frac{d\nabla a_i}{du_j} + \nabla a_i \frac {dR_i}{da_\text{jvar}}\frac{da_\text{jvar}}{du_j} \right]" bookmark="moose-equation-cc02931b-e28d-467d-9464-572cc4167871" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-cc02931b-e28d-467d-9464-572cc4167871"></span><script>var element = document.getElementById("moose-equation-cc02931b-e28d-467d-9464-572cc4167871");katex.render("\\frac{dR}{du_j} = \\sum_i \\left[  R_i\\frac{d\\nabla a_i}{du_j} + \\nabla a_i \\frac {dR_i}{da_\\text{jvar}}\\frac{da_\\text{jvar}}{du_j} \\right]", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>In the first term in the square brackets the derivative <span tex="\frac{d\nabla a_i}{du_j}" bookmark="moose-equation-3e2fe799-daad-4783-bcea-01c8d2efc684" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3e2fe799-daad-4783-bcea-01c8d2efc684"><script>var element = document.getElementById("moose-equation-3e2fe799-daad-4783-bcea-01c8d2efc684");katex.render("\\frac{d\\nabla a_i}{du_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is only non-zero if <span tex="i" bookmark="moose-equation-36150a68-6829-4aec-a4c6-0a82017b44c9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-36150a68-6829-4aec-a4c6-0a82017b44c9"><script>var element = document.getElementById("moose-equation-36150a68-6829-4aec-a4c6-0a82017b44c9");katex.render("i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is <code>jvar</code>. We can therefore pull this term out of the sum.</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = R_\text{jvar}\frac{d\nabla a_\text{jvar}}{du_j} + \sum_i  \nabla a_i \frac {dR_i}{da_\text{jvar}}\frac{da_\text{jvar}}{du_j}" bookmark="moose-equation-6cd0f523-b572-4bce-8825-704199ca58ee" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-6cd0f523-b572-4bce-8825-704199ca58ee"></span><script>var element = document.getElementById("moose-equation-6cd0f523-b572-4bce-8825-704199ca58ee");katex.render("\\frac{dR}{du_j} = R_\\text{jvar}\\frac{d\\nabla a_\\text{jvar}}{du_j} + \\sum_i  \\nabla a_i \\frac {dR_i}{da_\\text{jvar}}\\frac{da_\\text{jvar}}{du_j}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>With the rules for <span tex="\frac d{du_j}" bookmark="moose-equation-3d01694b-738f-46a0-8ab4-65317a7b8eed" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3d01694b-738f-46a0-8ab4-65317a7b8eed"><script>var element = document.getElementById("moose-equation-3d01694b-738f-46a0-8ab4-65317a7b8eed");katex.render("\\frac d{du_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivatives we get</p><p><span class="moose-katex-block-equation"><span tex="R_\text{jvar} \nabla \phi_j + \sum_i \nabla a_i \frac {dR_i}{da_\text{jvar}} \phi_j" bookmark="moose-equation-915df828-b913-4f5e-9643-e3f6fef95f95" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-915df828-b913-4f5e-9643-e3f6fef95f95"></span><script>var element = document.getElementById("moose-equation-915df828-b913-4f5e-9643-e3f6fef95f95");katex.render("R_\\text{jvar} \\nabla \\phi_j + \\sum_i \\nabla a_i \\frac {dR_i}{da_\\text{jvar}} \\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>where <span tex="j" bookmark="moose-equation-03379d5f-7645-459f-8dbf-b59f9fbbaec2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-03379d5f-7645-459f-8dbf-b59f9fbbaec2"><script>var element = document.getElementById("moose-equation-03379d5f-7645-459f-8dbf-b59f9fbbaec2");katex.render("j", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is <code>_j</code> in the code.</p></section><section id="8dc531a9-4a01-4b6c-934e-9535afbb1e5c" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>For the on diagonal terms we look at the derivative w.r.t. the components of the non-linear variable <span tex="c" bookmark="moose-equation-9549ffce-d27e-465d-ab2c-e3ec9582f93f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9549ffce-d27e-465d-ab2c-e3ec9582f93f"><script>var element = document.getElementById("moose-equation-9549ffce-d27e-465d-ab2c-e3ec9582f93f");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> of this kernel. Note, that <span tex="F_a" bookmark="moose-equation-6feb75a1-0eeb-401a-9b9b-2018e0ef67ba" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6feb75a1-0eeb-401a-9b9b-2018e0ef67ba"><script>var element = document.getElementById("moose-equation-6feb75a1-0eeb-401a-9b9b-2018e0ef67ba");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is only indirectly a function of <span tex="c" bookmark="moose-equation-71daa5bd-2206-4176-9769-b90dfbc0e85d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-71daa5bd-2206-4176-9769-b90dfbc0e85d"><script>var element = document.getElementById("moose-equation-71daa5bd-2206-4176-9769-b90dfbc0e85d");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We assume the dependence is given through <span tex="c(c_a)" bookmark="moose-equation-f3e95837-8d5b-46eb-9ecc-8571e3b913b8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f3e95837-8d5b-46eb-9ecc-8571e3b913b8"><script>var element = document.getElementById("moose-equation-f3e95837-8d5b-46eb-9ecc-8571e3b913b8");katex.render("c(c_a)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. The chain rule will thus yield terms of this form</p><p><span class="moose-katex-block-equation"><span tex="\frac{dc_a}{dc} = \frac{\frac{d^2F_b}{dc_b^2}}{[1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2}}," bookmark="moose-equation-fafc17a5-b1b3-4543-95d4-58490035c5a4" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-fafc17a5-b1b3-4543-95d4-58490035c5a4"></span><script>var element = document.getElementById("moose-equation-fafc17a5-b1b3-4543-95d4-58490035c5a4");katex.render("\\frac{dc_a}{dc} = \\frac{\\frac{d^2F_b}{dc_b^2}}{[1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2}},", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>which is given as equation (23) in KKS. Following the off-diagonal  derivation we get</p><p>v \frac{d<sup>2F_a}{dc_a</sup>2}\frac{dc_a}{dc} \nabla \phi_j + \sum_i \nabla a_i \frac {dR_i}{dc_a} \frac{dc_a}{dc} \phi_j \end{equation}</p></section><section id="5561829d-8aa4-4d3d-8d32-6c443574a8de" data-section-level="4" data-section-text="On - diagonal second approach"><h4 id="on-diagonal-second-approach">On-diagonal second approach</h4><p>Let&#x27;s get back to the original residual with <span tex="\frac{dF}{dc}" bookmark="moose-equation-dcc13c68-8af3-427c-b875-5d7d089e516d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-dcc13c68-8af3-427c-b875-5d7d089e516d"><script>var element = document.getElementById("moose-equation-dcc13c68-8af3-427c-b875-5d7d089e516d");katex.render("\\frac{dF}{dc}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Then</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{d}{dc} \nabla \frac{dF}{dc}\\ &=& \phi_j  \nabla \frac{d^2F}{dc^2} \quad,\quad \text{with (29) from KKS}\\ &=& \phi_j  \nabla \frac{\frac{d^2F_b}{dc_b^2}\frac{d^2F_a}{dc_a^2}}{  [1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2} }\\ \end{aligned}" bookmark="moose-equation-4eda971e-2b76-4679-9f2d-723ff45c2db1" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-4eda971e-2b76-4679-9f2d-723ff45c2db1"></span><script>var element = document.getElementById("moose-equation-4eda971e-2b76-4679-9f2d-723ff45c2db1");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{d}{dc} \\nabla \\frac{dF}{dc}\\\\ &=& \\phi_j  \\nabla \\frac{d^2F}{dc^2} \\quad,\\quad \\text{with (29) from KKS}\\\\ &=& \\phi_j  \\nabla \\frac{\\frac{d^2F_b}{dc_b^2}\\frac{d^2F_a}{dc_a^2}}{  [1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2} }\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section></section><section id="8feaafe7-9c64-4a16-9307-ec0549c5fa34" data-section-level="1" data-section-text="Allen - Cahn Kernels"><h1 id="allen-cahn-kernels">Allen-Cahn  Kernels</h1><p>For the bulk Allen-Cahn residual we need to calculate the term</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R=\frac{dF}{d\eta}&=&\frac{d}{d\eta}\left([1-h(\eta)]F_a + h(\eta)F_b+wg(\eta) \right)\\ &=& \frac{dF_a}{d\eta}+\frac{d}{d\eta}\left(h(\eta)F_b-h(\eta)F_a + wg(\eta)\right)\\ &=& \frac{dF_a}{d\eta}+F_b\frac{dh}{d\eta}-F_a\frac{dh}{d\eta}+h(\eta)\frac{dF_b}{d\eta}-h(\eta)\frac{dF_a}{d\eta} +w\frac{dg}{d\eta}\\ &=& \frac{dF_a}{d\eta}+\frac{dh}{d\eta}(F_b-F_a)+h(\eta)\left(\frac{dF_b}{d\eta}-\frac{dF_a}{d\eta}\right) +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + \underbrace{[1-h(\eta)]\frac{dF_a}{d\eta} + h(\eta)\frac{dF_b}{d\eta}}_{\text{chain rule term}} +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + [1-h(\eta)]\frac{dF_a}{dc_a}\frac{dc_a}{d\eta} + h(\eta)\frac{dF_b}{dc_b}\frac{dc_b}{d\eta} +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + \frac{dF_a}{dc_a}\left([1-h(\eta)]\frac{dc_a}{d\eta} + h(\eta)\frac{dc_b}{d\eta}\right) +w\frac{dg}{d\eta} \end{aligned}" bookmark="moose-equation-b51c6413-bb05-44ee-b48c-c29005a7780b" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-b51c6413-bb05-44ee-b48c-c29005a7780b"></span><script>var element = document.getElementById("moose-equation-b51c6413-bb05-44ee-b48c-c29005a7780b");katex.render("\\begin{aligned} R=\\frac{dF}{d\\eta}&=&\\frac{d}{d\\eta}\\left([1-h(\\eta)]F_a + h(\\eta)F_b+wg(\\eta) \\right)\\\\ &=& \\frac{dF_a}{d\\eta}+\\frac{d}{d\\eta}\\left(h(\\eta)F_b-h(\\eta)F_a + wg(\\eta)\\right)\\\\ &=& \\frac{dF_a}{d\\eta}+F_b\\frac{dh}{d\\eta}-F_a\\frac{dh}{d\\eta}+h(\\eta)\\frac{dF_b}{d\\eta}-h(\\eta)\\frac{dF_a}{d\\eta} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dF_a}{d\\eta}+\\frac{dh}{d\\eta}(F_b-F_a)+h(\\eta)\\left(\\frac{dF_b}{d\\eta}-\\frac{dF_a}{d\\eta}\\right) +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\underbrace{[1-h(\\eta)]\\frac{dF_a}{d\\eta} + h(\\eta)\\frac{dF_b}{d\\eta}}_{\\text{chain rule term}} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + [1-h(\\eta)]\\frac{dF_a}{dc_a}\\frac{dc_a}{d\\eta} + h(\\eta)\\frac{dF_b}{dc_b}\\frac{dc_b}{d\\eta} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\frac{dF_a}{dc_a}\\left([1-h(\\eta)]\\frac{dc_a}{d\\eta} + h(\\eta)\\frac{dc_b}{d\\eta}\\right) +w\\frac{dg}{d\\eta} \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>The _chain rule term_ results from the fact that <span tex="c_a" bookmark="moose-equation-db1f665d-8d0b-4a4d-8d42-2dee48ea7664" recursive="True" class="moose-katex-inline-equation" id="moose-equation-db1f665d-8d0b-4a4d-8d42-2dee48ea7664"><script>var element = document.getElementById("moose-equation-db1f665d-8d0b-4a4d-8d42-2dee48ea7664");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="c_b" bookmark="moose-equation-42e9a7f6-f0d8-43e3-9a94-2a3e5f2a19bb" recursive="True" class="moose-katex-inline-equation" id="moose-equation-42e9a7f6-f0d8-43e3-9a94-2a3e5f2a19bb"><script>var element = document.getElementById("moose-equation-42e9a7f6-f0d8-43e3-9a94-2a3e5f2a19bb");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> are dependent on <span tex="\eta" bookmark="moose-equation-eff63169-8fb3-44b6-896b-d2f3cc0c71c4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-eff63169-8fb3-44b6-896b-d2f3cc0c71c4"><script>var element = document.getElementById("moose-equation-eff63169-8fb3-44b6-896b-d2f3cc0c71c4");katex.render("\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (see eqs. (25) and (26) in KKS). Setting <span tex="\lambda = [1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2}" bookmark="moose-equation-81499615-f48d-4c63-8847-c6e6a015dd80" recursive="True" class="moose-katex-inline-equation" id="moose-equation-81499615-f48d-4c63-8847-c6e6a015dd80"><script>var element = document.getElementById("moose-equation-81499615-f48d-4c63-8847-c6e6a015dd80");katex.render("\\lambda = [1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> we get</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} \frac{dc_a}{d\eta} &=& \frac1\lambda \frac{dh}{d\eta}(c_a-c_b)\frac{d^2F_b}{dc_b^2}\\ \frac{dc_b}{d\eta} &=& \frac1\lambda \frac{dh}{d\eta}(c_a-c_b)\frac{d^2F_a}{dc_a^2}. \end{aligned}" bookmark="moose-equation-eb75aac4-b0ac-46a8-badc-b6318448892a" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-eb75aac4-b0ac-46a8-badc-b6318448892a"></span><script>var element = document.getElementById("moose-equation-eb75aac4-b0ac-46a8-badc-b6318448892a");katex.render("\\begin{aligned} \\frac{dc_a}{d\\eta} &=& \\frac1\\lambda \\frac{dh}{d\\eta}(c_a-c_b)\\frac{d^2F_b}{dc_b^2}\\\\ \\frac{dc_b}{d\\eta} &=& \\frac1\\lambda \\frac{dh}{d\\eta}(c_a-c_b)\\frac{d^2F_a}{dc_a^2}. \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Substituting this in we get</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R &=& \frac{dh}{d\eta}(F_b-F_a) + \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b)\frac1\lambda\underbrace{\left([1-h(\eta)] \frac{d^2F_b}{dc_b^2} + h(\eta)\frac{d^2F_a}{dc_a^2}\right)}_{=\lambda} +w\frac{dg}{d\eta}. \end{aligned}" bookmark="moose-equation-42eee4f0-a42c-4b03-8a81-bdb31ac53c65" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-42eee4f0-a42c-4b03-8a81-bdb31ac53c65"></span><script>var element = document.getElementById("moose-equation-42eee4f0-a42c-4b03-8a81-bdb31ac53c65");katex.render("\\begin{aligned} R &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b)\\frac1\\lambda\\underbrace{\\left([1-h(\\eta)] \\frac{d^2F_b}{dc_b^2} + h(\\eta)\\frac{d^2F_a}{dc_a^2}\\right)}_{=\\lambda} +w\\frac{dg}{d\\eta}. \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>This simplifies to</p><p><span class="moose-katex-block-equation"><span tex="R=-\frac{dh}{d\eta} \left(F_a-F_b-\frac{dF_a}{dc_a}(c_a-c_b)\right) + w\frac{dg}{d\eta}." bookmark="moose-equation-4482f0a3-1740-4818-8e18-dfb92fda89bb" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-4482f0a3-1740-4818-8e18-dfb92fda89bb"></span><script>var element = document.getElementById("moose-equation-4482f0a3-1740-4818-8e18-dfb92fda89bb");katex.render("R=-\\frac{dh}{d\\eta} \\left(F_a-F_b-\\frac{dF_a}{dc_a}(c_a-c_b)\\right) + w\\frac{dg}{d\\eta}.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>We split this residual into two kernels to allow for multiple phase concentrations in a multi component system:</p><section class="scrollspy" id="780fa520-a850-4e21-ba5f-b1b19b705fe5" data-section-level="2" data-section-text="KKSACBulkF"><h2><code>KKSACBulkF</code></h2><p><a href="../../../source/kernels/KKSACBulkF.html"><code>KKSACBulkF</code></a> is the part without a direct composition dependence.</p><section id="45b27278-8dba-4d68-ab37-20a343c34bc4" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=-\frac{dh}{d\eta}(F_a-F_b)+w\frac{dg}{d\eta}." bookmark="moose-equation-2048cc72-45db-44bc-a24a-e43560adb258" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-2048cc72-45db-44bc-a24a-e43560adb258"></span><script>var element = document.getElementById("moose-equation-2048cc72-45db-44bc-a24a-e43560adb258");katex.render("R=-\\frac{dh}{d\\eta}(F_a-F_b)+w\\frac{dg}{d\\eta}.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="86b7536a-4a31-4710-9b4b-5f1c77b8ded7" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="d2c01534-a072-4390-9586-f2d103011bdc" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-dce631f3-f092-4f73-b99d-decfd387564b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-dce631f3-f092-4f73-b99d-decfd387564b"><script>var element = document.getElementById("moose-equation-dce631f3-f092-4f73-b99d-decfd387564b");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-f5f9112e-7723-4aa4-b86b-d9ee5e017008" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f5f9112e-7723-4aa4-b86b-d9ee5e017008"><script>var element = document.getElementById("moose-equation-f5f9112e-7723-4aa4-b86b-d9ee5e017008");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv\eta" bookmark="moose-equation-cfd053dd-6864-4ae0-bffe-3cad925bf3f2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cfd053dd-6864-4ae0-bffe-3cad925bf3f2"><script>var element = document.getElementById("moose-equation-cfd053dd-6864-4ae0-bffe-3cad925bf3f2");katex.render("u\\equiv\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial \eta}{\partial u_j}\frac{\partial}{\partial \eta}=\phi_j \frac{\partial}{\partial\eta}" bookmark="moose-equation-67e346f5-34d1-4772-86a5-adc0e711d9bf" recursive="True" class="moose-katex-inline-equation" id="moose-equation-67e346f5-34d1-4772-86a5-adc0e711d9bf"><script>var element = document.getElementById("moose-equation-67e346f5-34d1-4772-86a5-adc0e711d9bf");katex.render("\\frac{\\partial \\eta}{\\partial u_j}\\frac{\\partial}{\\partial \\eta}=\\phi_j \\frac{\\partial}{\\partial\\eta}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& -\phi_j \frac{\partial}{\partial \eta}\left( \frac{dh}{d\eta}(F_a-F_b) \right) + w \phi_j \frac{\partial}{\partial \eta}\frac{dg}{d\eta} \\ &=&-\frac{d^2h}{d\eta^2}\phi_j(F_a-F_b) + w\frac{d^2g}{d\eta^2}\phi_j \\ \end{aligned}" bookmark="moose-equation-c5847104-e6e5-4de4-8378-fe4cd4dda06c" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-c5847104-e6e5-4de4-8378-fe4cd4dda06c"></span><script>var element = document.getElementById("moose-equation-c5847104-e6e5-4de4-8378-fe4cd4dda06c");katex.render("\\begin{aligned} J &=& -\\phi_j \\frac{\\partial}{\\partial \\eta}\\left( \\frac{dh}{d\\eta}(F_a-F_b) \\right) + w \\phi_j \\frac{\\partial}{\\partial \\eta}\\frac{dg}{d\\eta} \\\\ &=&-\\frac{d^2h}{d\\eta^2}\\phi_j(F_a-F_b) + w\\frac{d^2g}{d\\eta^2}\\phi_j \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>(The implicit dependence of <span tex="F_a(c_a)" bookmark="moose-equation-f758ea49-7d47-406a-be42-94446cee6fda" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f758ea49-7d47-406a-be42-94446cee6fda"><script>var element = document.getElementById("moose-equation-f758ea49-7d47-406a-be42-94446cee6fda");katex.render("F_a(c_a)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b(c_a)" bookmark="moose-equation-a2d519fd-197a-4993-98b6-a5e289c3c584" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a2d519fd-197a-4993-98b6-a5e289c3c584"><script>var element = document.getElementById("moose-equation-a2d519fd-197a-4993-98b6-a5e289c3c584");katex.render("F_b(c_a)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> on <span tex="\eta" bookmark="moose-equation-df93d9a2-59ac-4ce3-98b2-f33d3f9e7378" recursive="True" class="moose-katex-inline-equation" id="moose-equation-df93d9a2-59ac-4ce3-98b2-f33d3f9e7378"><script>var element = document.getElementById("moose-equation-df93d9a2-59ac-4ce3-98b2-f33d3f9e7378");katex.render("\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> through <span tex="c_a(c,\eta)" bookmark="moose-equation-05b1981f-99be-4a40-ba0d-ccaaae1a9f4a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-05b1981f-99be-4a40-ba0d-ccaaae1a9f4a"><script>var element = document.getElementById("moose-equation-05b1981f-99be-4a40-ba0d-ccaaae1a9f4a");katex.render("c_a(c,\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="c_b(c,\eta)" bookmark="moose-equation-e1cdec36-1188-4fa0-8eb9-6cab2571f162" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e1cdec36-1188-4fa0-8eb9-6cab2571f162"><script>var element = document.getElementById("moose-equation-e1cdec36-1188-4fa0-8eb9-6cab2571f162");katex.render("c_b(c,\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> does not contribute to the Jacobian, so <span tex="\frac{\partial F_a}{\partial \eta} = \frac{\partial F_a}{\partial \eta} = 0)" bookmark="moose-equation-e0d633eb-92a6-48d6-81c9-6ed12482f134" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e0d633eb-92a6-48d6-81c9-6ed12482f134"><script>var element = document.getElementById("moose-equation-e0d633eb-92a6-48d6-81c9-6ed12482f134");katex.render("\\frac{\\partial F_a}{\\partial \\eta} = \\frac{\\partial F_a}{\\partial \\eta} = 0)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p></section><section id="64f2cb3b-a2f8-4d47-ab75-e875bcc5667d" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>The off-diagonal components are calculated for any other variables that <span tex="F_a" bookmark="moose-equation-0e124466-2381-4b56-ba80-a0d55b80c4e9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0e124466-2381-4b56-ba80-a0d55b80c4e9"><script>var element = document.getElementById("moose-equation-0e124466-2381-4b56-ba80-a0d55b80c4e9");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-ce1c972e-e8df-415b-870a-cbcb9cd1e4f0" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ce1c972e-e8df-415b-870a-cbcb9cd1e4f0"><script>var element = document.getElementById("moose-equation-ce1c972e-e8df-415b-870a-cbcb9cd1e4f0");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> depend on. For example, for <span tex="c_a" bookmark="moose-equation-85e35e99-4ad0-4c8b-b375-8acfb406685e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-85e35e99-4ad0-4c8b-b375-8acfb406685e"><script>var element = document.getElementById("moose-equation-85e35e99-4ad0-4c8b-b375-8acfb406685e");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>:</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{dh}{d\eta}\left( \frac{\partial F_a}{\partial c_a} - \frac{\partial F_b}{\partial c_a}\right)\phi_j" bookmark="moose-equation-9ac6ff48-b0a4-414a-a9ce-5d598e9a2ada" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-9ac6ff48-b0a4-414a-a9ce-5d598e9a2ada"></span><script>var element = document.getElementById("moose-equation-9ac6ff48-b0a4-414a-a9ce-5d598e9a2ada");katex.render("J = \\frac{dh}{d\\eta}\\left( \\frac{\\partial F_a}{\\partial c_a} - \\frac{\\partial F_b}{\\partial c_a}\\right)\\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span tex="\frac{\partial F_b}{\partial c_a} = 0" bookmark="moose-equation-da5e3695-c9d7-474a-bea2-b41bc0513d00" recursive="True" class="moose-katex-inline-equation" id="moose-equation-da5e3695-c9d7-474a-bea2-b41bc0513d00"><script>var element = document.getElementById("moose-equation-da5e3695-c9d7-474a-bea2-b41bc0513d00");katex.render("\\frac{\\partial F_b}{\\partial c_a} = 0", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> in the KKS formulation, so this term would not need to be included if <span tex="c_a" bookmark="moose-equation-47241f61-4d6c-4418-bd22-5e7e8374ba86" recursive="True" class="moose-katex-inline-equation" id="moose-equation-47241f61-4d6c-4418-bd22-5e7e8374ba86"><script>var element = document.getElementById("moose-equation-47241f61-4d6c-4418-bd22-5e7e8374ba86");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> was the only variable <span tex="F_a" bookmark="moose-equation-b5a752aa-672d-4e23-bc31-c5b17683717f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b5a752aa-672d-4e23-bc31-c5b17683717f"><script>var element = document.getElementById("moose-equation-b5a752aa-672d-4e23-bc31-c5b17683717f");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> depended on. However, the code calculates derivatives with respect to all variables that <span tex="F_a" bookmark="moose-equation-4b6ef546-4ed5-4847-ba73-43c49dfe2ec5" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4b6ef546-4ed5-4847-ba73-43c49dfe2ec5"><script>var element = document.getElementById("moose-equation-4b6ef546-4ed5-4847-ba73-43c49dfe2ec5");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-354ca9b7-0296-4c90-81d1-6700974caa18" recursive="True" class="moose-katex-inline-equation" id="moose-equation-354ca9b7-0296-4c90-81d1-6700974caa18"><script>var element = document.getElementById("moose-equation-354ca9b7-0296-4c90-81d1-6700974caa18");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> depend on in a general way so that the Jacobian entries for other dependencies are correctly computed using the same piece of code. For example, both <span tex="F_a" bookmark="moose-equation-a4e9b3e0-3b8a-47b0-a3b2-ddf4aa0e86ce" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a4e9b3e0-3b8a-47b0-a3b2-ddf4aa0e86ce"><script>var element = document.getElementById("moose-equation-a4e9b3e0-3b8a-47b0-a3b2-ddf4aa0e86ce");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-07dd7639-f2ee-4c9b-960d-98595e697964" recursive="True" class="moose-katex-inline-equation" id="moose-equation-07dd7639-f2ee-4c9b-960d-98595e697964"><script>var element = document.getElementById("moose-equation-07dd7639-f2ee-4c9b-960d-98595e697964");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> could depend on temperature <span tex="T" bookmark="moose-equation-b3da50dc-e8a8-4876-9d68-10f5a55889e9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b3da50dc-e8a8-4876-9d68-10f5a55889e9"><script>var element = document.getElementById("moose-equation-b3da50dc-e8a8-4876-9d68-10f5a55889e9");katex.render("T", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, in which case</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{dh}{d\eta}\left( \frac{\partial F_a}{\partial T} - \frac{\partial F_b}{\partial T}\right)\phi_j" bookmark="moose-equation-5e5f6ddc-d2a0-4f1c-9067-14463a742d47" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-5e5f6ddc-d2a0-4f1c-9067-14463a742d47"></span><script>var element = document.getElementById("moose-equation-5e5f6ddc-d2a0-4f1c-9067-14463a742d47");katex.render("J = \\frac{dh}{d\\eta}\\left( \\frac{\\partial F_a}{\\partial T} - \\frac{\\partial F_b}{\\partial T}\\right)\\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>which is computed using the same code. The off-diagonal Jacobian contribution is also multiplied by the Allen-Cahn mobility <span tex="L" bookmark="moose-equation-5c8939ea-a950-43e9-ba78-0fc962f4b263" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5c8939ea-a950-43e9-ba78-0fc962f4b263"><script>var element = document.getElementById("moose-equation-5c8939ea-a950-43e9-ba78-0fc962f4b263");katex.render("L", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> at each point for consistency with the other terms in the Allen-Cahn equation.</p></section></section><section class="scrollspy" id="4e785209-212a-40ed-b989-8e8f687454b2" data-section-level="2" data-section-text="KKSACBulkC"><h2><code>KKSACBulkC</code></h2><p><a href="../../../source/kernels/KKSACBulkC.html"><code>KKSACBulkC</code></a> is the part with a direct composition dependence. An instance of this kernel is needed for each compnent of the problem.</p><section id="f16f6170-4a23-400c-a45e-8962c905de7c" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R&=&-\frac{dh}{d\eta}\left(-\frac{dF_a}{dc_a}(c_a-c_b)\right)\\ &=&\frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \end{aligned}" bookmark="moose-equation-cfb71147-1dfd-409a-a1a2-cdb6ce3f5713" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-cfb71147-1dfd-409a-a1a2-cdb6ce3f5713"></span><script>var element = document.getElementById("moose-equation-cfb71147-1dfd-409a-a1a2-cdb6ce3f5713");katex.render("\\begin{aligned} R&=&-\\frac{dh}{d\\eta}\\left(-\\frac{dF_a}{dc_a}(c_a-c_b)\\right)\\\\ &=&\\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="cf1d5095-02b2-4441-abd2-61663e38c7d8" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="243f7a44-d08f-40ba-85fa-394498dda496" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-dc94b6a0-e213-4ad1-bcad-49ce21350bc8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-dc94b6a0-e213-4ad1-bcad-49ce21350bc8"><script>var element = document.getElementById("moose-equation-dc94b6a0-e213-4ad1-bcad-49ce21350bc8");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-ce0de6f2-410d-4238-ac9a-13cdc617a67b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ce0de6f2-410d-4238-ac9a-13cdc617a67b"><script>var element = document.getElementById("moose-equation-ce0de6f2-410d-4238-ac9a-13cdc617a67b");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv\eta" bookmark="moose-equation-28d20e27-c07e-448c-b5c0-dcc44d928c9f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-28d20e27-c07e-448c-b5c0-dcc44d928c9f"><script>var element = document.getElementById("moose-equation-28d20e27-c07e-448c-b5c0-dcc44d928c9f");katex.render("u\\equiv\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial \eta}{\partial u_j}\frac{\partial}{\partial \eta} = \phi_j \frac{\partial}{\partial \eta}" bookmark="moose-equation-cc67bb1c-772c-4663-b0a3-9b7946d4455c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cc67bb1c-772c-4663-b0a3-9b7946d4455c"><script>var element = document.getElementById("moose-equation-cc67bb1c-772c-4663-b0a3-9b7946d4455c");katex.render("\\frac{\\partial \\eta}{\\partial u_j}\\frac{\\partial}{\\partial \\eta} = \\phi_j \\frac{\\partial}{\\partial \\eta}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial \eta} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{d^2h}{d\eta^2}\phi_j\frac{dF_a}{dc_a}(c_a-c_b)\\ \end{aligned}" bookmark="moose-equation-e28389d7-207d-4e89-bc2a-6d28eb65fa85" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-e28389d7-207d-4e89-bc2a-6d28eb65fa85"></span><script>var element = document.getElementById("moose-equation-e28389d7-207d-4e89-bc2a-6d28eb65fa85");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial \\eta} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{d^2h}{d\\eta^2}\\phi_j\\frac{dF_a}{dc_a}(c_a-c_b)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="c9c806d4-94e8-4906-867e-09362c610f89" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>Since <span tex="c_a" bookmark="moose-equation-6e04bf05-230c-4422-9b86-006611f9842b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6e04bf05-230c-4422-9b86-006611f9842b"><script>var element = document.getElementById("moose-equation-6e04bf05-230c-4422-9b86-006611f9842b");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="c_b" bookmark="moose-equation-304a79b8-72f9-43a4-8c72-67f18dfcb0ef" recursive="True" class="moose-katex-inline-equation" id="moose-equation-304a79b8-72f9-43a4-8c72-67f18dfcb0ef"><script>var element = document.getElementById("moose-equation-304a79b8-72f9-43a4-8c72-67f18dfcb0ef");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> appear in the residual, their effect must be calculated separately from any other variable dependence. For <span tex="c_a" bookmark="moose-equation-d1f8a7dc-ff23-4849-91c2-e8899368dd15" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d1f8a7dc-ff23-4849-91c2-e8899368dd15"><script>var element = document.getElementById("moose-equation-d1f8a7dc-ff23-4849-91c2-e8899368dd15");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, we are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-12e38ef4-9e32-4796-9555-4e491f352d07" recursive="True" class="moose-katex-inline-equation" id="moose-equation-12e38ef4-9e32-4796-9555-4e491f352d07"><script>var element = document.getElementById("moose-equation-12e38ef4-9e32-4796-9555-4e491f352d07");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-fff2c08f-ba74-45b9-895d-73f065af64a4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-fff2c08f-ba74-45b9-895d-73f065af64a4"><script>var element = document.getElementById("moose-equation-fff2c08f-ba74-45b9-895d-73f065af64a4");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv c_a" bookmark="moose-equation-d75bf787-ec05-4994-b233-17b65edaaa28" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d75bf787-ec05-4994-b233-17b65edaaa28"><script>var element = document.getElementById("moose-equation-d75bf787-ec05-4994-b233-17b65edaaa28");katex.render("u\\equiv c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial c_a}{\partial u_j}\frac{\partial}{\partial c_a} = \phi_j \frac{\partial}{\partial c_a}" bookmark="moose-equation-46be993a-1517-4cde-b390-366e187a3d3a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-46be993a-1517-4cde-b390-366e187a3d3a"><script>var element = document.getElementById("moose-equation-46be993a-1517-4cde-b390-366e187a3d3a");katex.render("\\frac{\\partial c_a}{\\partial u_j}\\frac{\\partial}{\\partial c_a} = \\phi_j \\frac{\\partial}{\\partial c_a}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial c_a} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{dh}{d\eta} \phi_j \left( \frac{d^2 F_a}{dc_a^2}(c_a-c_b) + \frac{d F_a}{d c_a}\right)\\ \end{aligned}" bookmark="moose-equation-376d89e4-5ddf-473c-9c05-92f1819059ca" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-376d89e4-5ddf-473c-9c05-92f1819059ca"></span><script>var element = document.getElementById("moose-equation-376d89e4-5ddf-473c-9c05-92f1819059ca");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial c_a} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{dh}{d\\eta} \\phi_j \\left( \\frac{d^2 F_a}{dc_a^2}(c_a-c_b) + \\frac{d F_a}{d c_a}\\right)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Similarly for <span tex="c_b" bookmark="moose-equation-cbcc7fd8-16d4-4cda-8465-8c6bbc28fe44" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cbcc7fd8-16d4-4cda-8465-8c6bbc28fe44"><script>var element = document.getElementById("moose-equation-cbcc7fd8-16d4-4cda-8465-8c6bbc28fe44");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, <span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial c_b} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& -\frac{dh}{d\eta} \phi_j  \frac{d F_a}{d c_a}\\ \end{aligned}" bookmark="moose-equation-244bba8f-f5df-4bc2-afa3-41dd94e9ce23" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-244bba8f-f5df-4bc2-afa3-41dd94e9ce23"></span><script>var element = document.getElementById("moose-equation-244bba8f-f5df-4bc2-afa3-41dd94e9ce23");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial c_b} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& -\\frac{dh}{d\\eta} \\phi_j  \\frac{d F_a}{d c_a}\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For any variable other than <span tex="c_a" bookmark="moose-equation-e7f608b0-2d8b-4778-b582-945b15d14bf6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e7f608b0-2d8b-4778-b582-945b15d14bf6"><script>var element = document.getElementById("moose-equation-e7f608b0-2d8b-4778-b582-945b15d14bf6");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> or <span tex="c_b" bookmark="moose-equation-c959b118-555a-4245-abc4-249e2193bc12" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c959b118-555a-4245-abc4-249e2193bc12"><script>var element = document.getElementById("moose-equation-c959b118-555a-4245-abc4-249e2193bc12");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, for example temperature <span tex="T" bookmark="moose-equation-a3cb6117-44d7-4881-81da-597a20e417e8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a3cb6117-44d7-4881-81da-597a20e417e8"><script>var element = document.getElementById("moose-equation-a3cb6117-44d7-4881-81da-597a20e417e8");katex.render("T", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>:</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial T} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{dh}{d\eta} \phi_j  \frac{\partial}{\partial T}\left(\frac{d F_a}{d c_a}\right) ( c_a - c_b)\\ \end{aligned}" bookmark="moose-equation-836876e0-3a32-4499-b489-86fa5c7afa25" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-836876e0-3a32-4499-b489-86fa5c7afa25"></span><script>var element = document.getElementById("moose-equation-836876e0-3a32-4499-b489-86fa5c7afa25");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial T} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{dh}{d\\eta} \\phi_j  \\frac{\\partial}{\\partial T}\\left(\\frac{d F_a}{d c_a}\\right) ( c_a - c_b)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>The off-diagonal Jacobian contributions are again multiplied by the Allen-Cahn mobility <span tex="L" bookmark="moose-equation-41f6fd97-a28f-4427-9232-91105b7708ab" recursive="True" class="moose-katex-inline-equation" id="moose-equation-41f6fd97-a28f-4427-9232-91105b7708ab"><script>var element = document.getElementById("moose-equation-41f6fd97-a28f-4427-9232-91105b7708ab");katex.render("L", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> at each point for consistency with the other terms in the Allen-Cahn equation.</p></section></section><section id="06a5e5cb-eff2-48b3-8a76-25822cc49685" data-section-level="1" data-section-text="Constraint Kernels"><h1 id="constraint-kernels">Constraint Kernels</h1><section class="scrollspy" id="4fa98fa3-896c-47ae-b125-fffbfa4a20a2" data-section-level="2" data-section-text="KKSPhaseChemicalPotential"><h2><code>KKSPhaseChemicalPotential</code></h2><p><a href="../../../source/kernels/KKSPhaseChemicalPotential.html"><code>KKSPhaseChemicalPotential</code></a> enforces the point wise equality of the phase chemical potentials</p><p><span class="moose-katex-block-equation"><span tex="\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}." bookmark="moose-equation-6789eaac-f497-4243-a209-e0b7235e1146" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-6789eaac-f497-4243-a209-e0b7235e1146"></span><script>var element = document.getElementById("moose-equation-6789eaac-f497-4243-a209-e0b7235e1146");katex.render("\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>The non-linear variable of this Kernel is <span tex="c_a" bookmark="moose-equation-9bc96d0b-91da-40dc-866f-26c9e0d47e72" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9bc96d0b-91da-40dc-866f-26c9e0d47e72"><script>var element = document.getElementById("moose-equation-9bc96d0b-91da-40dc-866f-26c9e0d47e72");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><section id="f896b03c-5a31-4831-b65b-deccc03ba94c" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=\frac{dF_a}{dc_a} - \frac{dF_b}{dc_b}" bookmark="moose-equation-b7e84253-f3de-4c1b-95bb-772e0b97ad01" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-b7e84253-f3de-4c1b-95bb-772e0b97ad01"></span><script>var element = document.getElementById("moose-equation-b7e84253-f3de-4c1b-95bb-772e0b97ad01");katex.render("R=\\frac{dF_a}{dc_a} - \\frac{dF_b}{dc_b}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="07be66f3-52df-41f2-8552-66a6411f3306" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><p>For the Jacobian we need to calculate</p><p><span class="moose-katex-block-equation"><span tex="J=\frac \partial{\partial u_j}\left( \frac{dF_a}{dc_a} - \frac{dF_b}{dc_b} \right)." bookmark="moose-equation-0cee1b63-d5b5-4672-9470-f7fa45ab773e" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-0cee1b63-d5b5-4672-9470-f7fa45ab773e"></span><script>var element = document.getElementById("moose-equation-0cee1b63-d5b5-4672-9470-f7fa45ab773e");katex.render("J=\\frac \\partial{\\partial u_j}\\left( \\frac{dF_a}{dc_a} - \\frac{dF_b}{dc_b} \\right).", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><section id="43cd9c81-42ac-49a6-ae3c-cd903fedc9e3" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p><span class="moose-katex-block-equation"><span tex="J = \phi_j \left( \frac{\partial^2 F_a}{\partial c_a^2} - \frac{\partial^2 F_b}{\partial c_a \partial c_b} \right)" bookmark="moose-equation-4d34b047-d0e5-4206-9792-a84ff6b63899" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-4d34b047-d0e5-4206-9792-a84ff6b63899"></span><script>var element = document.getElementById("moose-equation-4d34b047-d0e5-4206-9792-a84ff6b63899");katex.render("J = \\phi_j \\left( \\frac{\\partial^2 F_a}{\\partial c_a^2} - \\frac{\\partial^2 F_b}{\\partial c_a \\partial c_b} \\right)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="f15502c0-c817-4914-bace-c1e63e20bbf9" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>With <span tex="q" bookmark="moose-equation-5d9725c6-38b4-403e-afb9-13e0c0f5f399" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5d9725c6-38b4-403e-afb9-13e0c0f5f399"><script>var element = document.getElementById("moose-equation-5d9725c6-38b4-403e-afb9-13e0c0f5f399");katex.render("q", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> the union of the argument vectors of <span tex="F_a" bookmark="moose-equation-632291eb-c519-40c2-8ffc-9e1219789b21" recursive="True" class="moose-katex-inline-equation" id="moose-equation-632291eb-c519-40c2-8ffc-9e1219789b21"><script>var element = document.getElementById("moose-equation-632291eb-c519-40c2-8ffc-9e1219789b21");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-bb488bbd-b9cb-4716-80e5-c47cbe6d8066" recursive="True" class="moose-katex-inline-equation" id="moose-equation-bb488bbd-b9cb-4716-80e5-c47cbe6d8066"><script>var element = document.getElementById("moose-equation-bb488bbd-b9cb-4716-80e5-c47cbe6d8066");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (represented in the code by <code>_coupled_moose_vars[]</code>) we get</p><p><span class="moose-katex-block-equation"><span tex="\sum_i \left( \frac{\partial^2 F_a}{\partial c_a \partial q_i}\frac{\partial q_i}{\partial u_j} - \frac{\partial^2 F_b}{\partial c_b \partial q_i}\frac{\partial q_i}{\partial u_j} \right)." bookmark="moose-equation-0f6958cc-fa94-4ae0-83cd-e750ee90ccf1" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-0f6958cc-fa94-4ae0-83cd-e750ee90ccf1"></span><script>var element = document.getElementById("moose-equation-0f6958cc-fa94-4ae0-83cd-e750ee90ccf1");katex.render("\\sum_i \\left( \\frac{\\partial^2 F_a}{\\partial c_a \\partial q_i}\\frac{\\partial q_i}{\\partial u_j} - \\frac{\\partial^2 F_b}{\\partial c_b \\partial q_i}\\frac{\\partial q_i}{\\partial u_j} \\right).", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Again the <span tex="\frac{\partial q_i}{\partial u_j}" bookmark="moose-equation-030f41e2-d3d7-40fb-86b4-e8128cefa93f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-030f41e2-d3d7-40fb-86b4-e8128cefa93f"><script>var element = document.getElementById("moose-equation-030f41e2-d3d7-40fb-86b4-e8128cefa93f");katex.render("\\frac{\\partial q_i}{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is non-zero only if <span tex="u\equiv q_i" bookmark="moose-equation-1981a333-99f1-4580-aec1-3fffa7464c55" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1981a333-99f1-4580-aec1-3fffa7464c55"><script>var element = document.getElementById("moose-equation-1981a333-99f1-4580-aec1-3fffa7464c55");katex.render("u\\equiv q_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, which is the case if <span tex="q_i" bookmark="moose-equation-893abf32-f18d-4ed2-9dd9-ba11f1adbc16" recursive="True" class="moose-katex-inline-equation" id="moose-equation-893abf32-f18d-4ed2-9dd9-ba11f1adbc16"><script>var element = document.getElementById("moose-equation-893abf32-f18d-4ed2-9dd9-ba11f1adbc16");katex.render("q_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is the argument selected through <code>jvar</code>.</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{\partial^2 F_a}{\partial c_a \partial q_\text{jvar}}\phi_j - \frac{\partial^2 F_b}{\partial c_b \partial q_\text{jvar}}\phi_j." bookmark="moose-equation-8c7899d1-a955-41a3-b4fe-000bd1873141" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-8c7899d1-a955-41a3-b4fe-000bd1873141"></span><script>var element = document.getElementById("moose-equation-8c7899d1-a955-41a3-b4fe-000bd1873141");katex.render("J = \\frac{\\partial^2 F_a}{\\partial c_a \\partial q_\\text{jvar}}\\phi_j - \\frac{\\partial^2 F_b}{\\partial c_b \\partial q_\\text{jvar}}\\phi_j.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Note that in the code <code>jvar</code> is not an index into <code>_coupled_moose_vars[]</code> but has to be resolved through the <code>_jvar_map</code>.</p></section></section><section class="scrollspy" id="a4dbbeb6-95ce-40a6-9ece-15c2456af597" data-section-level="2" data-section-text="KKSPhaseConcentration"><h2><code>KKSPhaseConcentration</code></h2><p><a href="../../../source/kernels/KKSPhaseConcentration.html"><code>KKSPhaseConcentration</code></a> enforces the split of the concentration into the phase concentrations, weighted by the switching function. The non-linear variable of this Kernel is <span tex="c_b" bookmark="moose-equation-c00536b2-397e-446c-a9b1-6c09446d9430" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c00536b2-397e-446c-a9b1-6c09446d9430"><script>var element = document.getElementById("moose-equation-c00536b2-397e-446c-a9b1-6c09446d9430");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><p><span class="moose-katex-block-equation"><span tex="c = [1-h(\eta)]c_a+h(\eta)c_b" bookmark="moose-equation-70ba2d03-f17b-431f-8aa2-e0ee15ee08b3" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-70ba2d03-f17b-431f-8aa2-e0ee15ee08b3"></span><script>var element = document.getElementById("moose-equation-70ba2d03-f17b-431f-8aa2-e0ee15ee08b3");katex.render("c = [1-h(\\eta)]c_a+h(\\eta)c_b", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><section id="e0a3948a-8205-4f94-b394-2dfb12b1eaa5" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=[1-h(\eta)]c_a + h(\eta)c_b - c" bookmark="moose-equation-83ec65ac-7477-4fbe-85a0-218ae9679e64" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-83ec65ac-7477-4fbe-85a0-218ae9679e64"></span><script>var element = document.getElementById("moose-equation-83ec65ac-7477-4fbe-85a0-218ae9679e64");katex.render("R=[1-h(\\eta)]c_a + h(\\eta)c_b - c", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="70c81cc2-62bb-457f-8066-2f49ac00c3ad" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="0f198434-5ee1-45d8-b430-88957f66dad9" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p>Since the non-linear variable is <span tex="c_b" bookmark="moose-equation-1817b037-bcd7-4690-b97c-16f86ce4ce03" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1817b037-bcd7-4690-b97c-16f86ce4ce03"><script>var element = document.getElementById("moose-equation-1817b037-bcd7-4690-b97c-16f86ce4ce03");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>,</p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c_b} = \phi_j h(\eta)" bookmark="moose-equation-9c06b611-387b-4a5a-8e56-591ea5100d3a" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-9c06b611-387b-4a5a-8e56-591ea5100d3a"></span><script>var element = document.getElementById("moose-equation-9c06b611-387b-4a5a-8e56-591ea5100d3a");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c_b} = \\phi_j h(\\eta)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="5e479b66-10ba-4faf-91a9-5722a1d98a54" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>For <span tex="c_a" bookmark="moose-equation-c09a19d8-2949-47bc-bd1c-3b25be380edf" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c09a19d8-2949-47bc-bd1c-3b25be380edf"><script>var element = document.getElementById("moose-equation-c09a19d8-2949-47bc-bd1c-3b25be380edf");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c_a} = \phi_j [1-h(\eta)]" bookmark="moose-equation-d374cd08-0dae-4a6a-a9cd-0a962941648c" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-d374cd08-0dae-4a6a-a9cd-0a962941648c"></span><script>var element = document.getElementById("moose-equation-d374cd08-0dae-4a6a-a9cd-0a962941648c");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c_a} = \\phi_j [1-h(\\eta)]", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For <span tex="c" bookmark="moose-equation-e61f482f-c53b-4bd9-be41-d1adb2606192" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e61f482f-c53b-4bd9-be41-d1adb2606192"><script>var element = document.getElementById("moose-equation-e61f482f-c53b-4bd9-be41-d1adb2606192");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c} = -\phi_j" bookmark="moose-equation-ef6de750-5c77-4698-bc60-459f2cf0cd36" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-ef6de750-5c77-4698-bc60-459f2cf0cd36"></span><script>var element = document.getElementById("moose-equation-ef6de750-5c77-4698-bc60-459f2cf0cd36");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c} = -\\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For <span tex="\eta" bookmark="moose-equation-de64e9a4-7b29-43d3-837c-5d07c5671740" recursive="True" class="moose-katex-inline-equation" id="moose-equation-de64e9a4-7b29-43d3-837c-5d07c5671740"><script>var element = document.getElementById("moose-equation-de64e9a4-7b29-43d3-837c-5d07c5671740");katex.render("\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial \eta} = \phi_j \frac{dh}{d\eta}(c_b-c_a)" bookmark="moose-equation-bbde69be-d199-427f-bf71-294e3315d9ce" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-bbde69be-d199-427f-bf71-294e3315d9ce"></span><script>var element = document.getElementById("moose-equation-bbde69be-d199-427f-bf71-294e3315d9ce");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial \\eta} = \\phi_j \\frac{dh}{d\\eta}(c_b-c_a)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> </p></section></section><section class="scrollspy" id="cb272cdf-e32a-4fb5-9296-710b33b7dc30" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="kim_phase-field_1999">Seong&nbsp;Gyoon Kim, Won&nbsp;Tae Kim, and Toshio Suzuki.
Phase-field model for binary alloys.
<em>Physical Review E</em>, 60(6):7186&ndash;7197, December 1999.
URL: <a href="http://link.aps.org/doi/10.1103/PhysRevE.60.7186">http://link.aps.org/doi/10.1103/PhysRevE.60.7186</a>, <a href="https://doi.org/10.1103/PhysRevE.60.7186">doi:10.1103/PhysRevE.60.7186</a>.<a href="#217504ce-573f-418d-88e4-40e82e0f2b8a" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="217504ce-573f-418d-88e4-40e82e0f2b8a"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{kim_phase-field_1999,
    author = "Kim, Seong Gyoon and Kim, Won Tae and Suzuki, Toshio",
    title = "Phase-field model for binary alloys",
    volume = "60",
    url = "http://link.aps.org/doi/10.1103/PhysRevE.60.7186",
    doi = "10.1103/PhysRevE.60.7186",
    number = "6",
    urldate = "2014-03-31",
    journal = "Physical Review E",
    month = "December",
    year = "1999",
    pages = "7186-7197"
}
</code></pre></div></div></li></ol></div></section></section></section></section></section></section></section></section></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#20c27e45-455e-4884-81fc-8dbd62a7e27b" class="tooltipped" data-position="left" data-tooltip="KKSSplitCHCRes">KKSSplitCHCRes</a></li><li><a href="#344f272e-07b8-4c82-b08f-ceea7f70fca5" class="tooltipped" data-position="left" data-tooltip="Residual">Residual</a></li><li><a href="#fe0762a3-6269-4d28-ad74-b07aacc162d8" class="tooltipped" data-position="left" data-tooltip="KKSCHBulk">KKSCHBulk</a></li><li><a href="#780fa520-a850-4e21-ba5f-b1b19b705fe5" class="tooltipped" data-position="left" data-tooltip="KKSACBulkF">KKSACBulkF</a></li><li><a href="#4e785209-212a-40ed-b989-8e8f687454b2" class="tooltipped" data-position="left" data-tooltip="KKSACBulkC">KKSACBulkC</a></li><li><a href="#4fa98fa3-896c-47ae-b125-fffbfa4a20a2" class="tooltipped" data-position="left" data-tooltip="KKSPhaseChemicalPotential">KKSPhaseChemicalPotential</a></li><li><a href="#a4dbbeb6-95ce-40a6-9ece-15c2456af597" class="tooltipped" data-position="left" data-tooltip="KKSPhaseConcentration">KKSPhaseConcentration</a></li><li><a href="#cb272cdf-e32a-4fb5-9296-710b33b7dc30" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script>