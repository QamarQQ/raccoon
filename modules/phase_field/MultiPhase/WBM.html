<!DOCTYPE html><head><meta charset="UTF-8"><title>WBM.md|RACCOON</title><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="3a8cff1f-ae88-491c-a7f4-6254239e1ad7"><i class="material-icons">menu</i></a><ul class="sidenav" id="3a8cff1f-ae88-491c-a7f4-6254239e1ad7"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="../.." class="breadcrumb">modules</a><a href=".." class="breadcrumb">phase_field</a><span class="breadcrumb">MultiPhase</span><a href="#" class="breadcrumb">WBM</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="cddc4e61-8348-4190-9a33-f5591be607e1" data-section-level="1" data-section-text="Multiphase models"><h1 id="multiphase-models">Multiphase models</h1><p>Material objects that internally derive from <code>DerivativeFunctionMaterialBase</code> (<a href="http://mooseframework.org/docs/doxygen/modules/classDerivativeFunctionMaterialBase.html">Doxygen</a>), like the materials for the <a href="../FunctionMaterialKernels.html">Parsed Function Kernels</a> are used to provide the free energy expressions for each phase.</p><p>The flexible <strong>multiphase model</strong> uses _n_ order parameters to control <em>n</em> phases while employing a Lagrange multiplier based constraint to enforce the sum of all phase contributions to be one at every point in the simulation cell.</p><p>For multiphase models with <em>n</em> phases <a href="../../../source/materials/DerivativeMultiPhaseMaterial.html"><code>DerivativeMultiPhaseMaterial</code></a> can be used to form the global free energy as</p><p><span class="moose-katex-block-equation"><span tex="F = \left[ \sum_i^n h_i(\eta_i)F_i \right] + g(\vec\eta)" bookmark="moose-equation-c4c81f75-fffb-47f3-9fd7-8e7e71ca6165" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-c4c81f75-fffb-47f3-9fd7-8e7e71ca6165"></span><script>var element = document.getElementById("moose-equation-c4c81f75-fffb-47f3-9fd7-8e7e71ca6165");katex.render("F = \\left[ \\sum_i^n h_i(\\eta_i)F_i \\right] + g(\\vec\\eta)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>We need to enforce the constraint <span tex="k(\vec\eta)=0" bookmark="moose-equation-31b50c03-f2f9-44e8-a84e-9882fa0a51db" recursive="True" class="moose-katex-inline-equation" id="moose-equation-31b50c03-f2f9-44e8-a84e-9882fa0a51db"><script>var element = document.getElementById("moose-equation-31b50c03-f2f9-44e8-a84e-9882fa0a51db");katex.render("k(\\vec\\eta)=0", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> for</p><p><span class="moose-katex-block-equation"><span tex="k(\vec \eta)=\left[\sum_i h(\eta_i)\right] - 1 \underbrace{- \frac\epsilon2\lambda}_{\text{Jacobian fill}}," bookmark="moose-equation-a5bdc643-d798-4ed0-8d43-77201d5c7d0c" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-a5bdc643-d798-4ed0-8d43-77201d5c7d0c"></span><script>var element = document.getElementById("moose-equation-a5bdc643-d798-4ed0-8d43-77201d5c7d0c");katex.render("k(\\vec \\eta)=\\left[\\sum_i h(\\eta_i)\\right] - 1 \\underbrace{- \\frac\\epsilon2\\lambda}_{\\text{Jacobian fill}},", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>which ensures that the total weight of all phase free energy contributions at each point in the simulation volume is exactly unity (up to an <span tex="\epsilon" bookmark="moose-equation-4500b010-a799-4ea9-ac29-ebd88ca00edb" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4500b010-a799-4ea9-ac29-ebd88ca00edb"><script>var element = document.getElementById("moose-equation-4500b010-a799-4ea9-ac29-ebd88ca00edb");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>). This is achieved using either a hard or soft constraint enforcement method.</p><p>Check out the example input at <code>moose/modules/phase_field/examples/multiphase/DerivativeMultiPhaseMaterial.i</code> to see it in action.</p><section class="scrollspy" id="5b0800d3-4702-407d-a96a-8738fd0ba7c7" data-section-level="2" data-section-text="Lagrange multiplier constraint"><h2 id="lagrange-multiplier-constraint">Lagrange multiplier constraint</h2><p>As first (hard) method for constraint enforcement the Lagrange multiplier technique is available, where the Lagrange multiplier <span tex="\lambda" bookmark="moose-equation-cdf2f9fc-3315-4204-a4d0-2809fb193727" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cdf2f9fc-3315-4204-a4d0-2809fb193727"><script>var element = document.getElementById("moose-equation-cdf2f9fc-3315-4204-a4d0-2809fb193727");katex.render("\\lambda", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is a non-linear variable</p><p>With <span tex="a_i(\vec\eta,\vec c,v)" bookmark="moose-equation-d16fc1f0-c2ed-479f-af03-00840e07c47f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d16fc1f0-c2ed-479f-af03-00840e07c47f"><script>var element = document.getElementById("moose-equation-d16fc1f0-c2ed-479f-af03-00840e07c47f");katex.render("a_i(\\vec\\eta,\\vec c,v)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> being the weak form (Allen-Cahn) residual for the <span tex="i" bookmark="moose-equation-d7f8affe-e135-477a-a62c-a8fd3a8610d2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d7f8affe-e135-477a-a62c-a8fd3a8610d2"><script>var element = document.getElementById("moose-equation-d7f8affe-e135-477a-a62c-a8fd3a8610d2");katex.render("i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>th non-conserved order parameter, we need to find <span tex="(\vec\eta,\lambda)" bookmark="moose-equation-ff88b7c2-27dd-4e27-9b5b-616e6ddd91e9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ff88b7c2-27dd-4e27-9b5b-616e6ddd91e9"><script>var element = document.getElementById("moose-equation-ff88b7c2-27dd-4e27-9b5b-616e6ddd91e9");katex.render("(\\vec\\eta,\\lambda)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> satisfying the boundary conditions and such that</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} a_i(\vec\eta,\vec c,v) + \underbrace{\int_\Omega\lambda\frac{\partial k}{\partial\eta_i} v\,dx}_{L_1(\eta_i)} &=& 0 \\ \underbrace{\int_\Omega q\frac{\partial(\lambda k)}{\partial\lambda}\,dx}_{L_2(\lambda)} &=& 0 \end{aligned}" bookmark="moose-equation-b11f81b9-d8f1-4e8f-aeaf-0d030db149f3" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-b11f81b9-d8f1-4e8f-aeaf-0d030db149f3"></span><script>var element = document.getElementById("moose-equation-b11f81b9-d8f1-4e8f-aeaf-0d030db149f3");katex.render("\\begin{aligned} a_i(\\vec\\eta,\\vec c,v) + \\underbrace{\\int_\\Omega\\lambda\\frac{\\partial k}{\\partial\\eta_i} v\\,dx}_{L_1(\\eta_i)} &=& 0 \\\\ \\underbrace{\\int_\\Omega q\\frac{\\partial(\\lambda k)}{\\partial\\lambda}\\,dx}_{L_2(\\lambda)} &=& 0 \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>holds for every test function <span tex="v" bookmark="moose-equation-c38da5b2-718f-4afa-804f-7c97f7768477" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c38da5b2-718f-4afa-804f-7c97f7768477"><script>var element = document.getElementById("moose-equation-c38da5b2-718f-4afa-804f-7c97f7768477");katex.render("v", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="q" bookmark="moose-equation-8cb1f490-d662-4061-bb54-43bd01799b48" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8cb1f490-d662-4061-bb54-43bd01799b48"><script>var element = document.getElementById("moose-equation-8cb1f490-d662-4061-bb54-43bd01799b48");katex.render("q", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><p>The <span tex="L_1" bookmark="moose-equation-ed58b001-69cb-4b76-86d8-173774fd07b2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ed58b001-69cb-4b76-86d8-173774fd07b2"><script>var element = document.getElementById("moose-equation-ed58b001-69cb-4b76-86d8-173774fd07b2");katex.render("L_1", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> Lagrange residuals are provided by  <a href="../../../source/kernels/SwitchingFunctionConstraintEta.html"><code>SwitchingFunctionConstraintEta</code></a>  (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionConstraintEta.html">Doxygen</a>)  kernels - one for each phase order parameter.</p><p>The <span tex="L_2" bookmark="moose-equation-2db8a0b8-af6f-44f1-985f-700d5c3036f9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2db8a0b8-af6f-44f1-985f-700d5c3036f9"><script>var element = document.getElementById("moose-equation-2db8a0b8-af6f-44f1-985f-700d5c3036f9");katex.render("L_2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> Lagrange residual is provided by a  <a href="../../../source/kernels/SwitchingFunctionConstraintLagrange.html"><code>SwitchingFunctionConstraintLagrange</code></a> (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionConstraintLagrange.html">Doxygen</a>) kernel.</p><p>The <em>Jacobian fill</em> term introduces a small <span tex="\lambda" bookmark="moose-equation-cc5ed66b-b846-4426-a32a-303b102b626d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cc5ed66b-b846-4426-a32a-303b102b626d"><script>var element = document.getElementById("moose-equation-cc5ed66b-b846-4426-a32a-303b102b626d");katex.render("\\lambda", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> dependence in the constraint through a small <span tex="\epsilon" bookmark="moose-equation-653421ec-a475-44c5-9862-2e7427cf8b7a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-653421ec-a475-44c5-9862-2e7427cf8b7a"><script>var element = document.getElementById("moose-equation-653421ec-a475-44c5-9862-2e7427cf8b7a");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> factor (defaults to <span tex="10^{-9}" bookmark="moose-equation-96e4becf-3ba7-4edf-aded-7883cc5cf59b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-96e4becf-3ba7-4edf-aded-7883cc5cf59b"><script>var element = document.getElementById("moose-equation-96e4becf-3ba7-4edf-aded-7883cc5cf59b");katex.render("10^{-9}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>), which results in an on-diagonal Jacobian value of <span tex="\epsilon" bookmark="moose-equation-4d20ebeb-a4ba-45af-b13d-77bed8b5b523" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4d20ebeb-a4ba-45af-b13d-77bed8b5b523"><script>var element = document.getElementById("moose-equation-4d20ebeb-a4ba-45af-b13d-77bed8b5b523");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> in the <span tex="L_2" bookmark="moose-equation-131b0b3f-66fc-43ca-94ca-c6a18de3bc99" recursive="True" class="moose-katex-inline-equation" id="moose-equation-131b0b3f-66fc-43ca-94ca-c6a18de3bc99"><script>var element = document.getElementById("moose-equation-131b0b3f-66fc-43ca-94ca-c6a18de3bc99");katex.render("L_2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> kernel (it drops out in the <span tex="L_1" bookmark="moose-equation-e6ed8532-619b-4d4d-825e-2b7491a89a69" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e6ed8532-619b-4d4d-825e-2b7491a89a69"><script>var element = document.getElementById("moose-equation-e6ed8532-619b-4d4d-825e-2b7491a89a69");katex.render("L_1", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> kernel). This is necessary to force a Jacobian matrix with <em>full rank</em>, avoids &quot;Zero pivot&quot; PETSc-Errors, and greatly improves convergence. The cost is a <em>violation</em> of the constraint by about <span tex="\epsilon" bookmark="moose-equation-0ade42b8-809a-445b-b7a7-d931c513ed3b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0ade42b8-809a-445b-b7a7-d931c513ed3b"><script>var element = document.getElementById("moose-equation-0ade42b8-809a-445b-b7a7-d931c513ed3b");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, however this constraint violation can be made as small as the convergence limits.</p></section><section class="scrollspy" id="a3790ceb-99f4-486d-a7f0-09938a76d5bd" data-section-level="2" data-section-text="Penalty constraint"><h2 id="penalty-constraint">Penalty constraint</h2><p>As an alternative (softer) constraint enforcement we provide the <a href="../../../source/kernels/SwitchingFunctionPenalty.html"><code>SwitchingFunctionPenalty</code></a> (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionPenalty.html">Doxygen</a>) kernel, which effectively adds a free energy penalty of <span tex="\gamma k(\vec \eta)^2" bookmark="moose-equation-84368cb6-8cd0-490c-80c1-598965342a6d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-84368cb6-8cd0-490c-80c1-598965342a6d"><script>var element = document.getElementById("moose-equation-84368cb6-8cd0-490c-80c1-598965342a6d");katex.render("\\gamma k(\\vec \\eta)^2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (with <span tex="\epsilon=0" bookmark="moose-equation-e404af7c-ae34-49bb-9167-152c7af05187" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e404af7c-ae34-49bb-9167-152c7af05187"><script>var element = document.getElementById("moose-equation-e404af7c-ae34-49bb-9167-152c7af05187");katex.render("\\epsilon=0", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>), where <span tex="\gamma" bookmark="moose-equation-0ff0efd3-21fa-4b18-8ed0-91ff333d2105" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0ff0efd3-21fa-4b18-8ed0-91ff333d2105"><script>var element = document.getElementById("moose-equation-0ff0efd3-21fa-4b18-8ed0-91ff333d2105");katex.render("\\gamma", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is the penalty prefactor (<code>penalty</code>). The constraint is enforced approximately to a tolerance of <span tex="\frac1\gamma" bookmark="moose-equation-c9a0e74d-5986-4ea5-93c9-6f74938dfc39" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c9a0e74d-5986-4ea5-93c9-6f74938dfc39"><script>var element = document.getElementById("moose-equation-c9a0e74d-5986-4ea5-93c9-6f74938dfc39");katex.render("\\frac1\\gamma", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (depending on the shape and units of the free energy).</p><p>The gradient interface energy term for multiphase models with <span tex="n>2" bookmark="moose-equation-5412c12d-fc1a-4346-a59a-88d3bd5d27a9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5412c12d-fc1a-4346-a59a-88d3bd5d27a9"><script>var element = document.getElementById("moose-equation-5412c12d-fc1a-4346-a59a-88d3bd5d27a9");katex.render("n>2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is derived <a href="../../../source/kernels/ACMultiInterface.html">here</a> and provided by the <a href="../../../source/kernels/ACMultiInterface.html"><code>ACMultiInterface</code></a> kernel.</p></section><section class="scrollspy" id="38335ebd-3e28-495f-a9ad-08e8f17bcf91" data-section-level="2" data-section-text="Example"><h2 id="example">Example</h2><p>An example material block looks like this (materials for phase field mobilities omitted for clarity).</p><pre class="moose-pre"><code class="language-puppet">
[Materials]
# Free energy for phase A

[./free_energy_A]
  type = DerivativeParsedMaterial
  block = 0
  f_name = Fa
  args = &#x27;c&#x27;
  function = &#x27;(c-0.1)^2&#x27;
  third_derivatives = false
  enable_jit = true
[../]

# Free energy for phase B

[./free_energy_B]
  type = DerivativeParsedMaterial
  f_name = Fb
  args = &#x27;c&#x27;
  function = &#x27;(c-0.9)^2&#x27;
  third_derivatives = false
  enable_jit = true
[../]

[./switching]
  type = SwitchingFunctionMaterial
  eta = eta
  h_order = SIMPLE
[../]

[./barrier]
  type = BarrierFunctionMaterial
  eta = eta
  g_order = SIMPLE
[../]

# Total free energy F = h(phi)*Fb + (1-h(phi))*Fa

[./free_energy]
  type = DerivativeTwoPhaseMaterial
  f_name = F    # Name of the global free energy function (use this in the Parsed Function Kernels)
  fa_name = Fa  # f_name of the phase A free energy function
  fb_name = Fb  # f_name of the phase B free energy function
  args = &#x27;c&#x27;
  eta = eta     # order parameter that switches between A and B phase
  third_derivatives = false
  outputs = exodus
[../]
[]
</code></pre><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>The phase free energies are single wells. The global free energy landscape will however have a double well character in this example.</p></p></div></div></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#5b0800d3-4702-407d-a96a-8738fd0ba7c7" class="tooltipped" data-position="left" data-tooltip="Lagrange multiplier constraint">Lagrange multiplier constraint</a></li><li><a href="#a3790ceb-99f4-486d-a7f0-09938a76d5bd" class="tooltipped" data-position="left" data-tooltip="Penalty constraint">Penalty constraint</a></li><li><a href="#38335ebd-3e28-495f-a9ad-08e8f17bcf91" class="tooltipped" data-position="left" data-tooltip="Example">Example</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script>