<!DOCTYPE html><head><meta charset="UTF-8"><title>WBM.md|RACCOON</title><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="456279f4-ecfb-4602-ad0d-2981f698712c"><i class="material-icons">menu</i></a><ul class="sidenav" id="456279f4-ecfb-4602-ad0d-2981f698712c"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="../.." class="breadcrumb">modules</a><a href=".." class="breadcrumb">phase_field</a><span class="breadcrumb">MultiPhase</span><a href="#" class="breadcrumb">WBM</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="2eadc26c-0de4-4c38-89ee-f00aeae8c04f" data-section-level="1" data-section-text="Multiphase models"><h1 id="multiphase-models">Multiphase models</h1><p>Material objects that internally derive from <code>DerivativeFunctionMaterialBase</code> (<a href="http://mooseframework.org/docs/doxygen/modules/classDerivativeFunctionMaterialBase.html">Doxygen</a>), like the materials for the <a href="../FunctionMaterialKernels.html">Parsed Function Kernels</a> are used to provide the free energy expressions for each phase.</p><p>The flexible <strong>multiphase model</strong> uses _n_ order parameters to control <em>n</em> phases while employing a Lagrange multiplier based constraint to enforce the sum of all phase contributions to be one at every point in the simulation cell.</p><p>For multiphase models with <em>n</em> phases <a href="../../../source/materials/DerivativeMultiPhaseMaterial.html"><code>DerivativeMultiPhaseMaterial</code></a> can be used to form the global free energy as</p><p><span class="moose-katex-block-equation"><span tex="F = \left[ \sum_i^n h_i(\eta_i)F_i \right] + g(\vec\eta)" bookmark="moose-equation-aa0ff331-9a2c-4818-84c2-73b29243477b" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-aa0ff331-9a2c-4818-84c2-73b29243477b"></span><script>var element = document.getElementById("moose-equation-aa0ff331-9a2c-4818-84c2-73b29243477b");katex.render("F = \\left[ \\sum_i^n h_i(\\eta_i)F_i \\right] + g(\\vec\\eta)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>We need to enforce the constraint <span tex="k(\vec\eta)=0" bookmark="moose-equation-3c97d64e-9e03-4a3c-a673-ad9a511fb4d2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3c97d64e-9e03-4a3c-a673-ad9a511fb4d2"><script>var element = document.getElementById("moose-equation-3c97d64e-9e03-4a3c-a673-ad9a511fb4d2");katex.render("k(\\vec\\eta)=0", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> for</p><p><span class="moose-katex-block-equation"><span tex="k(\vec \eta)=\left[\sum_i h(\eta_i)\right] - 1 \underbrace{- \frac\epsilon2\lambda}_{\text{Jacobian fill}}," bookmark="moose-equation-d37f4ee0-00fb-4f5b-803c-b954dd99ce04" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-d37f4ee0-00fb-4f5b-803c-b954dd99ce04"></span><script>var element = document.getElementById("moose-equation-d37f4ee0-00fb-4f5b-803c-b954dd99ce04");katex.render("k(\\vec \\eta)=\\left[\\sum_i h(\\eta_i)\\right] - 1 \\underbrace{- \\frac\\epsilon2\\lambda}_{\\text{Jacobian fill}},", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>which ensures that the total weight of all phase free energy contributions at each point in the simulation volume is exactly unity (up to an <span tex="\epsilon" bookmark="moose-equation-45dc7859-d1c6-48ad-a467-fb566aecc542" recursive="True" class="moose-katex-inline-equation" id="moose-equation-45dc7859-d1c6-48ad-a467-fb566aecc542"><script>var element = document.getElementById("moose-equation-45dc7859-d1c6-48ad-a467-fb566aecc542");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>). This is achieved using either a hard or soft constraint enforcement method.</p><p>Check out the example input at <code>moose/modules/phase_field/examples/multiphase/DerivativeMultiPhaseMaterial.i</code> to see it in action.</p><section class="scrollspy" id="32530906-262e-4574-a2a4-a0c796ed1963" data-section-level="2" data-section-text="Lagrange multiplier constraint"><h2 id="lagrange-multiplier-constraint">Lagrange multiplier constraint</h2><p>As first (hard) method for constraint enforcement the Lagrange multiplier technique is available, where the Lagrange multiplier <span tex="\lambda" bookmark="moose-equation-adc8e903-4eab-40c6-b5a8-87686f05241c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-adc8e903-4eab-40c6-b5a8-87686f05241c"><script>var element = document.getElementById("moose-equation-adc8e903-4eab-40c6-b5a8-87686f05241c");katex.render("\\lambda", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is a non-linear variable</p><p>With <span tex="a_i(\vec\eta,\vec c,v)" bookmark="moose-equation-bfb63101-64b6-4cf6-95d6-2110102cb748" recursive="True" class="moose-katex-inline-equation" id="moose-equation-bfb63101-64b6-4cf6-95d6-2110102cb748"><script>var element = document.getElementById("moose-equation-bfb63101-64b6-4cf6-95d6-2110102cb748");katex.render("a_i(\\vec\\eta,\\vec c,v)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> being the weak form (Allen-Cahn) residual for the <span tex="i" bookmark="moose-equation-a52cd8e2-651b-4549-810b-ac6b354917a9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a52cd8e2-651b-4549-810b-ac6b354917a9"><script>var element = document.getElementById("moose-equation-a52cd8e2-651b-4549-810b-ac6b354917a9");katex.render("i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>th non-conserved order parameter, we need to find <span tex="(\vec\eta,\lambda)" bookmark="moose-equation-3e8a8e35-5e8d-4f6b-9760-52fd037ff07e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3e8a8e35-5e8d-4f6b-9760-52fd037ff07e"><script>var element = document.getElementById("moose-equation-3e8a8e35-5e8d-4f6b-9760-52fd037ff07e");katex.render("(\\vec\\eta,\\lambda)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> satisfying the boundary conditions and such that</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} a_i(\vec\eta,\vec c,v) + \underbrace{\int_\Omega\lambda\frac{\partial k}{\partial\eta_i} v\,dx}_{L_1(\eta_i)} &=& 0 \\ \underbrace{\int_\Omega q\frac{\partial(\lambda k)}{\partial\lambda}\,dx}_{L_2(\lambda)} &=& 0 \end{aligned}" bookmark="moose-equation-15615e6f-a663-4ffa-bbb7-600c7214f54b" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-15615e6f-a663-4ffa-bbb7-600c7214f54b"></span><script>var element = document.getElementById("moose-equation-15615e6f-a663-4ffa-bbb7-600c7214f54b");katex.render("\\begin{aligned} a_i(\\vec\\eta,\\vec c,v) + \\underbrace{\\int_\\Omega\\lambda\\frac{\\partial k}{\\partial\\eta_i} v\\,dx}_{L_1(\\eta_i)} &=& 0 \\\\ \\underbrace{\\int_\\Omega q\\frac{\\partial(\\lambda k)}{\\partial\\lambda}\\,dx}_{L_2(\\lambda)} &=& 0 \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>holds for every test function <span tex="v" bookmark="moose-equation-7ec945f0-6d07-4046-b165-e489655da8a2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7ec945f0-6d07-4046-b165-e489655da8a2"><script>var element = document.getElementById("moose-equation-7ec945f0-6d07-4046-b165-e489655da8a2");katex.render("v", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="q" bookmark="moose-equation-2e8317de-3e92-4f46-a6b6-e72f7959322b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2e8317de-3e92-4f46-a6b6-e72f7959322b"><script>var element = document.getElementById("moose-equation-2e8317de-3e92-4f46-a6b6-e72f7959322b");katex.render("q", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><p>The <span tex="L_1" bookmark="moose-equation-5f07aefc-2116-43f8-a2a7-2b3603b0530a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5f07aefc-2116-43f8-a2a7-2b3603b0530a"><script>var element = document.getElementById("moose-equation-5f07aefc-2116-43f8-a2a7-2b3603b0530a");katex.render("L_1", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> Lagrange residuals are provided by  <a href="../../../source/kernels/SwitchingFunctionConstraintEta.html"><code>SwitchingFunctionConstraintEta</code></a>  (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionConstraintEta.html">Doxygen</a>)  kernels - one for each phase order parameter.</p><p>The <span tex="L_2" bookmark="moose-equation-9c08ea44-d59b-4235-9888-d05863e4ec88" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9c08ea44-d59b-4235-9888-d05863e4ec88"><script>var element = document.getElementById("moose-equation-9c08ea44-d59b-4235-9888-d05863e4ec88");katex.render("L_2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> Lagrange residual is provided by a  <a href="../../../source/kernels/SwitchingFunctionConstraintLagrange.html"><code>SwitchingFunctionConstraintLagrange</code></a> (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionConstraintLagrange.html">Doxygen</a>) kernel.</p><p>The <em>Jacobian fill</em> term introduces a small <span tex="\lambda" bookmark="moose-equation-3511d13d-bf74-4c63-b717-95cbd3646bc8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3511d13d-bf74-4c63-b717-95cbd3646bc8"><script>var element = document.getElementById("moose-equation-3511d13d-bf74-4c63-b717-95cbd3646bc8");katex.render("\\lambda", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> dependence in the constraint through a small <span tex="\epsilon" bookmark="moose-equation-ec306eec-72d9-4a15-8759-4efb1a89fded" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ec306eec-72d9-4a15-8759-4efb1a89fded"><script>var element = document.getElementById("moose-equation-ec306eec-72d9-4a15-8759-4efb1a89fded");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> factor (defaults to <span tex="10^{-9}" bookmark="moose-equation-b959185d-7edf-4d5b-beb9-210df31bfdaf" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b959185d-7edf-4d5b-beb9-210df31bfdaf"><script>var element = document.getElementById("moose-equation-b959185d-7edf-4d5b-beb9-210df31bfdaf");katex.render("10^{-9}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>), which results in an on-diagonal Jacobian value of <span tex="\epsilon" bookmark="moose-equation-5c8e4995-a769-4cd2-9122-d6b7d14c9ce5" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5c8e4995-a769-4cd2-9122-d6b7d14c9ce5"><script>var element = document.getElementById("moose-equation-5c8e4995-a769-4cd2-9122-d6b7d14c9ce5");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> in the <span tex="L_2" bookmark="moose-equation-58245b53-f9f1-4427-b9b3-a680a62530e7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-58245b53-f9f1-4427-b9b3-a680a62530e7"><script>var element = document.getElementById("moose-equation-58245b53-f9f1-4427-b9b3-a680a62530e7");katex.render("L_2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> kernel (it drops out in the <span tex="L_1" bookmark="moose-equation-639ee2c2-4c38-473e-a35e-03cf30c29c66" recursive="True" class="moose-katex-inline-equation" id="moose-equation-639ee2c2-4c38-473e-a35e-03cf30c29c66"><script>var element = document.getElementById("moose-equation-639ee2c2-4c38-473e-a35e-03cf30c29c66");katex.render("L_1", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> kernel). This is necessary to force a Jacobian matrix with <em>full rank</em>, avoids &quot;Zero pivot&quot; PETSc-Errors, and greatly improves convergence. The cost is a <em>violation</em> of the constraint by about <span tex="\epsilon" bookmark="moose-equation-1f8968bc-fa3a-4dff-8b19-32f2d434905b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1f8968bc-fa3a-4dff-8b19-32f2d434905b"><script>var element = document.getElementById("moose-equation-1f8968bc-fa3a-4dff-8b19-32f2d434905b");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, however this constraint violation can be made as small as the convergence limits.</p></section><section class="scrollspy" id="3bced123-a6f0-4318-a26b-3ccce3663735" data-section-level="2" data-section-text="Penalty constraint"><h2 id="penalty-constraint">Penalty constraint</h2><p>As an alternative (softer) constraint enforcement we provide the <a href="../../../source/kernels/SwitchingFunctionPenalty.html"><code>SwitchingFunctionPenalty</code></a> (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionPenalty.html">Doxygen</a>) kernel, which effectively adds a free energy penalty of <span tex="\gamma k(\vec \eta)^2" bookmark="moose-equation-f1986bd2-eed3-4ea2-b948-30fa58ccdc21" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f1986bd2-eed3-4ea2-b948-30fa58ccdc21"><script>var element = document.getElementById("moose-equation-f1986bd2-eed3-4ea2-b948-30fa58ccdc21");katex.render("\\gamma k(\\vec \\eta)^2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (with <span tex="\epsilon=0" bookmark="moose-equation-2a11fe3e-0530-4210-bed1-4b6cd2fe4010" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2a11fe3e-0530-4210-bed1-4b6cd2fe4010"><script>var element = document.getElementById("moose-equation-2a11fe3e-0530-4210-bed1-4b6cd2fe4010");katex.render("\\epsilon=0", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>), where <span tex="\gamma" bookmark="moose-equation-03b80e41-6cfa-416a-96e9-af705d2d28f3" recursive="True" class="moose-katex-inline-equation" id="moose-equation-03b80e41-6cfa-416a-96e9-af705d2d28f3"><script>var element = document.getElementById("moose-equation-03b80e41-6cfa-416a-96e9-af705d2d28f3");katex.render("\\gamma", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is the penalty prefactor (<code>penalty</code>). The constraint is enforced approximately to a tolerance of <span tex="\frac1\gamma" bookmark="moose-equation-71193905-9cd9-4bd7-808f-1746ee3f69f8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-71193905-9cd9-4bd7-808f-1746ee3f69f8"><script>var element = document.getElementById("moose-equation-71193905-9cd9-4bd7-808f-1746ee3f69f8");katex.render("\\frac1\\gamma", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (depending on the shape and units of the free energy).</p><p>The gradient interface energy term for multiphase models with <span tex="n>2" bookmark="moose-equation-6cead5ed-753b-43a7-9f94-e94d8d49617c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6cead5ed-753b-43a7-9f94-e94d8d49617c"><script>var element = document.getElementById("moose-equation-6cead5ed-753b-43a7-9f94-e94d8d49617c");katex.render("n>2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is derived <a href="../../../source/kernels/ACMultiInterface.html">here</a> and provided by the <a href="../../../source/kernels/ACMultiInterface.html"><code>ACMultiInterface</code></a> kernel.</p></section><section class="scrollspy" id="986e2d7a-723a-41c4-8ea9-ae99d069cf17" data-section-level="2" data-section-text="Example"><h2 id="example">Example</h2><p>An example material block looks like this (materials for phase field mobilities omitted for clarity).</p><pre class="moose-pre"><code class="language-puppet">
[Materials]
# Free energy for phase A

[./free_energy_A]
  type = DerivativeParsedMaterial
  block = 0
  f_name = Fa
  args = &#x27;c&#x27;
  function = &#x27;(c-0.1)^2&#x27;
  third_derivatives = false
  enable_jit = true
[../]

# Free energy for phase B

[./free_energy_B]
  type = DerivativeParsedMaterial
  f_name = Fb
  args = &#x27;c&#x27;
  function = &#x27;(c-0.9)^2&#x27;
  third_derivatives = false
  enable_jit = true
[../]

[./switching]
  type = SwitchingFunctionMaterial
  eta = eta
  h_order = SIMPLE
[../]

[./barrier]
  type = BarrierFunctionMaterial
  eta = eta
  g_order = SIMPLE
[../]

# Total free energy F = h(phi)*Fb + (1-h(phi))*Fa

[./free_energy]
  type = DerivativeTwoPhaseMaterial
  f_name = F    # Name of the global free energy function (use this in the Parsed Function Kernels)
  fa_name = Fa  # f_name of the phase A free energy function
  fb_name = Fb  # f_name of the phase B free energy function
  args = &#x27;c&#x27;
  eta = eta     # order parameter that switches between A and B phase
  third_derivatives = false
  outputs = exodus
[../]
[]
</code></pre><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>The phase free energies are single wells. The global free energy landscape will however have a double well character in this example.</p></p></div></div></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#32530906-262e-4574-a2a4-a0c796ed1963" class="tooltipped" data-position="left" data-tooltip="Lagrange multiplier constraint">Lagrange multiplier constraint</a></li><li><a href="#3bced123-a6f0-4318-a26b-3ccce3663735" class="tooltipped" data-position="left" data-tooltip="Penalty constraint">Penalty constraint</a></li><li><a href="#986e2d7a-723a-41c4-8ea9-ae99d069cf17" class="tooltipped" data-position="left" data-tooltip="Example">Example</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script>