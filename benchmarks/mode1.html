<!DOCTYPE html><head><meta charset="UTF-8"><title>mode1.md|RACCOON</title><link rel="icon" type="image/x-icon" href="../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../media/framework/github-logo.png" class="github-mark"></img><img src="../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../install/index.html">Install</a></li><li><a href="../theory/index.html">Theory</a></li><li><a href="../modules/index.html">Modules</a></li><li><a href="../syntax/index.html">Syntax</a></li><li><a href="../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="ba94e2b9-f201-4842-876c-e9ff6a6d3db7"><i class="material-icons">menu</i></a><ul class="sidenav" id="ba94e2b9-f201-4842-876c-e9ff6a6d3db7"><li><a href="../install/index.html">Install</a></li><li><a href="../theory/index.html">Theory</a></li><li><a href="../modules/index.html">Modules</a></li><li><a href="../syntax/index.html">Syntax</a></li><li><a href="../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="." class="breadcrumb">benchmarks</a><a href="#" class="breadcrumb">mode1</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="a4894286-3b64-4e2b-8e2f-0cb0d6b5f2ce" data-section-level="1" data-section-text="Mode I Crack Propagation"><h1 id="mode-i-crack-propagation">Mode I Crack Propagation</h1><div class="card moose-float" style="width:30%;margin:auto;padding-top:2.5%;" id="mode1_bcs"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/mode1_bcs.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text">boundary conditions of the Mode-I problem</span></p></div></div><p>Consider a 1mm <span class="moose-katex-inline-equation" id="moose-equation-bc29e3dd-54c6-4a18-903d-46e621895804"><script>var element = document.getElementById("moose-equation-bc29e3dd-54c6-4a18-903d-46e621895804");katex.render("\\times", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> 1mm plate with a pre-existing crack on the left side, loaded in uniaxial tension, as shown in <a href="#mode1_bcs">Figure 1</a>. We assume the plate to be composed of an isotropic material with Young&#x27;s modulus <span class="moose-katex-inline-equation" id="moose-equation-5fe9167c-b779-41e8-b03e-10f2bb3b4e63"><script>var element = document.getElementById("moose-equation-5fe9167c-b779-41e8-b03e-10f2bb3b4e63");katex.render("E = 2.1 \\times 10^5", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>MPa, Poisson&#x27;s ratio <span class="moose-katex-inline-equation" id="moose-equation-3d15e477-7506-49f9-a987-f5cb34917bb8"><script>var element = document.getElementById("moose-equation-3d15e477-7506-49f9-a987-f5cb34917bb8");katex.render("\\nu = 0.3", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, fracture toughness <span class="moose-katex-inline-equation" id="moose-equation-4ccb4285-e8d8-481f-831a-023dba4601bf"><script>var element = document.getElementById("moose-equation-4ccb4285-e8d8-481f-831a-023dba4601bf");katex.render("\\Gc = 2.7", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>Jmm<span class="moose-katex-inline-equation" id="moose-equation-72ddd8e0-0e7b-47fa-9c1a-8b4fd9d1057a"><script>var element = document.getElementById("moose-equation-72ddd8e0-0e7b-47fa-9c1a-8b4fd9d1057a");katex.render("^{-3}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, and critical strength <span class="moose-katex-inline-equation" id="moose-equation-622d5cdf-2e92-49cd-b4a5-f3c822d40d45"><script>var element = document.getElementById("moose-equation-622d5cdf-2e92-49cd-b4a5-f3c822d40d45");katex.render("\\sigma_c = 2.5 \\times 10^3", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>MPa. The plate is fixed along the bottom, and the top surface is displaced in the vertical direction.  Roller supports are also assumed to be in place, such that the horizontal displacement vanishes along the top surface. The plate is assumed to be sufficiently thick such that plane strain conditions hold.</p><p>The fixed-point iterative scheme is implemented using two input files.</p><ul class="browser-default"><li><p><a href="#806410c6-f30a-4ee2-a68c-206430a6dfdc" class="modal-trigger">mechanical.i</a> defines and solves the elasticity subproblem </p></li><li><p><a href="#2c8e6907-4504-47f0-8427-c37268bbd4ff" class="modal-trigger">fracture.i</a> defines and solves the phase-field subproblem</p></li></ul><div class="modal moose-modal" id="806410c6-f30a-4ee2-a68c-206430a6dfdc"><div class="modal-content"><h4>/benchmarks/mode1_geometric_notch/mechanical.i</h4><pre class="moose-pre"><code class="language-text">E = 2.1e5
nu = 0.3
Gc = 2.7
l = 0.015
psic = 14.88
k = 1e-09

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = &#x27;fracture.i&#x27;
    app_type = raccoonApp
    execute_on = &#x27;TIMESTEP_BEGIN&#x27;
    cli_args = &#x27;Gc=${Gc};l=${l};psic=${psic};k=${k}&#x27;
  []
[]

[Transfers]
  [send_E_el_active]
    type = MultiAppCopyTransfer
    multi_app = fracture
    direction = to_multiapp
    source_variable = &#x27;E_el_active&#x27;
    variable = &#x27;E_el_active&#x27;
  []
  [get_d]
    type = MultiAppCopyTransfer
    multi_app = fracture
    direction = from_multiapp
    source_variable = &#x27;d&#x27;
    variable = &#x27;d&#x27;
  []
[]

[Mesh]
  type = FileMesh
  file = &#x27;gold/geo.msh&#x27;
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [d]
  []
  [E_el_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [fy]
  []
[]

[AuxKernels]
  [E_el]
    type = ADMaterialRealAux
    variable = &#x27;E_el_active&#x27;
    property = &#x27;E_el_active&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_x&#x27;
    component = 0
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_y&#x27;
    component = 1
    displacements = &#x27;disp_x disp_y&#x27;
    save_in = &#x27;fy&#x27;
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;top&#x27;
    function = &#x27;t&#x27;
    preset = false
  []
  [xfix]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;top bottom&#x27;
    value = 0
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;bottom&#x27;
    value = 0
  []
[]

[Materials]
  [elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = ${E}
    poissons_ratio = ${nu}
  []
  [strain]
    type = ADComputeSmallStrain
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [stress]
    type = SmallStrainDegradedElasticPK2Stress_StrainSpectral
    d = &#x27;d&#x27;
  []
  [fracture_properties]
    type = ADGenericFunctionMaterial
    prop_names = &#x27;energy_release_rate phase_field_regularization_length critical_fracture_energy&#x27;
    prop_values = &#x27;${Gc} ${l} ${psic}&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = d
  []
  [phase_field_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = d
    residual_degradation = ${k}
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist&#x27;

  dt = 1e-4
  end_time = 6e-3
  nl_rel_tol = 1e-06
  nl_abs_tol = 1e-08

  automatic_scaling = true

  picard_max_its = 100
  picard_abs_tol = 1e-50
  picard_rel_tol = 1e-03
  accept_on_max_picard_iteration = true
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = &#x27;fy&#x27;
    boundary = &#x27;top&#x27;
  []
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
  [csv]
    type = CSV
    delimiter = &#x27; &#x27;
    file_base = &#x27;force_displacement&#x27;
  []
  [exodus]
    type = Exodus
    file_base = &#x27;visualize&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="modal moose-modal" id="2c8e6907-4504-47f0-8427-c37268bbd4ff"><div class="modal-content"><h4>/benchmarks/mode1_geometric_notch/fracture.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = FileMesh
  file = &#x27;gold/geo.msh&#x27;
[]

[Variables]
  [d]
  []
[]

[AuxVariables]
  [E_el_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [bounds_dummy]
  []
[]

[Bounds]
  [irreversibility]
    type = VariableOldValueBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = lower
  []
  [upper]
    type = ConstantBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = upper
    bound_value = 1
  []
[]

[Kernels]
  [diff]
    type = ADPFFDiffusion
    variable = &#x27;d&#x27;
  []
  [barrier]
    type = ADPFFBarrier
    variable = &#x27;d&#x27;
  []
  [react]
    type = ADPFFReaction
    variable = &#x27;d&#x27;
    driving_energy_var = &#x27;E_el_active&#x27;
  []
[]

[Materials]
  [fracture_bulk]
    type = ADGenericFunctionMaterial
    prop_names = &#x27;energy_release_rate phase_field_regularization_length critical_fracture_energy&#x27;
    prop_values = &#x27;${Gc} ${l} ${psic}&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = d
  []
  [fracture_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = d
    residual_degradation = ${k}
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -snes_type&#x27;
  petsc_options_value = &#x27;lu       vinewtonrsls&#x27;

  dt = 1e-4
  nl_rel_tol = 1e-06
  nl_abs_tol = 1e-08
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><section class="scrollspy" id="a2c44b64-e60b-420b-bff8-3513ed8e0436" data-section-level="2" data-section-text="The elasticity subproblem"><h2 id="the-elasticity-subproblem">The elasticity subproblem</h2><p>The &quot;mechanical.i&quot; input file defines and solves the elasticity subproblem. Two kernels define the residual term <span class="moose-katex-inline-equation" id="moose-equation-2c319672-e9ca-48fb-b377-d3dc42eec583"><script>var element = document.getElementById("moose-equation-2c319672-e9ca-48fb-b377-d3dc42eec583");katex.render("\\xstress_{ij,j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>:</p><pre class="moose-pre"><code class="language-text">[AuxKernels]
  [E_el]
    type = ADMaterialRealAux
    variable = &#x27;E_el_active&#x27;
    property = &#x27;E_el_active&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]
</code></pre><a href="#8d79a1aa-8dbc-4478-a018-85f18df90cbd" class="modal-trigger">(benchmarks/mode1_geometric_notch/mechanical.i)</a><div class="modal moose-modal" id="8d79a1aa-8dbc-4478-a018-85f18df90cbd"><div class="modal-content"><h4>/home/travis/build/hugary1995/raccoon/benchmarks/mode1_geometric_notch/mechanical.i</h4><pre class="moose-pre"><code class="language-text">E = 2.1e5
nu = 0.3
Gc = 2.7
l = 0.015
psic = 14.88
k = 1e-09

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = &#x27;fracture.i&#x27;
    app_type = raccoonApp
    execute_on = &#x27;TIMESTEP_BEGIN&#x27;
    cli_args = &#x27;Gc=${Gc};l=${l};psic=${psic};k=${k}&#x27;
  []
[]

[Transfers]
  [send_E_el_active]
    type = MultiAppCopyTransfer
    multi_app = fracture
    direction = to_multiapp
    source_variable = &#x27;E_el_active&#x27;
    variable = &#x27;E_el_active&#x27;
  []
  [get_d]
    type = MultiAppCopyTransfer
    multi_app = fracture
    direction = from_multiapp
    source_variable = &#x27;d&#x27;
    variable = &#x27;d&#x27;
  []
[]

[Mesh]
  type = FileMesh
  file = &#x27;gold/geo.msh&#x27;
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [d]
  []
  [E_el_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [fy]
  []
[]

[AuxKernels]
  [E_el]
    type = ADMaterialRealAux
    variable = &#x27;E_el_active&#x27;
    property = &#x27;E_el_active&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_x&#x27;
    component = 0
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_y&#x27;
    component = 1
    displacements = &#x27;disp_x disp_y&#x27;
    save_in = &#x27;fy&#x27;
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;top&#x27;
    function = &#x27;t&#x27;
    preset = false
  []
  [xfix]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;top bottom&#x27;
    value = 0
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;bottom&#x27;
    value = 0
  []
[]

[Materials]
  [elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = ${E}
    poissons_ratio = ${nu}
  []
  [strain]
    type = ADComputeSmallStrain
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [stress]
    type = SmallStrainDegradedElasticPK2Stress_StrainSpectral
    d = &#x27;d&#x27;
  []
  [fracture_properties]
    type = ADGenericFunctionMaterial
    prop_names = &#x27;energy_release_rate phase_field_regularization_length critical_fracture_energy&#x27;
    prop_values = &#x27;${Gc} ${l} ${psic}&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = d
  []
  [phase_field_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = d
    residual_degradation = ${k}
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist&#x27;

  dt = 1e-4
  end_time = 6e-3
  nl_rel_tol = 1e-06
  nl_abs_tol = 1e-08

  automatic_scaling = true

  picard_max_its = 100
  picard_abs_tol = 1e-50
  picard_rel_tol = 1e-03
  accept_on_max_picard_iteration = true
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = &#x27;fy&#x27;
    boundary = &#x27;top&#x27;
  []
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
  [csv]
    type = CSV
    delimiter = &#x27; &#x27;
    file_base = &#x27;force_displacement&#x27;
  []
  [exodus]
    type = Exodus
    file_base = &#x27;visualize&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>Upon convergence, residual at Dirichlet DoFs are volumetric reaction forces. Those values are saved in <code>fy</code> and are summed by a postprocessor to get the reaction force in y direction.</p></p></div></div></div><p>Boundary conditions are defined according to <a href="#mode1_bcs">Figure 1</a>:</p><pre class="moose-pre"><code class="language-text">[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;top&#x27;
    function = &#x27;t&#x27;
    preset = false
  []
  [xfix]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;top bottom&#x27;
    value = 0
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;bottom&#x27;
    value = 0
  []
[]
</code></pre><a href="#02cdd4dd-cb74-459e-9e07-4a462ae7a69d" class="modal-trigger">(benchmarks/mode1_geometric_notch/mechanical.i)</a><div class="modal moose-modal" id="02cdd4dd-cb74-459e-9e07-4a462ae7a69d"><div class="modal-content"><h4>/home/travis/build/hugary1995/raccoon/benchmarks/mode1_geometric_notch/mechanical.i</h4><pre class="moose-pre"><code class="language-text">E = 2.1e5
nu = 0.3
Gc = 2.7
l = 0.015
psic = 14.88
k = 1e-09

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = &#x27;fracture.i&#x27;
    app_type = raccoonApp
    execute_on = &#x27;TIMESTEP_BEGIN&#x27;
    cli_args = &#x27;Gc=${Gc};l=${l};psic=${psic};k=${k}&#x27;
  []
[]

[Transfers]
  [send_E_el_active]
    type = MultiAppCopyTransfer
    multi_app = fracture
    direction = to_multiapp
    source_variable = &#x27;E_el_active&#x27;
    variable = &#x27;E_el_active&#x27;
  []
  [get_d]
    type = MultiAppCopyTransfer
    multi_app = fracture
    direction = from_multiapp
    source_variable = &#x27;d&#x27;
    variable = &#x27;d&#x27;
  []
[]

[Mesh]
  type = FileMesh
  file = &#x27;gold/geo.msh&#x27;
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [d]
  []
  [E_el_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [fy]
  []
[]

[AuxKernels]
  [E_el]
    type = ADMaterialRealAux
    variable = &#x27;E_el_active&#x27;
    property = &#x27;E_el_active&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_x&#x27;
    component = 0
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_y&#x27;
    component = 1
    displacements = &#x27;disp_x disp_y&#x27;
    save_in = &#x27;fy&#x27;
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;top&#x27;
    function = &#x27;t&#x27;
    preset = false
  []
  [xfix]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;top bottom&#x27;
    value = 0
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;bottom&#x27;
    value = 0
  []
[]

[Materials]
  [elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = ${E}
    poissons_ratio = ${nu}
  []
  [strain]
    type = ADComputeSmallStrain
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [stress]
    type = SmallStrainDegradedElasticPK2Stress_StrainSpectral
    d = &#x27;d&#x27;
  []
  [fracture_properties]
    type = ADGenericFunctionMaterial
    prop_names = &#x27;energy_release_rate phase_field_regularization_length critical_fracture_energy&#x27;
    prop_values = &#x27;${Gc} ${l} ${psic}&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = d
  []
  [phase_field_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = d
    residual_degradation = ${k}
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist&#x27;

  dt = 1e-4
  end_time = 6e-3
  nl_rel_tol = 1e-06
  nl_abs_tol = 1e-08

  automatic_scaling = true

  picard_max_its = 100
  picard_abs_tol = 1e-50
  picard_rel_tol = 1e-03
  accept_on_max_picard_iteration = true
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = &#x27;fy&#x27;
    boundary = &#x27;top&#x27;
  []
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
  [csv]
    type = CSV
    delimiter = &#x27; &#x27;
    file_base = &#x27;force_displacement&#x27;
  []
  [exodus]
    type = Exodus
    file_base = &#x27;visualize&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p>At the end of each time step, the fracture driving energy is saved in an auxiliary variable:</p><pre class="moose-pre"><code class="language-text">[AuxKernels]
  [E_el]
    type = ADMaterialRealAux
    variable = &#x27;E_el_active&#x27;
    property = &#x27;E_el_active&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]
</code></pre><a href="#6dabe206-4646-4ed7-a372-17bd6e57cc18" class="modal-trigger">(benchmarks/mode1_geometric_notch/mechanical.i)</a><div class="modal moose-modal" id="6dabe206-4646-4ed7-a372-17bd6e57cc18"><div class="modal-content"><h4>/home/travis/build/hugary1995/raccoon/benchmarks/mode1_geometric_notch/mechanical.i</h4><pre class="moose-pre"><code class="language-text">E = 2.1e5
nu = 0.3
Gc = 2.7
l = 0.015
psic = 14.88
k = 1e-09

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = &#x27;fracture.i&#x27;
    app_type = raccoonApp
    execute_on = &#x27;TIMESTEP_BEGIN&#x27;
    cli_args = &#x27;Gc=${Gc};l=${l};psic=${psic};k=${k}&#x27;
  []
[]

[Transfers]
  [send_E_el_active]
    type = MultiAppCopyTransfer
    multi_app = fracture
    direction = to_multiapp
    source_variable = &#x27;E_el_active&#x27;
    variable = &#x27;E_el_active&#x27;
  []
  [get_d]
    type = MultiAppCopyTransfer
    multi_app = fracture
    direction = from_multiapp
    source_variable = &#x27;d&#x27;
    variable = &#x27;d&#x27;
  []
[]

[Mesh]
  type = FileMesh
  file = &#x27;gold/geo.msh&#x27;
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [d]
  []
  [E_el_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [fy]
  []
[]

[AuxKernels]
  [E_el]
    type = ADMaterialRealAux
    variable = &#x27;E_el_active&#x27;
    property = &#x27;E_el_active&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_x&#x27;
    component = 0
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_y&#x27;
    component = 1
    displacements = &#x27;disp_x disp_y&#x27;
    save_in = &#x27;fy&#x27;
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;top&#x27;
    function = &#x27;t&#x27;
    preset = false
  []
  [xfix]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;top bottom&#x27;
    value = 0
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;bottom&#x27;
    value = 0
  []
[]

[Materials]
  [elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = ${E}
    poissons_ratio = ${nu}
  []
  [strain]
    type = ADComputeSmallStrain
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [stress]
    type = SmallStrainDegradedElasticPK2Stress_StrainSpectral
    d = &#x27;d&#x27;
  []
  [fracture_properties]
    type = ADGenericFunctionMaterial
    prop_names = &#x27;energy_release_rate phase_field_regularization_length critical_fracture_energy&#x27;
    prop_values = &#x27;${Gc} ${l} ${psic}&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = d
  []
  [phase_field_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = d
    residual_degradation = ${k}
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist&#x27;

  dt = 1e-4
  end_time = 6e-3
  nl_rel_tol = 1e-06
  nl_abs_tol = 1e-08

  automatic_scaling = true

  picard_max_its = 100
  picard_abs_tol = 1e-50
  picard_rel_tol = 1e-03
  accept_on_max_picard_iteration = true
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = &#x27;fy&#x27;
    boundary = &#x27;top&#x27;
  []
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
  [csv]
    type = CSV
    delimiter = &#x27; &#x27;
    file_base = &#x27;force_displacement&#x27;
  []
  [exodus]
    type = Exodus
    file_base = &#x27;visualize&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p>which is transferred to the fracture MultiApp to define the damage evolution equation:</p><pre class="moose-pre"><code class="language-text">[send_E_el_active]
  type = MultiAppCopyTransfer
  multi_app = fracture
  direction = to_multiapp
  source_variable = &#x27;E_el_active&#x27;
  variable = &#x27;E_el_active&#x27;
[]
</code></pre><a href="#44045924-4988-4156-879a-bc10592b7cb6" class="modal-trigger">(benchmarks/mode1_geometric_notch/mechanical.i)</a><div class="modal moose-modal" id="44045924-4988-4156-879a-bc10592b7cb6"><div class="modal-content"><h4>/home/travis/build/hugary1995/raccoon/benchmarks/mode1_geometric_notch/mechanical.i</h4><pre class="moose-pre"><code class="language-text">E = 2.1e5
nu = 0.3
Gc = 2.7
l = 0.015
psic = 14.88
k = 1e-09

[MultiApps]
  [fracture]
    type = TransientMultiApp
    input_files = &#x27;fracture.i&#x27;
    app_type = raccoonApp
    execute_on = &#x27;TIMESTEP_BEGIN&#x27;
    cli_args = &#x27;Gc=${Gc};l=${l};psic=${psic};k=${k}&#x27;
  []
[]

[Transfers]
  [send_E_el_active]
    type = MultiAppCopyTransfer
    multi_app = fracture
    direction = to_multiapp
    source_variable = &#x27;E_el_active&#x27;
    variable = &#x27;E_el_active&#x27;
  []
  [get_d]
    type = MultiAppCopyTransfer
    multi_app = fracture
    direction = from_multiapp
    source_variable = &#x27;d&#x27;
    variable = &#x27;d&#x27;
  []
[]

[Mesh]
  type = FileMesh
  file = &#x27;gold/geo.msh&#x27;
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
[]

[AuxVariables]
  [d]
  []
  [E_el_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [fy]
  []
[]

[AuxKernels]
  [E_el]
    type = ADMaterialRealAux
    variable = &#x27;E_el_active&#x27;
    property = &#x27;E_el_active&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_x&#x27;
    component = 0
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_y&#x27;
    component = 1
    displacements = &#x27;disp_x disp_y&#x27;
    save_in = &#x27;fy&#x27;
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;top&#x27;
    function = &#x27;t&#x27;
    preset = false
  []
  [xfix]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;top bottom&#x27;
    value = 0
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;bottom&#x27;
    value = 0
  []
[]

[Materials]
  [elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = ${E}
    poissons_ratio = ${nu}
  []
  [strain]
    type = ADComputeSmallStrain
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [stress]
    type = SmallStrainDegradedElasticPK2Stress_StrainSpectral
    d = &#x27;d&#x27;
  []
  [fracture_properties]
    type = ADGenericFunctionMaterial
    prop_names = &#x27;energy_release_rate phase_field_regularization_length critical_fracture_energy&#x27;
    prop_values = &#x27;${Gc} ${l} ${psic}&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = d
  []
  [phase_field_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = d
    residual_degradation = ${k}
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_factor_mat_solver_package&#x27;
  petsc_options_value = &#x27;lu       superlu_dist&#x27;

  dt = 1e-4
  end_time = 6e-3
  nl_rel_tol = 1e-06
  nl_abs_tol = 1e-08

  automatic_scaling = true

  picard_max_its = 100
  picard_abs_tol = 1e-50
  picard_rel_tol = 1e-03
  accept_on_max_picard_iteration = true
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = &#x27;fy&#x27;
    boundary = &#x27;top&#x27;
  []
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
  [csv]
    type = CSV
    delimiter = &#x27; &#x27;
    file_base = &#x27;force_displacement&#x27;
  []
  [exodus]
    type = Exodus
    file_base = &#x27;visualize&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></section><section class="scrollspy" id="4a309067-7a23-4340-8b42-69b4005e1b11" data-section-level="2" data-section-text="The fracture subproblem"><h2 id="the-fracture-subproblem">The fracture subproblem</h2><p>The &quot;fracture.i&quot; input file defines and solves the elasticity subproblem. Two kernels define the residual of the damage evolution equation:</p><pre class="moose-pre"><code class="language-text">[Kernels]
  [diff]
    type = ADPFFDiffusion
    variable = &#x27;d&#x27;
  []
  [barrier]
    type = ADPFFBarrier
    variable = &#x27;d&#x27;
  []
  [react]
    type = ADPFFReaction
    variable = &#x27;d&#x27;
    driving_energy_var = &#x27;E_el_active&#x27;
  []
[]
</code></pre><a href="#54e3c072-a8aa-44b9-bce6-82938d6edd9f" class="modal-trigger">(benchmarks/mode1_geometric_notch/fracture.i)</a><div class="modal moose-modal" id="54e3c072-a8aa-44b9-bce6-82938d6edd9f"><div class="modal-content"><h4>/home/travis/build/hugary1995/raccoon/benchmarks/mode1_geometric_notch/fracture.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = FileMesh
  file = &#x27;gold/geo.msh&#x27;
[]

[Variables]
  [d]
  []
[]

[AuxVariables]
  [E_el_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [bounds_dummy]
  []
[]

[Bounds]
  [irreversibility]
    type = VariableOldValueBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = lower
  []
  [upper]
    type = ConstantBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = upper
    bound_value = 1
  []
[]

[Kernels]
  [diff]
    type = ADPFFDiffusion
    variable = &#x27;d&#x27;
  []
  [barrier]
    type = ADPFFBarrier
    variable = &#x27;d&#x27;
  []
  [react]
    type = ADPFFReaction
    variable = &#x27;d&#x27;
    driving_energy_var = &#x27;E_el_active&#x27;
  []
[]

[Materials]
  [fracture_bulk]
    type = ADGenericFunctionMaterial
    prop_names = &#x27;energy_release_rate phase_field_regularization_length critical_fracture_energy&#x27;
    prop_values = &#x27;${Gc} ${l} ${psic}&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = d
  []
  [fracture_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = d
    residual_degradation = ${k}
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -snes_type&#x27;
  petsc_options_value = &#x27;lu       vinewtonrsls&#x27;

  dt = 1e-4
  nl_rel_tol = 1e-06
  nl_abs_tol = 1e-08
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>The fracture driving energy is defined by an auxiliary variable retrieved from the mechanical MultiApp <code>E_el</code>.</p></p></div></div></div><p>Irreversibility of damage is enforced as a variation inequality:</p><pre class="moose-pre"><code class="language-text">[Bounds]
  [irreversibility]
    type = VariableOldValueBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = lower
  []
  [upper]
    type = ConstantBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = upper
    bound_value = 1
  []
[]
</code></pre><a href="#3b04c210-dfb3-4b71-a8aa-2e0814ffe462" class="modal-trigger">(benchmarks/mode1_geometric_notch/fracture.i)</a><div class="modal moose-modal" id="3b04c210-dfb3-4b71-a8aa-2e0814ffe462"><div class="modal-content"><h4>/home/travis/build/hugary1995/raccoon/benchmarks/mode1_geometric_notch/fracture.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = FileMesh
  file = &#x27;gold/geo.msh&#x27;
[]

[Variables]
  [d]
  []
[]

[AuxVariables]
  [E_el_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [bounds_dummy]
  []
[]

[Bounds]
  [irreversibility]
    type = VariableOldValueBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = lower
  []
  [upper]
    type = ConstantBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = upper
    bound_value = 1
  []
[]

[Kernels]
  [diff]
    type = ADPFFDiffusion
    variable = &#x27;d&#x27;
  []
  [barrier]
    type = ADPFFBarrier
    variable = &#x27;d&#x27;
  []
  [react]
    type = ADPFFReaction
    variable = &#x27;d&#x27;
    driving_energy_var = &#x27;E_el_active&#x27;
  []
[]

[Materials]
  [fracture_bulk]
    type = ADGenericFunctionMaterial
    prop_names = &#x27;energy_release_rate phase_field_regularization_length critical_fracture_energy&#x27;
    prop_values = &#x27;${Gc} ${l} ${psic}&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = d
  []
  [fracture_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = d
    residual_degradation = ${k}
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -snes_type&#x27;
  petsc_options_value = &#x27;lu       vinewtonrsls&#x27;

  dt = 1e-4
  nl_rel_tol = 1e-06
  nl_abs_tol = 1e-08
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p>A variational inequality solver <strong>must</strong> be used for the bound to be effective. For example, here we use the <code>vinewtonrsls</code> nonlinear solver to enforce irreversibility:</p><pre class="moose-pre"><code class="language-text">  petsc_options_iname = &#x27;-pc_type -snes_type&#x27;
  petsc_options_value = &#x27;lu       vinewtonrsls&#x27;
</code></pre><a href="#8118e9f5-a289-4f45-8438-8bbe08bb503c" class="modal-trigger">(benchmarks/mode1_geometric_notch/fracture.i)</a><div class="modal moose-modal" id="8118e9f5-a289-4f45-8438-8bbe08bb503c"><div class="modal-content"><h4>/home/travis/build/hugary1995/raccoon/benchmarks/mode1_geometric_notch/fracture.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  type = FileMesh
  file = &#x27;gold/geo.msh&#x27;
[]

[Variables]
  [d]
  []
[]

[AuxVariables]
  [E_el_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [bounds_dummy]
  []
[]

[Bounds]
  [irreversibility]
    type = VariableOldValueBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = lower
  []
  [upper]
    type = ConstantBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = upper
    bound_value = 1
  []
[]

[Kernels]
  [diff]
    type = ADPFFDiffusion
    variable = &#x27;d&#x27;
  []
  [barrier]
    type = ADPFFBarrier
    variable = &#x27;d&#x27;
  []
  [react]
    type = ADPFFReaction
    variable = &#x27;d&#x27;
    driving_energy_var = &#x27;E_el_active&#x27;
  []
[]

[Materials]
  [fracture_bulk]
    type = ADGenericFunctionMaterial
    prop_names = &#x27;energy_release_rate phase_field_regularization_length critical_fracture_energy&#x27;
    prop_values = &#x27;${Gc} ${l} ${psic}&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = d
  []
  [fracture_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = d
    residual_degradation = ${k}
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -snes_type&#x27;
  petsc_options_value = &#x27;lu       vinewtonrsls&#x27;

  dt = 1e-4
  nl_rel_tol = 1e-06
  nl_abs_tol = 1e-08
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></section><section class="scrollspy" id="16c5db24-bd1f-43aa-8db8-b02bed6b5854" data-section-level="2" data-section-text="Defining initial damage"><h2 id="defining-initial-damage">Defining initial damage</h2><p>Instead of a &quot;meshed-in&quot; initial crack, sometimes we may need initial imperfections in the form of an initial damage field. To do so, simply define the initial damage field in the master input file, e.g.</p><pre class="moose-pre"><code class="language-text">[Variables]
  [d]
    [InitialCondition]
      type = CohesiveDamageIC
      d0 = 1.0
      l = ${l}
      x1 = -0.5
      y1 = 0
      z1 = 0
      x2 = 0
      y2 = 0
      z2 = 0
    []
  []
[]
</code></pre><a href="#3979892c-2e27-43cb-bbba-b44e700a87f6" class="modal-trigger">(benchmarks/mode1_initial_damage/fracture.i)</a><div class="modal moose-modal" id="3979892c-2e27-43cb-bbba-b44e700a87f6"><div class="modal-content"><h4>/home/travis/build/hugary1995/raccoon/benchmarks/mode1_initial_damage/fracture.i</h4><pre class="moose-pre"><code class="language-text">[Mesh]
  [square]
    type = GeneratedMeshGenerator
    dim = 2
    xmin = -0.5
    xmax = 0.5
    ymin = -0.5
    ymax = 0.5
    nx = 26
    ny = 26
  []
[]

[Adaptivity]
  marker = &#x27;box&#x27;
  max_h_level = 3
  initial_steps = 3
  [Markers]
    [box]
      type = BoxMarker
      bottom_left = &#x27;-0.5 -0.04 0&#x27;
      top_right = &#x27;0.5 0.04 0&#x27;
      inside = refine
      outside = do_nothing
    []
  []
[]

[Variables]
  [d]
    [InitialCondition]
      type = CohesiveDamageIC
      d0 = 1.0
      l = ${l}
      x1 = -0.5
      y1 = 0
      z1 = 0
      x2 = 0
      y2 = 0
      z2 = 0
    []
  []
[]

[AuxVariables]
  [E_el_active]
    order = CONSTANT
    family = MONOMIAL
  []
  [bounds_dummy]
  []
[]

[Bounds]
  [irreversibility]
    type = VariableOldValueBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = lower
  []
  [upper]
    type = ConstantBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = upper
    bound_value = 1
  []
[]

[Kernels]
  [diff]
    type = ADPFFDiffusion
    variable = &#x27;d&#x27;
  []
  [barrier]
    type = ADPFFBarrier
    variable = &#x27;d&#x27;
  []
  [react]
    type = ADPFFReaction
    variable = &#x27;d&#x27;
    driving_energy_var = &#x27;E_el_active&#x27;
  []
[]

[Materials]
  [fracture_bulk]
    type = ADGenericFunctionMaterial
    prop_names = &#x27;energy_release_rate phase_field_regularization_length critical_fracture_energy&#x27;
    prop_values = &#x27;${Gc} ${l} ${psic}&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = d
  []
  [fracture_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = d
    residual_degradation = ${k}
  []
[]

[Executioner]
  type = Transient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -snes_type&#x27;
  petsc_options_value = &#x27;lu       vinewtonrsls&#x27;

  dt = 1e-4
  nl_rel_tol = 1e-06
  nl_abs_tol = 1e-08
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><p><a href="../source/ics/CohesiveDamageIC.html">CohesiveDamageIC</a> and <a href="../source/ics/BrittleDamageIC.html">BrittleDamageIC</a> are predefined initial conditions based on closed-form solutions.</p></section><section class="scrollspy" id="1b879941-c698-41f5-8e98-e87e4f1a7b5d" data-section-level="2" data-section-text="Fixed - point iteration : the other way"><h2 id="fixed-point-iteration-the-other-way">Fixed-point iteration: the other way</h2><p>Recently, another way to perform fixed-point iteration has made its way into RACCOON. As opposed to the old way, the new system needs only one input file. Between fixed-point iterations within one load step, stateful material properties are advanced. Therefore, by &quot;lagging&quot; the fracture driving energy one step, we achieve effectively the fixed-point iteration.</p><pre class="moose-pre"><code class="language-text">[Problem]
  type = FixedPointProblem
[]

[Mesh]
  type = FileMesh
  file = &#x27;gold/geo.msh&#x27;
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
  [d]
  []
[]

[AuxVariables]
  [bounds_dummy]
  []
  [fy]
  []
[]

[UserObjects]
  [E_driving]
    type = ADFPIMaterialPropertyUserObject
    mat_prop = &#x27;E_el_active&#x27;
  []
[]

[Bounds]
  [irreversibility]
    type = VariableOldValueBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = lower
  []
  [upper]
    type = ConstantBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = upper
    bound_value = 1
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_x&#x27;
    component = 0
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_y&#x27;
    component = 1
    displacements = &#x27;disp_x disp_y&#x27;
    save_in = &#x27;fy&#x27;
  []
  [pff_diff]
    type = ADPFFDiffusion
    variable = &#x27;d&#x27;
  []
  [pff_barr]
    type = ADPFFBarrier
    variable = &#x27;d&#x27;
  []
  [pff_react]
    type = ADPFFReaction
    variable = &#x27;d&#x27;
    driving_energy_uo = &#x27;E_driving&#x27;
    lag = false
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;top&#x27;
    function = &#x27;t&#x27;
  []
  [xfix]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;top bottom&#x27;
    value = 0
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;bottom&#x27;
    value = 0
  []
[]

[Materials]
  [elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = 2.1e5
    poissons_ratio = 0.3
  []
  [strain]
    type = ADComputeSmallStrain
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [stress]
    type = SmallStrainDegradedElasticPK2Stress_StrainSpectral
    d = &#x27;d&#x27;
    d_crit = 2.0
  []
  [bulk]
    type = ADGenericConstantMaterial
    prop_names = &#x27;phase_field_regularization_length energy_release_rate critical_fracture_energy&#x27;
    prop_values = &#x27;0.015 2.7 14.88&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = &#x27;d&#x27;
  []
  [fracture_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = &#x27;d&#x27;
    residual_degradation = 1e-09
  []
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = &#x27;fy&#x27;
    boundary = &#x27;top&#x27;
  []
[]

[Executioner]
  type = FixedPointTransient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -sub_pc_type -ksp_max_it -ksp_gmres_restart -sub_pc_factor_levels &#x27;
                        &#x27;-snes_type&#x27;
  petsc_options_value = &#x27;asm      ilu          200         200                0                     &#x27;
                        &#x27;vinewtonrsls&#x27;
  dt = 1e-4
  end_time = 6e-3

  nl_abs_tol = 1e-08
  nl_rel_tol = 1e-06

  automatic_scaling = true
  compute_scaling_once = false

  fp_max_its = 100
  fp_tol = 1e-06
  accept_on_max_fp_iteration = true
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
  [csv]
    type = CSV
    delimiter = &#x27; &#x27;
    file_base = &#x27;force_displacement&#x27;
  []
  [exodus]
    type = Exodus
    file_base = &#x27;visualize&#x27;
  []
  [console]
    type = Console
    outlier_variable_norms = false
  []
[]
</code></pre><a href="#8b7cdb68-ee7e-442e-873a-2d4650cc09c7" class="modal-trigger">(benchmarks/fixed_point_iteration/mechanical_fracture_uo.i)</a><div class="modal moose-modal" id="8b7cdb68-ee7e-442e-873a-2d4650cc09c7"><div class="modal-content"><h4>/home/travis/build/hugary1995/raccoon/benchmarks/fixed_point_iteration/mechanical_fracture_uo.i</h4><pre class="moose-pre"><code class="language-text">[Problem]
  type = FixedPointProblem
[]

[Mesh]
  type = FileMesh
  file = &#x27;gold/geo.msh&#x27;
[]

[Variables]
  [disp_x]
  []
  [disp_y]
  []
  [d]
  []
[]

[AuxVariables]
  [bounds_dummy]
  []
  [fy]
  []
[]

[UserObjects]
  [E_driving]
    type = ADFPIMaterialPropertyUserObject
    mat_prop = &#x27;E_el_active&#x27;
  []
[]

[Bounds]
  [irreversibility]
    type = VariableOldValueBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = lower
  []
  [upper]
    type = ConstantBoundsAux
    variable = &#x27;bounds_dummy&#x27;
    bounded_variable = &#x27;d&#x27;
    bound_type = upper
    bound_value = 1
  []
[]

[Kernels]
  [solid_x]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_x&#x27;
    component = 0
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [solid_y]
    type = ADStressDivergenceTensors
    variable = &#x27;disp_y&#x27;
    component = 1
    displacements = &#x27;disp_x disp_y&#x27;
    save_in = &#x27;fy&#x27;
  []
  [pff_diff]
    type = ADPFFDiffusion
    variable = &#x27;d&#x27;
  []
  [pff_barr]
    type = ADPFFBarrier
    variable = &#x27;d&#x27;
  []
  [pff_react]
    type = ADPFFReaction
    variable = &#x27;d&#x27;
    driving_energy_uo = &#x27;E_driving&#x27;
    lag = false
  []
[]

[BCs]
  [ydisp]
    type = FunctionDirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;top&#x27;
    function = &#x27;t&#x27;
  []
  [xfix]
    type = DirichletBC
    variable = &#x27;disp_x&#x27;
    boundary = &#x27;top bottom&#x27;
    value = 0
  []
  [yfix]
    type = DirichletBC
    variable = &#x27;disp_y&#x27;
    boundary = &#x27;bottom&#x27;
    value = 0
  []
[]

[Materials]
  [elasticity_tensor]
    type = ADComputeIsotropicElasticityTensor
    youngs_modulus = 2.1e5
    poissons_ratio = 0.3
  []
  [strain]
    type = ADComputeSmallStrain
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [stress]
    type = SmallStrainDegradedElasticPK2Stress_StrainSpectral
    d = &#x27;d&#x27;
    d_crit = 2.0
  []
  [bulk]
    type = ADGenericConstantMaterial
    prop_names = &#x27;phase_field_regularization_length energy_release_rate critical_fracture_energy&#x27;
    prop_values = &#x27;0.015 2.7 14.88&#x27;
  []
  [local_dissipation]
    type = LinearLocalDissipation
    d = &#x27;d&#x27;
  []
  [fracture_properties]
    type = ADFractureMaterial
    local_dissipation_norm = 8/3
  []
  [degradation]
    type = LorentzDegradation
    d = &#x27;d&#x27;
    residual_degradation = 1e-09
  []
[]

[Postprocessors]
  [Fy]
    type = NodalSum
    variable = &#x27;fy&#x27;
    boundary = &#x27;top&#x27;
  []
[]

[Executioner]
  type = FixedPointTransient
  solve_type = &#x27;NEWTON&#x27;
  petsc_options_iname = &#x27;-pc_type -sub_pc_type -ksp_max_it -ksp_gmres_restart -sub_pc_factor_levels &#x27;
                        &#x27;-snes_type&#x27;
  petsc_options_value = &#x27;asm      ilu          200         200                0                     &#x27;
                        &#x27;vinewtonrsls&#x27;
  dt = 1e-4
  end_time = 6e-3

  nl_abs_tol = 1e-08
  nl_rel_tol = 1e-06

  automatic_scaling = true
  compute_scaling_once = false

  fp_max_its = 100
  fp_tol = 1e-06
  accept_on_max_fp_iteration = true
[]

[Outputs]
  print_linear_residuals = false
  print_linear_converged_reason = false
  print_nonlinear_converged_reason = false
  [csv]
    type = CSV
    delimiter = &#x27; &#x27;
    file_base = &#x27;force_displacement&#x27;
  []
  [exodus]
    type = Exodus
    file_base = &#x27;visualize&#x27;
  []
  [console]
    type = Console
    outlier_variable_norms = false
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></section><section class="scrollspy" id="a595ca51-78e1-4ae5-866e-f832120b216c" data-section-level="2" data-section-text="Visualizing the outputs"><h2 id="visualizing-the-outputs">Visualizing the outputs</h2><p>The following animations are generated using Paraview.</p><picture class="materialboxed moose-image"><img src="../media/mode1.gif" style="width:60%;margin:auto;padding-top:2.5%;"></img></picture></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#a2c44b64-e60b-420b-bff8-3513ed8e0436" class="tooltipped" data-position="left" data-tooltip="The elasticity subproblem">The elasticity subproblem</a></li><li><a href="#4a309067-7a23-4340-8b42-69b4005e1b11" class="tooltipped" data-position="left" data-tooltip="The fracture subproblem">The fracture subproblem</a></li><li><a href="#16c5db24-bd1f-43aa-8db8-b02bed6b5854" class="tooltipped" data-position="left" data-tooltip="Defining initial damage">Defining initial damage</a></li><li><a href="#1b879941-c698-41f5-8e98-e87e4f1a7b5d" class="tooltipped" data-position="left" data-tooltip="Fixed - point iteration : the other way">Fixed - point iteration : the other way</a></li><li><a href="#a595ca51-78e1-4ae5-866e-f832120b216c" class="tooltipped" data-position="left" data-tooltip="Visualizing the outputs">Visualizing the outputs</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../js/init.js"></script><script type="text/javascript" src="../js/navigation.js"></script><script type="text/javascript" src="../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../js/search_index.js"></script><script type="text/javascript" src="../js/sqa_moose.js"></script>